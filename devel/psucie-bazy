$Id$

planowane psucie bazy co obi±æ moim skromnym powinno w finansach:

Otó¿ imvho, timestamp jest dobry, ale robi±c w/w operacje chcia³bym 
je oznaczaæ równie¿ dat± w sensie YYYY/MM/DD. Otó¿ wp³ata powinna byæ 
oznaczona równie¿ dniem zaksiêgowania jej. Powodów wiele.

id | number | number_plan | refersto | paytime | paytype | financial_peroid
11 |   1    |      1      |    NULL  |   14    |    1    |      3

12 |   1    |      2      |     11   |   10    |    1    |      3       | 
13 |   2    |      1      |     11   |   10    |    1    |      3       | 


Zarówno id 12 jak i 13 mog± byæ korekt± 11, 

12 ma swój inny plan numerowania ( np numer/LMSKOR/2005) 
13 korzysta z planu "1" ( np numer/LMS/2005) 

Daje to mo¿liwo¶æ pój¶cia zarówno w stronê LMS jak i LMSKOR

Ten ca³y financial_peroid to próba racjonalizacji korzystania z cdate, 
to co jest dzia³a ale pachnie ¼le.

alec> niestety period nie za³atwia sprawy do koñca, we¼my naliczanie
miesiêczne, jak wzi±æ MAX(number) dla danego miesi±ca?

Transakcje:
Czy mo¿emy robiæ tak:
$DB->BeginTrans
	[kod]
$DB->EndTrans

alec> mo¿emy to nawet zrobiæ globalnie w index.php w momencie wywo³ania modu³u
kondi> nie mo¿emy, bo po³owa modu³ów nie wraca do index.php
      (die, exit, etc) w zwi±zku z czym transakcje bêd± siê koñczyæ
      (auto)rollbackiem. æwiczy³em to jaki¶ czas temu... mo¿na EndTrans
      do register_shutdown_function()
alec> no fakt, zatem chyba lepiej robiæ to rêcznie, w koñcu transakcje
      przydaj± siê tam gdzie mamy insert, update i delete.

I co na to mysql oraz sqlite ?

alec> sqlite jak postgres, natomiast w mysql u¿ywamy tabel MyISAM, a te
nie wspieraj± transakcji, wystarczy zreszt± spojrzeæ na nasze drivery do
baz danych, w mysql'owym te funkcje s± puste.


Faktury koryguj±ce:

A) korekty dotycz± tylko i wy³±cznie dokumentów ¼ród³owych a nie korekt. Ale 
z poziomu bazy to nie oznacza ¿e mo¿na bezpiecznie u¿ywaæ nr faktury, nale¿y 
u¿ywaæ id z bazy.

B) number_plan choæby mia³byæ 1 dla faktur i 2 dla koryguj±cych MA BYÆ i ju¿.
i nie jest to typ... choæ mo¿emy za³o¿yæ ¿e numerki 2,4,6,8... koryguj± 1,3,5,7..

C) z templatem numerowania nale¿y uciec kompletnie z lms.ini i mieæ go w bazie...
i teraz maj±c numbering_plan "1" N/M/LMS/Y to nr 2 powinien byæ: N/M/LMSKOR/Y

D) aby sobie nie strzeliæ w stopê:
 *] koryguj±ce fakturki maj± inn± numeracjê, ale inn± tylko co do "/LMSKOR/" 
	ca³a reszta jak wybór schematu miesciêczny/roczny zostaje

 *] domy¶lnie faktura koryguj±ca musi mieæ jakiekolwiek pozycje, bez nich nei 
    mo¿e jej byæ bo nic nie koryguje
 *] zapisujemy pozycje PO_SKORYGOWANIU 



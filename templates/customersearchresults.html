{include file="header.html"}
<!--// $Id$ //-->
<H1>{$layout.pagetitle}</H1>
{literal}
<SCRIPT language="JavaScript">
<!--
	function setWarnings(total, on)
	{
		if (on == 1)
			document.setwarnings.elements[1].value = 1;
		else
			document.setwarnings.elements[1].value = 0;
		document.setwarnings.submit();
	}
-->
</SCRIPT>
{/literal}
<P>
<FORM NAME="setwarnings" ID="customersearchresults" METHOD="POST" ACTION="?m=customersearch&search=0">
<TABLE cellpadding="3" WIDTH="100%">
	<TR class="dark" {tip text="Click on column name to change sorting order"}>
		<TD width="97%" class="fleftu">
			<img src="img/customer.gif" ALT="">&nbsp;<a href="?m=customersearch&search=1&o=customername{if $listdata.direction eq "asc" && $listdata.order eq "customername"},desc{/if}">{t}First/last or Company name:{/t}</A></B> {if $listdata.order eq "customername"}<IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}<BR>
			<img src="img/home.gif" ALT="">&nbsp;<a href="?m=customersearch&search=1&o=address{if $listdata.direction eq "asc" && $listdata.order eq "address"},desc{/if}">{t}Address:{/t}</A> {if $listdata.order eq "address"}<IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}
		</TD>
		<TD align="right" width="1%" class="fbt" valign="top">
			<a href="?m=customersearch&search=1&o=id{if $listdata.direction eq "asc" && $listdata.order eq "id"},desc{/if}">{t}ID:{/t}</A></B> {if $listdata.order eq "id"}<IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}<BR>
			{t}Services:{/t}
		</TD>
		<TD width="1%" class="fbt" ALIGN="right" valign="top">
			<a href="?m=customersearch&search=1&o=balance{if $listdata.direction eq "asc" && $listdata.order eq "balance"},desc{/if}">{t}Balance:{/t}</A>&nbsp;{if $listdata.order eq "balance"}<IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}<BR>
			<a href="?m=customersearch&search=1&o=tariff{if $listdata.direction eq "asc" && $listdata.order eq "tariff"},desc{/if}">{t}Subscription:{/t}</A>&nbsp;{if $listdata.order eq "tariff"}<IMG SRC="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}
		</TD>
		<TD width="1%" class="frightu" align="right" nowrap>
			<NOBR><B>{t 0=$listdata.total|default:"0"}Total: $0{/t}</B></NOBR>
		</TD>
	</TR>
	{if $listdata.total != 0}
	<TR CLASS="DARK">
		<TD COLSPAN="4" CLASS="FALL">
			<B>{t}Page:{/t}
				{if $page > 1}<A HREF="?m={$layout.module}&search=1page={math equation="x - 1" x=$page}">&laquo;&laquo;&laquo;</A>{else}&laquo;&laquo;&laquo;{/if}
				{section name=pcnt loop=$customerlist step=$pagelimit}
				{if $page eq $smarty.section.pcnt.rownum}[{else} <A HREF="?m={$layout.module}&search=1&page={$smarty.section.pcnt.rownum}">{/if}{$smarty.section.pcnt.rownum}{if $page eq $smarty.section.pcnt.rownum}]{else}</A> {/if}
				{/section}
				{if $page < $smarty.section.pcnt.rownum}<A HREF="?m={$layout.module}&search=1&page={math equation="x + 1" x=$page}">&raquo;&raquo;&raquo;</A>{else}&raquo;&raquo;&raquo;{/if}
			</B> 
			{math equation="x + 1" x=$start assign=startx}
			{if $start + $pagelimit > $listdata.total}
				{assign var=endx value=$listdata.total}{else}{math equation="x + y" x=$start y=$pagelimit assign=endx}
			{/if}
			({t 0=$startx 1=$endx 2=$listdata.total}records $0 - $1 of $2{/t})
			<INPUT type="hidden" class="hiddenbtn" name="setwarnings[total]" value="{$endx - $startx}">
			<INPUT type="hidden" class="hiddenbtn" name="setwarnings[warnon]" value="0">
		</TD>
	</TR>
	{/if}
	{cycle values="light,lucid" print=false}
	{section name=customerlist loop=$customerlist start=$start max=$pagelimit}
	<TR class="{cycle}{if $customerlist[customerlist].nodeac eq 0} blend{/if}" onmouseover="addClass(this, 'highlight')" onmouseout="removeClass(this, 'highlight')">
		<TD onClick="return self.location.href='?m=customerinfo&id={$customerlist[customerlist].id}';" class="fleft" valign="top">
			<IMG src="img/{if $customerlist[customerlist].status eq 1}unk{/if}{if $customerlist[customerlist].status eq 2}wait{/if}{if $customerlist[customerlist].status eq 3}customer{/if}.gif" alt="">{if $customerlist[customerlist].info} <img src="img/info1.gif" ALT="" {tip text=$customerlist[customerlist].info}>{/if} <A name="{$customerlist[customerlist].id}" {tip 0=$customerlist[customerlist].id dynpopup='?m=customerinfoshort&id=$0'}><B>{$customerlist[customerlist].customername}</B>{if $customerlist[customerlist].deleted} (<FONT class="red">{t}deleted customer{/t}</FONT>){/if}</A><BR>
			<IMG src="img/home.gif" alt="">&nbsp;{$customerlist[customerlist].address}{if $customerlist[customerlist].city neq ""},{/if} {$customerlist[customerlist].zip} {$customerlist[customerlist].city}
		</TD>
		<TD valign="top" align="right" NOWRAP>
			({$customerlist[customerlist].id|string_format:"%04d"})<BR>
			{if $customerlist[customerlist].account}
				<IMG SRC="img/node{if !$customerlist[customerlist].online}_off{/if}.gif" alt="" {tip 0=$customerlist[customerlist].id dynpopup='?m=nodelistshort&id=$0'}></A>
			{/if}
		</TD>
		<TD align="right" valign="top" NOWRAP>
			<NOBR><IMG src="img/empty.gif" width="1" height="16" ALT="">{if $customerlist[customerlist].balance < 0}<font class="alert">{/if}{$customerlist[customerlist].balance|money_format}{if $customerlist[customerlist].balance < 0}</FONT>{/if}<BR><IMG src="img/empty.gif" width="1" height="16" ALT=""><FONT CLASS="blend">{$customerlist[customerlist].tariffvalue|money_format}</FONT></NOBR>
		</TD>
		<TD class="fright" align="right">
			<NOBR>
			{if $customerlist[customerlist].balance < 0}
				<A href="?m=customerbalanceok&id={$customerlist[customerlist].id}" OnClick="return confirmLink(this, '{t 0=$customerlist[customerlist].customername|escape:"javascript"|escape:"html"}Are you sure, you want to account ALL debts of customer \'$0\'?{/t}');"><IMG src="img/pay.gif" ALT="[ {t}Account{/t} ]"></A>
			{/if}
			{if $customerlist[customerlist].account}
				{if $customerlist[customerlist].status eq 3}
					{if $customerlist[customerlist].nodeac eq 1}
						<A href="?m=nodeset&ownerid={$customerlist[customerlist].id}"><IMG SRC="img/access.gif" alt="[ {t}Disconnect All{/t} ]"></A>
					{else}
						{if $customerlist[customerlist].nodeac eq 2}
							<A href="?m=nodeset&ownerid={$customerlist[customerlist].id}"><IMG SRC="img/mixaccess.gif" alt="[ {t}Disconnect All{/t} ]"></A>
						{else}<A href="?m=nodeset&ownerid={$customerlist[customerlist].id}&access=1"><IMG SRC="img/noaccess.gif" alt="[ {t}Connect All{/t} ]"></A>
						{/if}
					{/if}
				{/if}
			{/if}
			{if $customerlist[customerlist].warncount}
				{if $customerlist[customerlist].status eq 3}
					{if $customerlist[customerlist].nodewarn eq 1}
						<A href="?m=nodewarn&ownerid={$customerlist[customerlist].id}" {if $customerlist[customerlist].message}{tip text=$customerlist[customerlist].message}{/if}><IMG SRC="img/warningon.gif" alt="[ {t}Disable Warnings for All{/t} ]"></A>
					{else}
						{if $customerlist[customerlist].nodewarn eq 2}
							<A href="?m=nodewarn&ownerid={$customerlist[customerlist].id}" {if $customerlist[customerlist].message}{tip text=$customerlist[customerlist].message}{/if}><IMG SRC="img/warningmix.gif" alt="[ {t}Disable Warnings for All{/t} ]"></A>
						{else}<A href="?m=nodewarn&ownerid={$customerlist[customerlist].id}&warning=1" {if $customerlist[customerlist].message}{tip text=$customerlist[customerlist].message}{/if}><IMG SRC="img/warningoff.gif" alt="[ {t}Enable Warnings for All{/t} ]"></A>
						{/if}
					{/if}
				{/if}
			{/if}
			<A href="?m=customerdel&id={$customerlist[customerlist].id}" OnClick="return confirmLink(this, '{t 0=$customerlist[customerlist].customername|escape:"javascript"|escape:"html"}Are you sure, you want to remove customer \'$0\' from database?\n\nIf that customer have some nodes, they will be also removed and data definitely lost!{/t}');"><IMG src="img/delete.gif" alt="[ {t}Delete{/t} ]"></A> {if $customerlist[customerlist].deleted}
			<A href="?m=customeredit&id={$customerlist[customerlist].id}&action=recover"><IMG src="img/recover.gif" alt="[ {t}Restore{/t} ]"></A>{else}<A href="?m=customeredit&id={$customerlist[customerlist].id}"><IMG src="img/edit.gif" alt="[ {t}Edit{/t} ]"></A>{/if} 
			<A href="?m=customerinfo&id={$customerlist[customerlist].id}"><IMG src="img/info.gif" alt="[ {t}Info{/t} ]"></A></NOBR>
			<INPUT type="hidden" class="hiddenbtn" name="setwarnings[id{$smarty.section.customerlist.index}]" value="{$customerlist[customerlist].id}">
		</TD>
	</TR>
	{sectionelse}
	<TR>
		<TD colspan="4" align="center" class="flr">
			<p>&nbsp;</p>
			<p><B>{t}No such customers matching search criteria.{/t}</B></p>
			<p>&nbsp;</p>
		</TD>
	</TR>
	{/section}
	{if $listdata.total != 0}
	<TR CLASS="DARK">
		<TD COLSPAN="4" CLASS="FALL">
			<B>{t}Page:{/t}
				{if $page > 1}<A HREF="?m={$layout.module}&search=1&page={math equation="x - 1" x=$page}">&laquo;&laquo;&laquo;</A>{else}&laquo;&laquo;&laquo;{/if}
				{section name=pcnt loop=$customerlist step=$pagelimit}
				{if $page eq $smarty.section.pcnt.rownum}[{else} <A HREF="?m={$layout.module}&search=1&page={$smarty.section.pcnt.rownum}">{/if}{$smarty.section.pcnt.rownum}{if $page eq $smarty.section.pcnt.rownum}]{else}</A> {/if}
				{/section}
				{if $page < $smarty.section.pcnt.rownum}<A HREF="?m={$layout.module}&search=1&page={math equation="x + 1" x=$page}">&raquo;&raquo;&raquo;</A>{else}&raquo;&raquo;&raquo;{/if}
			</B> 
			{math equation="x + 1" x=$start assign=startx}
			{if $start + $pagelimit > $listdata.total}
				{assign var=endx value=$listdata.total}{else}{math equation="x + y" x=$start y=$pagelimit assign=endx}
			{/if}
			({t 0=$startx 1=$endx 2=$listdata.total}records $0 - $1 of $2{/t})
		</TD>
	</TR>
	{/if}
	<TR class="dark">
		<TD width="100%" class="fall" COLSPAN="4">
			<TABLE WIDTH="100%">
				<TR>
					<TD ALIGN="left">
					<NOBR><A HREF="javascript:setWarnings(1);"><IMG SRC="img/warningon.gif">{t}Enable Warnings for All{/t}</A></NOBR>&nbsp;
					<NOBR><A HREF="javascript:setWarnings(0);"><IMG SRC="img/warningoff.gif">{t}Disable Warnings for All{/t}</A></NOBR>&nbsp;
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	<TR class="dark">
		<TD class="fleftu"" align="right">
			&nbsp;
		</TD>
		<TD class="fbt"" align="right">
			<B>{t}Outstandings{/t}:<BR>
			{t}Overcharges{/t}:</B>
		</TD>
		<TD class="fbt" align="right" nowrap>
			<B>{$listdata.below|money_format}<BR>
			{$listdata.over|money_format}</B>
		</TD>
		<TD class="frightu" align="right" valign="top" nowrap>
			<B>{t}Total:{/t} {$listdata.total|default:"0"}</B>	
		</TD>
	</TR>
</TABLE>
</FORM>
</P>
{include file="footer.html"}

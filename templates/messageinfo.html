{include file="header.html"}
<!--// $Id$ //-->
<h1>{$layout.pagetitle}</h1>
<table width="100%" cellpadding="3">
	<tr class="DARK">
		<td class="FLEFTU" width="1%">
			<img src="img/{if $message.type == $smarty.const.MSG_SMS}sms{else}email{/if}.gif" alt=""> 
		</td>
		<td class="FBT" width="1%" nowrap="nowrap">
			<strong>{trans("Subject:")}</strong>
		</td>
		<td class="FRIGHTU" width="98%">
			<strong>{$message.subject}</strong>
		</td>
	</tr>
	<tr class="LIGHT">
		<td class="FLEFT" width="1%">
			<img src="img/users.gif" alt=""> 
		</td>
		<td width="1%">
			<strong>{trans("User:")}</strong>
		</td>
		<td class="FRIGHT" width="98%">
			{if $message.userid}
			<a href="?m=userinfo&id={$message.userid}">{$message.name}</a>
			{else}LMS{/if}
		</td>
	</tr>
	<tr class="LIGHT">
		<td class="FLEFT" width="1%">
			<img src="img/time.gif" alt=""> 
		</td>
		<td width="1%">
			<strong>{trans("Creation date:")}</strong>
		</td>
		<td class="FRIGHT" width="98%">
			{$message.cdate|date_format:"%Y/%m/%d %H:%m"}
		</td>
	</tr>
{if $message.sender}
	<tr class="LIGHT">
		<td class="FLEFT" width="1%">
			<img src="img/mail.gif" alt=""> 
		</td>
		<td width="1%">
			<strong>{trans("Sender:")}</strong>
		</td>
		<td class="FRIGHT" width="98%">
			{$message.sender|escape:"html"}
		</td>
	</tr>
{/if}
	<tr class="LIGHT">
		<td class="FLEFT" width="1%">
			<img src="img/edit.gif" alt=""> 
		</td>
		<td width="1%" nowrap="nowrap">
			<strong>{trans("Message body:")}</strong>
		</td>
		<td class="FRIGHT" width="98%">
			<table width="100%" cellpadding="5">
		                <tr>
			                <td class="fall superlight">
						{$message.body|replace:"\n":"<br />"}
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr class="LIGHT">
		<td class="FBOTTOMU" colspan="3" align="RIGHT">
			 <a href="?m=messagelist">{trans("Cancel")} <img src="img/cancel.gif" alt=""></a>
		</td>
	</tr>
</table>
<br />
<table width="100%" cellpadding="3">
	<tr class="DARK">
		<td width="1%" class="fleftu" nowrap="nowrap">
			<a href="?m=messageinfo&id={$message.id}&o=customer{if $listdata.direction eq "asc" && $listdata.order eq "customer"},desc{/if}">{trans("Customer:")}</a> {if $listdata.order eq "customer"}<img src="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}
		</td>
		<td width="1%" class="fbt" nowrap="nowrap">
			<a href="?m=messageinfo&id={$message.id}&o=destination{if $listdata.direction eq "asc" && $listdata.order eq "destination"},desc{/if}">{trans("Destination:")}</a> {if $listdata.order eq "destination"}<img src="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}
		</td>
		<td width="97%" class="fbt" align="right" nowrap="nowrap">
			<a href="?m=messageinfo&id={$message.id}&o=status{if $listdata.direction eq "asc" && $listdata.order eq "status"},desc{/if}">{trans("Status:")} ({trans("Error message")})</a> {if $listdata.order eq "status"}<img src="img/{if $listdata.direction eq "desc"}asc{else}desc{/if}_order.gif" alt="">{/if}
		</td>
		<td width="1%" class="frightu" nowrap="nowrap">
			<strong>{t a=$listdata.total}Total: $a{/t}</strong>&nbsp;
		</td>
	</tr>
	<tr class="DARK">
		<td class="fall" colspan="4" nowrap="nowrap">
			<form method="POST" name="page" action="?m=messageinfo&id={$message.id}">
			<strong>{trans("Filter:")} </strong> 
			<input type="text" name="search" value="{$listdata.search}" {tip text="Enter value of searching data and select category"}>&nbsp;
			<select size="1" name="cat">
				<option value=""{if $listdata.cat eq ""} SELECTED{/if}>{trans("- select filter category -")}</option>
				<option value="name"{if $listdata.cat eq "name"} SELECTED{/if}>{trans("customer name")}</option>
				<option value="customerid"{if $listdata.cat eq "customerid"} SELECTED{/if}>{trans("customer ID")}</option>
				<option value="destination"{if $listdata.cat eq "destination"} SELECTED{/if}>{trans("destination number/email")}</option>
			</select>&nbsp;
			{trans("Status:")}
			<select size="1" name="status">
				<option value=""{if !$listdata.status} SELECTED{/if}>{trans("- all statuses -")}</option>
				<option value="{$smarty.const.MSG_NEW}"{if $listdata.status == $smarty.const.MSG_NEW} SELECTED{/if}>{trans("waiting<!plural>")}</option>
			{*
				<option value="{$smarty.const.MSG_DRAFT}"{if $listdata.status == $smarty.const.MSG_DRAFT} SELECTED{/if}>{trans("drafts")}</option>
			*}
				<option value="{$smarty.const.MSG_SENT}"{if $listdata.status == $smarty.const.MSG_SENT} SELECTED{/if}>{trans("sent<!plural>")}</option>
				<option value="{$smarty.const.MSG_ERROR}"{if $listdata.status == $smarty.const.MSG_ERROR} SELECTED{/if}>{trans("errornous<!plural>")}</option>
			</select>
			&nbsp;<a href="javascript: document.page.submit();">&raquo;&raquo;&raquo;</a>
			</form>
		</td>
	</tr>		
	{if $listdata.total != 0}
	<tr class="dark">
		<td width="100%" class="fall" colspan="4">
			{include file="scroller.html" loop=$itemlist scrollerno=1}
		</td>
	</tr>
	{/if}
	{cycle values="light,lucid" print=false}
	{section name=itemlist loop=$itemlist start=$start max=$pagelimit}
	{assign var=item value=$itemlist[itemlist]}
	<tr class="{cycle}{if $item.status==$smarty.const.MSG_ERROR} alert{elseif $item.status==$smarty.const.MSG_SENT} blend{/if}" onmouseover="addClass(this, 'highlight')" onmouseout="removeClass(this, 'highlight')">
		<td width="1%" class="fleft" nowrap="nowrap">
			{if $item.customerid}
				<a href="?m=customerinfo&id={$item.customerid}">{$item.customer|truncate:45:"...":true} ({$item.customerid|string_format:"%04d"})</a>
			{else}
				{trans("none")}
			{/if}
		</td>
		<td width="1%" nowrap="nowrap">
			{$item.destination|escape}
		</td>
		<td width="97%" align="right">
			{if $item.status == $smarty.const.MSG_SENT}
				{trans("sent")}
			{elseif $item.status == $smarty.const.MSG_ERROR}
				{trans("errornous")}{if $item.error} ({$item.error|escape}){/if}
			{else}
				{trans("waiting")}
			{/if}
		</td>
		<td width="1%" align="RIGHT" class="fright" nowrap="nowrap">
		</td>
	</tr>
	{sectionelse}
	<tr>
		<td width="100%" class="fall" align="center" colspan="4">
			<P>&nbsp;</P>
			<P><strong>{trans("No such recipients in database.")}</strong></P>
			<P>&nbsp;</P>
		</td>
	</tr>	
	{/section}
	{if $listdata.total != 0}
	<tr class="dark">
		<td width="100%" class="fall" colspan="4">
			{include file="scroller.html" loop=$itemlist scrollerno=2}
		</td>
	</tr>
	{/if}
	<tr class="dark">
		<td width="2%" class="fleftu" colspan="2" nowrap="nowrap">
		</td>
		<td class="frightu" colspan="2">
			<strong>{t a=$listdata.total}Total: $a{/t}</strong>
		</td>
	</tr>
</table>
{include file="footer.html"}

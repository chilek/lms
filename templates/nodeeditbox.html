<!--// $Id$ //-->
<form name="editnode" id="editnode" method="POST" action="?m=nodeedit&id={$nodeinfo.id}">
<input type="submit" class="hiddenbtn">
<input type="hidden" name="nodeedit[id]" value="{$nodeinfo.id}">
<table style="width: 100%;" cellpadding="3">
	<tr class="DARK">
		<td style="width: 1%;" class="FLEFTU">
			<img src="img/node.gif" alt="">
		</td>
		<td style="width: 99%;" class="FRIGHTU" colspan="2">
			<input type="TEXT" name="nodeedit[name]" value="{$nodeinfo.name}" maxlength="32" size="30" {tip text="Enter node name" trigger="name" bold=1}>
			<span class="bold">({$nodeinfo.id|string_format:"%04d"})</span>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 100%;" colspan="3" class="flr container">
			<table style="width: 100%;" cellpadding="0">
				<tr class="LIGHT">
					<td style="width: 50%; vertical-align: top;">
						<table style="width: 100%;" cellpadding="3">
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/ip.gif" alt="{trans("IP address:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<input type="TEXT" name="nodeeditipaddr" value="{$nodeinfo.ip}" {tip text="Enter IP address" trigger="ipaddr"}> <a href="javascript: void(0);" onClick="return ipchoosewin(document.editnode.nodeeditipaddr,{$nodeinfo.netid});" {tip text="Click to select IP from the list"}>&raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/ip_pub.gif" alt="{trans("Pub. IP address:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<input type="TEXT" name="nodeeditipaddrpub" {if $nodeinfo.ip_pub != "0.0.0.0"}VALUE="{$nodeinfo.ip_pub}"{/if} {tip text="Enter IP address (optional)" trigger="ipaddr_pub"}> <a href="javascript: void(0);" onClick="return ipchoosewin(document.editnode.nodeeditipaddrpub,{$nodeinfo.netid});" {tip text="Click to select IP from the list"}>&raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/mac.gif" alt="{trans("MAC address:")}">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			<table style="width: 100%;" cellpadding="1" cellspacing="0">
				{foreach from=$nodeinfo.macs item=item key=key}
				<tr id="mac{$key}">
					<td style="width: 100%;"><input type="TEXT" name="nodeedit[macs][{$key}]" value="{$item}" {tip text="Enter MAC address" trigger="mac`$key`"}> <a href="javascript: void(0);" onClick="return macchoosewin(document.editnode.elements['nodeedit[macs][{$key}]']);" {tip text="Click to select MAC from the list"}>&raquo;&raquo;&raquo;</a></td>
				</tr>
				{/foreach}
			</table>
			<input type="HIDDEN" id="macscount" value="{$item@total}">
			<a href="javascript: newmac()">{trans("Add MAC address")} &raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/passwd.gif" alt="{trans("Password:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<input type="TEXT" name="nodeedit[passwd]" value="{$nodeinfo.passwd}" {tip text="Enter password (optional)" trigger="passwd"}> <a href="javascript: GenPasswd();" {tip text="Click to generate random password"}>&raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%; vertical-align: top;">
			<img src="img/home.gif" alt="{trans("Location:")}">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			<input type="TEXT" size="40" value="{$nodeinfo.location}" id="location" name="nodeedit[location]"  {tip text="Enter location (optional)" trigger="location"}>
			<a href="javascript: void(0);" onclick="if (check_teryt()) return locationchoosewin('nodeedit', 'editnode', document.forms['editnode'].elements['nodeedit[location_city]'].value,  document.forms['editnode'].elements['nodeedit[location_street]'].value)" {tip text="Click to select location"}>&raquo;&raquo;&raquo;</a>
			<br />
			<input type="hidden" name="nodeedit[location_city]" value="{$nodeinfo.location_city}">
			<input type="hidden" name="nodeedit[location_street]" value="{$nodeinfo.location_street}">
			<input type="hidden" name="nodeedit[location_house]" value="{$nodeinfo.location_house}">
			<input type="hidden" name="nodeedit[location_flat]" value="{$nodeinfo.location_flat}">
			<input type="checkbox" name="nodeedit[teryt]" id="teryt" onchange="check_teryt('location')"{if $nodeinfo.teryt} checked="checked"{/if}><label for="teryt">{trans("TERRIT-DB")}</label>
		</td>
	</tr>
{*
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/network.gif" alt="{trans("Network:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<span class="bold"><a href="?m=netinfo&id={$nodeinfo.netid}">{$nodeinfo.netname}</a></span>
		</td>
	</tr>
*}
{if $netdevices}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/netdev.gif" alt="{trans("Net devices:")}">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			<select size="1" name="nodeedit[netdev]" {tip text="Select net device from list" trigger="netdev"} style="max-width:250px;">
				<option value="0" {if ! $nodeinfo.netdev}SELECTED{/if}>- {trans("no device")} -</option>
				{section name="netdev" loop=$netdevices}
				<option value="{$netdevices[netdev].id}" {if $nodeinfo.netdev == $netdevices[netdev].id} SELECTED {/if}>{$netdevices[netdev].name} {if $netdevices[netdev].producer}/ {$netdevices[netdev].producer}{/if} {if $netdevices[netdev].location}({$netdevices[netdev].location }){/if}</option>
				{/section}
			</select>
			<input type="text" name="nodeedit[port]" value="{if $nodeinfo.port}{$nodeinfo.port}{/if}" size="2" {tip text="Enter port number in device (optional)" trigger="port"}>
			<br />
			<select name="nodeedit[linktype]" id="linktype" {tip trigger="linktype" text="Select link type"}>
				{foreach from=$_LINKTYPES item=item key=key}
				<option value="{$key}"{if $key==$nodeinfo.linktype} selected{/if}>{$item}</option>
				{/foreach}
			</select>
			<select name="nodeedit[linkspeed]" id="linkspeed" {tip trigger="linkspeed" text="Select link speed"}>
				{foreach from=$_LINKSPEEDS item=item key=key}
				<option value="{$key}"{if $key==$nodeinfo.linkspeed} selected{/if}>{$item}</option>
				{/foreach}
			</select>
		</td>
	</tr>
{/if}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/customer.gif" alt="{trans("Customer:")}">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			{if $customers}
			<select size="1" name="nodeedit[customerid]" {tip text="Assign node to customer"} style="max-width:160px;" onChange="document.editnode.elements['nodeedit[ownerid]'].value=this.value">
				{foreach from=$customers item=c}
				<option value="{$c.id}"{if $nodeinfo.ownerid eq $c.id} SELECTED{/if}>{$c.customername|truncate:40:"...":true} ({$c.id|string_format:"%04d"})</option>
				{/foreach}
			</select>
			{trans("or Customer ID:")}
			{/if}
			<input type="TEXT" name="nodeedit[ownerid]" value="{$nodeinfo.ownerid}" size="5"{if $customers} onChange="reset_customer()" onfocus="reset_customer()"{/if} {tip text="Enter customer ID" trigger="ownerid"}>
			<a href="javascript: void(0);" onClick="return customerchoosewin(document.editnode.elements['nodeedit[ownerid]']);" {tip text="Click to search customer"}>{trans("Search")}&nbsp;&raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/options.gif" alt="">
		</td>
		<td style="width: 98%; white-space: nowrap;" colspan="2">
			<label for="chkmac">{trans("MAC checking")}:</label><input type="checkbox" name="nodeedit[chkmac]" value="1" id="chkmac" {tip text="Enable/disable MAC address checking" trigger="chkmac"}{if !isset($nodeinfo.chkmac) || $nodeinfo.chkmac} checked="checked"{/if}>&nbsp;
			<label for="duplex">{trans("Half duplex")}:</label><input type="checkbox" name="nodeedit[halfduplex]" value="1" id="duplex" {if $nodeinfo.halfduplex} checked="checked"{/if} {tip text="Select transmission mode"}> 
		</td>
	</tr>
					</table>
				</td>
				<td style="width: 50%; vertical-align: top;">
					<table style="width: 100%;" cellpadding="3">
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/home.gif" alt="{trans("GPS coordinates:")}">
		</td>
		<td style="width: 1%; white-space: nowrap;">
			<span class="bold">{trans("GPS longitude:")}</span>
		</td>
		<td style="width: 98%; white-space: nowrap;">
			<input id="longitude" type="text" name="nodeedit[longitude]" value="{if $nodeinfo.longitude}{$nodeinfo.longitude}{else}{/if}" {tip text="Enter device longitude (optional)" trigger="longitude"}>
			<a href="javascript: void(0);" onClick="return gpscoordschoosewin(document.editnode.elements['nodeedit[longitude]'], document.editnode.elements['nodeedit[latitude]']);" {tip text="Click to select gps coordinates from map"}>&raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/home.gif" alt="{trans("GPS coordinates:")}">
		</td>
		<td style="width: 1%; white-space: nowrap;">
			<span class="bold">{trans("GPS latitude:")}</span>
		</td>
		<td style="width; 98%; white-space: nowrap;">
			<input id="latitude" type="text" name="nodeedit[latitude]" value="{if $nodeinfo.latitude}{$nodeinfo.latitude}{else}{/if}" {tip text="Enter device latitude (optional)" trigger="latitude"}>
			<a href="javascript: void(0);" onClick="return gpscoordschoosewin(document.editnode.elements['nodeedit[longitude]'], document.editnode.elements['nodeedit[latitude]']);" {tip text="Click to select gps coordinates from map"}>&raquo;&raquo;&raquo;</a>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/info1.gif" alt="{trans("Description:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<textarea name="nodeedit[info]" cols="50" rows="5" {tip text="Enter additional information (optional)"}>{$nodeinfo.info}</textarea>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/{if ! $nodeinfo.access}no{/if}access.gif" alt="">
		</td>
		<td style="width: 99%;" colspan="2">
			<select size="1" name="nodeedit[access]" {tip text="Select node status" trigger="access"}>
				<option value="1"{if $nodeinfo.access} SELECTED{/if}>{trans("connected<!singular>")}</option>
				<option value="0"{if ! $nodeinfo.access} SELECTED{/if}>{trans("disconnected<!singular>")}</option>
			</select>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/warning{if !$nodeinfo.warning}off{else}on{/if}.gif" alt="">
		</td>
		<td style="width: 99%;" colspan="2">
			<select size="1" name="nodeedit[warning]" {tip text="Set notice for node"}>
				<option value="1"{if $nodeinfo.warning} SELECTED{/if}>{trans("enabled")}</option>
				<option value="0"{if ! $nodeinfo.warning} SELECTED{/if}>{trans("disabled")}</option>
			</select>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/users.gif" alt="">
		</td>
		<td style="width: 1%;">
			<span class="bold">{trans("Created:")}<br />
			{trans("Modified:")}</span>
		</td>
		<td style="width: 98%;">
			{$nodeinfo.createdby}, {$nodeinfo.creationdateh}<br />
			{if $nodeinfo.moddate}{$nodeinfo.modifiedby}, {$nodeinfo.moddateh}{else}-{/if}
		</td>
	</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 100%; text-align: right;" class="FBOTTOMU" colspan="3">
			<a href="javascript:document.editnode.submit();" accesskey="s">{trans("Submit")} <img src="img/save.gif" alt=""></a>
			<a href="?m=nodeinfo&id={$nodeinfo.id}">{trans("Cancel")} <img src="img/cancel.gif" alt=""></a>
		</td>
	</tr>
</table>
</form>
<script type="text/javascript">
<!--
	document.forms['editnode'].elements['nodeedit[name]'].focus();

	function GenPasswd()
	{
		if(! confirm('{trans("Are you sure, you want to generate new password?")}'))
			return;

		var passwd = new Array();
		var items = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
		var length = {get_conf('phpui.nodepassword_length', '16')};
		if (length > 32) length = 32;

		for (var i=0; i<length; i++)
		{
			n = Math.floor(Math.random() * items.length);
			passwd[i] = items.substring(n, n+1);
		}

		document.forms['editnode'].elements['nodeedit[passwd]'].value = passwd.join("");
	}

	function newmac()
	{
		var macscountelem = document.getElementById('macscount');
		var nr = macscountelem.value;
		var lastmacelem = document.getElementById('mac' + (nr - 1));
		var newrow = lastmacelem.parentNode.insertRow(lastmacelem.rowIndex + 1);
		newrow.id = 'mac' + nr;
		var newcell = newrow.insertCell(0);
		newcell.style.width = '100%';
		newcell.innerHTML = '<input type="TEXT" name="nodeedit[macs][' + nr + ']" value=""'
			+ ' onmouseover="popup(\'{trans("Enter MAC address")}\')" onmouseout="pophide()">'
			+ '<a href="javascript: void(0);" onClick="return macchoosewin(document.editnode.elements[\'nodeedit[macs][' + nr + ']\']);"'
			+ ' onmouseover="popup(\'{trans("Click to select MAC from the list")}\')" onmouseout="pophide()">&nbsp;&raquo;&raquo;&raquo;</a>';
		macscountelem.value = parseInt(nr) + 1;
	}

	function reset_customer()
	{
		var val;
		if (val = document.forms['editnode'].elements['nodeedit[ownerid]'].value)
			document.forms['editnode'].elements['nodeedit[customerid]'].value = val;
	}

	check_teryt('location', true);
//-->
</script>


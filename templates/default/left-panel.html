<div id="lms-ui-main-menu-toggle"></div>
<div id="lms-ui-left-panel" role="navigation" class="no-print">
	<img src="{ConfigHelper::getConfig('phpui.logo', 'img/logo-40.png')}" alt="LMS {$layout.lmsv}">
	<div id="lms-ui-main-menu">
		<script>

			var mainMenuVisible = getCookie('main-menu-visible');
			mainMenuVisible = mainMenuVisible === null || mainMenuVisible == 'true';
			if (!mainMenuVisible) {
				$('#lms-ui-left-panel').hide();
			}

			$('#lms-ui-main-menu-toggle').click(function () {
				var mainMenuVisible = $('#lms-ui-left-panel').toggle().is(':visible');
				if (mainMenuVisible) {
					$('#lms-ui-main-menu-toggle').addClass('visible');
				} else {
					$('#lms-ui-main-menu-toggle').removeClass('visible');
				}
				setCookie('main-menu-visible', mainMenuVisible);
			});

		</script>
		<table id="main-menu" class="click-menu" cellpadding="0" cellspacing="0">
			{foreach $newmenu as $menuindex => $menuitem}
			<tr id="menu-{$menuindex}">
				<td class="click-menu bottomline">
					<div{if $menuitem.tip} {tip class="tip" text="\$a" a=$menuitem.tip bold=1}{else} class="tip"{/if}{if ! $menuitem.submenu} onClick="{if $menuitem.windowopen}window.open('{$menuitem.link}'); {else}return self.location.href = '{$menuitem.link}'; {/if}"{/if}>
						<div class="box1">
							{if isset($menuitem.img)}
								<img src="img/{$menuitem.img}">
							{else}
								<i class="{$menuitem.css}"></i>
							{/if}
							{$menuitem.name}
						</div>
					</div>
					<div class="section">
						{if $menuitem.submenu}
							{foreach from=$menuitem.submenu item=submenuitem}
								<div{if $submenuitem.tip} {tip class="tip" text="\$a" a=$submenuitem.tip bold="1"}{else} class="tip"{/if}>
									<div class="box2"><a href="{$submenuitem.link|replace:"&":"&amp;"}">
											<li>{$submenuitem.name}</li>
										</a></div>
								</div>
							{/foreach}
						{/if}
					</div>
				</td>
			</tr>
			{/foreach}
			<tr id="menu-logout">
				<td class="click-menu bottomline">
					<div {tip class="tip" text="Allows you to logout" bold=1} onClick={if ConfigHelper::getConfig('phpui.logout_confirmation')}"if (confirm('{trans("Are you sure that you want to logout?")}')) { return self.location.href='?m=logout&amp;is_sure=1'; } "{else}"self.location.href='?m=logout&amp;is_sure=1';"{/if}>
						<div class="box1">
							<i class="lms-ui-icon-logout"></i>
							{trans("Logout")} {$layout.logname|truncate:10:"..."}
						</div>
					</div>
				</td>
			</tr>
		</table>
		<script>

			var mainMenu = new ClickShowHideMenu({
				id: 'main-menu',
				maxOpened: {intval(ConfigHelper::getConfig('phpui.max_opened_menus', 3))}
			});
			mainMenu.init();

			$('#main-menu').sortable({
				items: "tr",
				handle: "i,img",
				axis: "y",
				opacity: 0.9,
				update: function (event, ui) {
					data = {};
					data['main-menu-order'] = $(this).sortable("toArray").join(';');
					savePersistentSettings(data);
				}
			});

			restoreSortable('main-menu', '{$main_menu_sortable_order}');

		</script>
	</div>

	<p id="lms-ui-copyrights">
		&copy; 2001-{$smarty.now|date_format:'%Y'}<br><A href="?m=copyrights">LMS Developers</A>
	</p>
</div>

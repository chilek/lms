{extends file="layout.html"}
{block name=title}LMS: {$layout.pagetitle|striphtml}{/block}
{block name=module_content}
<!--// $Id$ //-->
<H1>{$layout.pagetitle}</H1>
<TABLE class="lmsbox">
	<COLGROUP>
		<COL style="1%;">
		<COL style="1%;">
		<COL style="98%;">
	</COLGROUP>
    <THEAD>
	<TR>
	    <TD>
        {icon name="queue"}
	    </TD>
	    <TD class="bold">{$queue.name} ({$queue.id|string_format:"%04d"})</TD>
	</TR>
    </THEAD>
    <TBODY>
	{if $queue.email}
	<TR>
	    <TD class="nobr bold">
        {icon name="mail" label="E-mail:"}
	    </TD>
	    <TD>{$queue.email}</TD>
	</TR>
	{/if}
	{if $queue.description}
	<TR>
	    <TD class="nobr bold">
            {icon name="description" label="Description:"}
	    </TD>
	    <TD>
		<TABLE cellpadding="5">
		    <TR>
			<TD class="fall superlight">
			    {$queue.description|replace:"\n":"<BR>"}
			</TD>
		    </TR>
		</TABLE>
	    </TD>
	</TR>
	{/if}
	<TR>
		<TD class="nobr bold">
            {icon name="verifier" label="<!rt>Verifier:"}
		<TD>
		{if $queue.verifierid}
			<a href="?m=userinfo&id={$queue.verifier.id}">{$queue.verifier.name}</a>
		{else}
			{trans("None")}
		{/if}
		</TD>
	</TR>
	<TR>
	    <TD class="nobr bold">
            {icon name="user" label="Privileges:"}
	    </TD>
	    <TD>
		    <TABLE class="lmsbox">
				<COLGROUP>
					<COL style="width: {100-count($_RT_RIGHTS)}%;">
					{foreach $_RT_RIGHTS as $label}
					<COL style="width: 1%;">
					{/foreach}
				</COLGROUP>
				<THEAD>
					<TR>
						<TD class="bold">{trans("User")}</TD>
						{foreach $_RT_RIGHTS as $label}
						<TD class="text-center bold nobr">{$label}</TD>
						{/foreach}
					</TR>
				</THEAD>
				<TBODY>
					{cycle values="light,lucid" print=false}
					{foreach from=$queue.rights item=right}
					{if $right.rights}
					<TR class="highlight {cycle}"  >
						<TD>
							<A href="?m=userinfo&id={$right.id}">{$right.name}</A>
							<INPUT type="hidden" name="queue[usernames][{$right.id}]" value="{$right.name}">
						</TD>
						{foreach $_RT_RIGHTS as $rightvalue => $label}
						<TD class="text-center">
							{if ($right.rights & $rightvalue) == $rightvalue}{icon name="password"}{/if}
						</TD>
						{/foreach}
					</TR>
					{/if}
					{/foreach}
				</TBODY>
			</TABLE>
	    </TD>
	</TR>
	{if !empty($queue.categories)}
	<TR>
		<TD class="nobr bold">
            {icon name="queue" label="Default categories:"}
		</TD>
		<TD>
			<FIELDSET>
				{foreach $queue.categories as $category}{if !$category@first}, {/if}<a href="?m=rtqueueview&catid={$category.categoryid}">{$category.name}</a>{/foreach}
			</FIELDSET>
		 </TD>
	</TR>
	{/if}
	{if $queue.newticketsubject}
	<TR>
		<TD class="nobr bold">
            {icon name="mail" label="New ticket customer notification subject:"}
		</TD>
		<TD>
			{$queue.newticketsubject|replace:"\n":"<BR>"}
		</TD>
	</TR>
	{/if}
	{if $queue.newticketbody}
	<TR>
		<TD>
            {icon name="edit" label="New ticket customer notification body:"}
		</TD>
		<TD>
			<TABLE width="100%" cellpadding="5">
				<TR>
					<TD class="fall superlight">
						{$queue.newticketbody|replace:"\n":"<BR>"}
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	{/if}
	{if $queue.newmessagesubject}
	<TR>
		<TD class="nobr bold">
            {icon name="mail" label="New message customer notification subject:"}
		</TD>
		<TD>
			{$queue.newmessagesubject|replace:"\n":"<BR>"}
		</TD>
	</TR>
	{/if}
	{if $queue.newmessagebody}
	<TR>
		<TD class="nobr bold">
            {icon name="edit" label="New message customer notification body:"}
		</TD>
		<TD>
			<TABLE cellpadding="5">
				<TR>
					<TD class="fall superlight">
						{$queue.newmessagebody|replace:"\n":"<BR>"}
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	{/if}
	{if $queue.resolveticketsubject}
	<TR>
		<TD style="width: 1%;">
            {icon name="mail" label="Resolve ticket customer notification subject:"}
		</TD>
		<TD>
			{$queue.resolveticketsubject|replace:"\n":"<BR>"}
		</TD>
	</TR>
	{/if}
	{if $queue.resolveticketbody}
	<TR>
		<TD class="nobr bold">
            {icon name="edit" label="Resolve ticket customer notification body:"}
		</TD>
		<TD>
			<TABLE cellpadding="5">
				<TR>
					<TD class="fall superlight">
						{$queue.resolveticketbody|replace:"\n":"<BR>"}
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	{/if}
	{if $queue.verifierticketsubject}
	<TR>
		<TD class="nobr bold">
            {icon name="edit" label="Ticket verifier notification subject:"}
		</TD>
		<TD>
			<TABLE cellpadding="5">
				<TR>
					<TD class="fall superlight">
						{$queue.verifierticketsubject|replace:"\n":"<BR>"}
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	{/if}
	{if $queue.verifierticketbody}
	<TR>
		<TD class="nobr bold">
            {icon name="edit" label="Ticket verifier notification body:"}
		</TD>
		<TD>
			<TABLE cellpadding="5">
				<TR>
					<TD class="fall superlight">
						{$queue.verifierticketbody|replace:"\n":"<BR>"}
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	{/if}
	<TR>
	    <TD COLSPAN="3" class="text-right">
			{button label="Browse" icon="view" onclick="location.href='?m=rtqueueview&id={$queue.id}'"}
	    	{button label="Edit" icon="edit" onclick="location.href='?m=rtqueueedit&id={$queue.id}'"}
		{if $queue.deleted == 1 && $queue.deltime != 0 && (ConfigHelper::checkPrivilege('helpdesk_advanced_operations'))}
			{button icon="restore" label="Restore" id="restore-rtqueue" onclick="location.href='?m=rtrestore&id={$queue.id}&qaction=restore'" data-name="{$queue.name}"}
			{button icon="delete" label="Delete" id="remove-rtqueue" onclick="location.href='?m=rtqueuedel&id={$queue.id}&qaction=delperm'" data-name="{$queue.name}"}
		{else}
			{button icon="delete" label="Delete" id="delete-rtqueue" onclick="location.href='?m=rtqueuedel&id={$queue.id}&qaction=delete'" data-name="{$queue.name}"}
		{/if}
	    </TD>
	</TR>
    </TBODY>
</TABLE></P>
	<script>
		$('#delete-rtqueue').click(function() {
			var name = $(this).attr('data-name');
			confirmDialog($t("Are you sure, you want to remove queue '$a' and all assigned tickets and messages?", name), this).done(function() {
				location.href = $(this).attr('href');
			});
			return false;
		});
		$('#restore-rtqueue').click(function() {
			var name = $(this).attr('data-name');
			confirmDialog($t("Are you sure, you want to restore queue '$a' and all assigned tickets and messages?", name), this).done(function() {
				location.href = $(this).attr('href');
			});
			return false;
		});
		$('#remove-rtqueue').click(function() {
			var name = $(this).attr('data-name');
			confirmDialog($t("Are you sure, you want to permanently remove queue '$a' and all assigned tickets and messages?", name), this).done(function() {
				location.href = $(this).attr('href');
			});
			return false;
		});
	</script>
{/block}

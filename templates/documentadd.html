{include file="header.html"}
<!--// $Id$ //-->
<H1>{$layout.pagetitle}</H1>
{include file="calendar_js.html"}
{$xajax}
{literal}
<script type="text/javascript">
<!--
	function getplugin()
	{
		xajax_plugin(document.forms['documentadd'].elements['document[templ]'].value, document.forms['documentadd'].elements['customer'].value);
	}
	
	function print_document()
	{
		document.forms['documentadd'].action += '&print=1';
		document.forms['documentadd'].submit();
	}
//-->
</script>
{/literal}
<P><FORM name="documentadd" method="POST" action="?m=documentadd" enctype="multipart/form-data">
<INPUT type="submit" class="hiddenbtn">
<TABLE cellpadding="3" WIDTH="100%">
	<TR class="DARK">
		<TD width="1%" class="fleftu">
			<IMG src="img/docum.gif" alt="">
		</TD>
		<TD width="1%" class="fbt" NOWRAP>
			<B>{t}Title:{/t}
		</TD>
		<TD width="98%" class="frightu" NOWRAP>
			<INPUT type="text" name="document[title]" value="{$document.title}" {tip text="Enter document title" trigger="title"} size="40">
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
			<IMG src="img/docum.gif" alt="">
		</TD>
		<TD width="1%">
			<B>{t}Number:{/t}
		</TD>
		<TD width="98%" class="fright">
			<INPUT type="text" name="document[number]" value="{if $document.number}{$document.number}{/if}" size="15" {tip text="Enter document number (leave this field empty to obtain next number)" trigger="number"}>&nbsp;
			{if $numberplans}
			<SELECT name="document[numberplanid]" {tip text="Select numbering plan"}>
			{foreach item=plan from=$numberplans}
				{assign var=period value=$plan.period}
				<OPTION value="{$plan.id}"{if $plan.id==$document.numberplanid} SELECTED{/if}>{number number=$plan.next template=$plan.template time=$document.cdate} ({$_NUM_PERIODS.$period})</OPTION>
			{/foreach}
			{else}
				<INPUT type="hidden" name="document[numberplanid]" value="0">
			{/if}
			</SELECT>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
			<IMG src="img/info.gif" alt="">
		</TD>
		<TD width="1%">
			<B>{t}Type:{/t}
		</TD>
		<TD width="98%" class="fright">
			<SELECT SIZE="1" NAME="document[type]" {tip text="Select document type" trigger="type"}>
				<OPTION VALUE="0">... {t}select type{/t} ...</OPTION>
				{foreach from=$_DOCTYPES key=key item=item}{if $key < 0}
				<OPTION VALUE="{$key}"{if $document.type==$key} SELECTED{/if}>{$item}</OPTION>
				{/if}{/foreach}
			</SELECT>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
			<IMG src="img/calendar.gif" alt="">
		</TD>
		<TD width="1%">
			<B>{t}Period:{/t}
		</TD>
		<TD width="98%" class="fright">
			{t}from:{/t} <INPUT type="TEXT" name="document[fromdate]" value="{if $document.fromdate}{$document.fromdate}{/if}" OnClick="cal1.popup();" {tip text="Enter start date in YYYY/MM/DD format (optional)" trigger="fromdate"} size="10">&nbsp;
			{t}to:{/t} <INPUT type="TEXT" name="document[todate]" value="{if $document.todate}{$document.todate}{/if}" OnClick="cal2.popup();" {tip text="Enter end date in YYYY/MM/DD format (optional)" trigger="todate"} size="10"><BR>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
			<IMG src="img/info.gif" alt="">
		</TD>
		<TD width="1%">
			<B>{t}Description:{/t}
		</TD>
		<TD width="98%" class="fright">
			<TEXTAREA name="document[description]" rows="5" cols="50" {tip text="Enter additional informations (optional)"}>{$document.description}</TEXTAREA>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
			<IMG src="img/save.gif" alt="">
		</TD>
		<TD width="1%">
			<B>{t}File:{/t}
		</TD>
		<TD width="98%" class="fright">
			<INPUT size="50" type="file" name="file" {tip text="Enter path to file or click 'Browse' button" trigger="file"}>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
			<IMG src="img/class.gif" alt="">
		</TD>
		<TD width="1%">
			<B>{t}Template:{/t}
		</TD>
		<TD width="98%" class="fright">
			<SELECT SIZE="1" NAME="document[templ]" {tip text="Select template to generate new document if you haven't got prepared file" trigger="template"} onchange="getplugin();">
				<OPTION VALUE="">... {t}select template{/t} ...</OPTION>
				{foreach from=$docengines item=item}
				<OPTION VALUE="{$item.name}"{if $document.template==$item.name} SELECTED{/if}>{$item.title}</OPTION>
				{/foreach}
			</SELECT>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD width="1%" class="fleft">
	        	<IMG src="img/confirm.gif" ALT="">
		</TD>
		<TD width="1%" nowrap><B>{t}Confirmed:{/t}</B></TD>
		<TD width="98%" class="fright">
		        <INPUT type="checkbox" name="document[closed]" value="1" class="box light" {if $document.closed} checked{/if}>
		</TD>
	</TR>
	<TR CLASS="light">
		<TD width="1%" class="fleft">
	        	<IMG src="img/customer.gif" ALT="">
		</TD>
		<TD width="1%" nowrap>
			<B>{t}Customer:{/t}</B>
		</TD>
		<TD class="fright" WIDTH="98%" nowrap>
			<SELECT SIZE="1" NAME="customer" onChange="document.documentadd.customerid.value=document.documentadd.customer.value" {tip trigger="customer"}>
				<OPTION VALUE="0">{t}... select customer ...{/t}</OPTION>
				{foreach from=$customers item=c}
				<OPTION VALUE="{$c.id}"{if $c.id eq $customer.id || $document.customerid eq $c.id} SELECTED{/if}>{$c.customername|truncate:"40":"...":true} ({$c.id|string_format:"%04d"})</OPTION>
				{/foreach}
			</SELECT>
			{t}or Customer ID:{/t}
			<INPUT TYPE="TEXT" NAME="customerid" VALUE="{if $customer.id}{$customer.id}{else}{$document.customerid}{/if}" SIZE="5" onChange="document.documentadd.customer.value=document.documentadd.customerid.value">
			<a href="javascript: void(0);" onClick="return customerchoosewin(document.documentadd.customer);" {tip text="Click to search customer"}>{t}Search{/t}&nbsp;&raquo;&raquo;&raquo;</A>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD class="fbottomu" colspan="3" align="right" NOWRAP>
			<A href="javascript: document.documentadd.submit();">{t}Submit{/t} <IMG SRC="img/save.gif" alt=""></A>
			<A href="javascript: print_document();">{t}Print{/t} <IMG SRC="img/print.gif" alt=""></A>
			<A href="?m=documentlist">{t}Cancel{/t} <IMG src="img/cancel.gif" alt=""></A><BR>
			<INPUT type="checkbox" name="document[reuse]" value="ON" class="box light" {if $document.reuse}checked{/if}> {t}Display this form again, when that document is saved{/t}
		</TD>
	</TR>
</TABLE>
<BR><DIV id="plugin" name="plugin">{$plugin_result}</DIV>
</FORM></P>
<SCRIPT language="javascript">
<!--
var cal1 = new calendar(document.forms['documentadd'].elements['document[fromdate]']);
cal1.time_comp = false;
var cal2 = new calendar(document.forms['documentadd'].elements['document[todate]']);
cal2.time_comp = false;
document.forms['documentadd'].elements['document[title]'].focus();
//-->
</SCRIPT>
{include file="footer.html"}

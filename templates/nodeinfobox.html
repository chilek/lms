<!--// $Id$ //-->
{$xajax}
<script type="text/javascript">
<!--
	function chkmac_change()
	{
		if (document.getElementById('chkmac').checked)
			location.href = '?m=nodeedit&id={$nodeinfo.id}&action=chkmac&chkmac=1';
		else
			location.href = '?m=nodeedit&id={$nodeinfo.id}&action=chkmac&chkmac=0';
	}

	function duplex_change()
	{
		if (document.getElementById('duplex').checked)
			location.href = '?m=nodeedit&id={$nodeinfo.id}&action=duplex&duplex=1';
		else
			location.href = '?m=nodeedit&id={$nodeinfo.id}&action=duplex&duplex=0';
	}
//-->
</script>
<table style="width: 100%;" cellpadding="3">
	<tr class="DARK">
		<td style="width: 1%;" class="FLEFTU">
			<img src="img/node.gif" alt="">
		</td>
		<td style="width: 99%;" class="FRIGHTU" colspan="2">
			<span class="bold">{$nodeinfo.name} ({$nodeinfo.id|string_format:"%04d"})</span>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 100%;" colspan="3" class="flr container">
			<table style="width: 100%;" cellpadding="0">
				<tr class="LIGHT">
					<td style="width: 50%; vertical-align: top;">
						<table style="width: 100%" cellpadding="3">
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/ip.gif" alt="{trans("IP address:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<a href="javascript:ping_popup('{$nodeinfo.ip}')">{$nodeinfo.ip}</a>
		</td>
	</tr>
	{if $nodeinfo.ip_pub != "0.0.0.0"}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/ip_pub.gif" alt="{trans("Pub. IP address:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<a href="javascript:ping_popup('{$nodeinfo.ip_pub}')">{$nodeinfo.ip_pub}</a>
		</td>
	</tr>
	{/if}
	{assign var="counter" value=0}
	{foreach from=$nodeinfo.macs item=item}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<a href="javascript:changeMacFormat('mac{$counter}')"><img src="img/mac.gif" alt="{trans("MAC address:")}"></a>
		</td>
		<td style="width: 99%;" colspan="2">
			<span id="mac{$counter}">{$item.mac}</span> {if $item.producer}({$item.producer}){/if}<br />
		</td>
	</tr>
	{math equation="x+1" x=$counter assign="counter"}
	{/foreach}
{if $nodeinfo.passwd}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/passwd.gif" alt="{trans("Password:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			{$nodeinfo.passwd}
		</td>
	</tr>
{/if}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/network.gif" alt="{trans("Network:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<span class="bold"><a href="?m=netinfo&id={$nodeinfo.netid}">{$nodeinfo.netname}</a></span>
		</td>
	</tr>
{if $nodeinfo.location}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/home.gif" alt="{trans("Location:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			{$nodeinfo.location}
		</td>
	</tr>
{/if}
{if $nodeinfo.netdev || $netdevices}
{if !$nodeinfo.netdev && $netdevices}
	<form method="GET" action="?m=nodeedit" name="nodelink">
	<input type="HIDDEN" name="m" value="nodeedit">
	<input type="HIDDEN" name="id" value="{$nodeinfo.id}">
	<input type="HIDDEN" name="action" value="link">
	<input type="submit" class="hiddenbtn">
{/if}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/netdev.gif" alt="{trans("Net device:")}">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			{if $nodeinfo.netdev}
				<span class="bold">
				<a href="?m=netdevinfo&id={$netdevices.id}">{$netdevices.name} {$netdevices.producer}{if $netdevices.location} / {$netdevices.location}{/if}</a>
				</span>
				{if $nodeinfo.port}[{$nodeinfo.port}]{/if}
				<img src="img/{if $nodeinfo.linktype == 1}wireless.gif{elseif $nodeinfo.linktype == 2}netdev_takenports.gif{else}netdev_takenports.gif{/if}" alt="{$_LINKTYPES[$nodeinfo.linktype]}" {tip text=$_LINKSPEEDS[$nodeinfo.linkspeed]}>
			{else}
				{if $netdevices}
				<select size="1" style="width: 300px;" name="devid" {tip trigger="netdev"}>
				<option value="0" {if !$netdevice}SELECTED{/if}>- {trans("no device")} -</option>
					{section name=netdev loop=$netdevices}
					{assign var=netdevname value=$netdevices[netdev].name}
					{if $netdevices[netdev].producer}{assign var=netdevname value=$netdevname|cat:" / "|cat:$netdevices[netdev].producer}{/if}
					{if $netdevices[netdev].location}{assign var=netdevname value=$netdevname|cat:" ("|cat:$netdevices[netdev].location|cat:")"}{/if}
					<option value="{$netdevices[netdev].id}" {if $netdevices[netdev].id==$netdevice}SELECTED{/if}>{$netdevname|truncate:120:"...":true}</option>
					{/section}
				</select>
				<input type="text" name="port" value="{if $nodeinfo.port}{$nodeinfo.port}{/if}" size="2" {tip text="Enter port number in device (optional)" trigger="port"}>
				<br />
				<select name="linktype" id="linktype" {tip trigger="linktype" text="Select link type"}>
					{foreach from=$_LINKTYPES item=item key=key}
					<option VAlUE="{$key}"{if $key==100000} selected{/if}>{$item}</option>
					{/foreach}
				</select>
				<SElECT name="linkspeed" id="linkspeed" {tip trigger="linkspeed" text="Select link speed"}>
					{foreach from=$_LINKSPEEDS item=item key=key}
					<option value="{$key}"{if $key==100000} selected{/if}>{$item}</option>
					{/foreach}
				</select>
				<a href="javascript:document.nodelink.submit(); ">{trans("Connect")} <img src="img/edit.gif" alt=""></a>
				{/if}
			{/if}
		</td>
	</tr>
{if !$nodeinfo.netdev && $netdevices}
	</form>
{/if}
{/if}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/options.gif" alt="">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			<label for="chkmac">{trans("MAC checking")}:</label><input type="checkbox" name="chkmac" id="chkmac" value="1" {if $nodeinfo.chkmac} checked="checked"{/if} onchange="chkmac_change();">&nbsp;
			<label for="duplex">{trans("Half duplex")}:</label><input type="checkbox" name="duplex" id="duplex" value="1" {if $nodeinfo.halfduplex} checked="checked"{/if} onchange="duplex_change();">
		</td>
	</tr>
					</table>
				</td>
				<td style="width: 50%; vertical-align: top;">
					<table style="width: 100%;" cellpadding="3">
{if $nodeinfo.info}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/info1.gif" alt="{trans("Description:")}">
		</td>
		<td style="width: 99%;" colspan="2">
			<table style="width; 100%;" cellpadding="5">
				<tr>
					<td class="fall superlight">
						{$nodeinfo.info|replace:"\n":"<br />"}
					</td>
				</tr>
			</table>
		</td>
	</tr>
{/if}
{if $nodeinfo.longitude || $nodeinfo.latitude}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/home.gif" alt="{trans("GPS coordinates:")}">
		</td>
		<td style="width: 1%; white-space: nowrap;">
			<span class="bold">{trans("GPS longitude:")}</span>
		</td>
		<td style="width: 98%; white-space: nowrap;">
			{if $nodeinfo.longitude}{$nodeinfo.longitude}{else}{/if}
			<input type="hidden" id="longitude" name="longitude" value="{$nodeinfo.longitude}">
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/home.gif" alt="{trans("GPS coordinates:")}">
		</td>
		<td style="width: 1%; white-space: nowrap;">
			<span class="bold">{trans("GPS latitude:")}</span>
		</td>
		<td style="width: 98%; white-space: nowrap;">
			{if $nodeinfo.latitude}{$nodeinfo.latitude}{else}{/if}
			<input type="hidden" id="latitude" name="latitude" value="{$nodeinfo.latitude}"> 
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 2%;" colspan="2">
		</td>
		<td style="width: 98%;">
			<a href="?m=netdevmap&nodeid={$nodeinfo.id}"><img src="img/network.gif" alt=""> {trans("Show on map")} &raquo;&raquo;&raquo;</a>
		</td>
	</tr>
{/if}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<a href="?m=nodeset&id={$nodeinfo.id}"><img src="img/{if ! $nodeinfo.access}no{/if}access.gif" alt=""></a>
		</td>
		<td style="width: 99%;" colspan="2">
			<span class="bold">{if $nodeinfo.access}{trans("connected<!singular>")}{else}{trans("disconnected<!singular>")}{/if}</span>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<a href="?m=nodewarn&id={$nodeinfo.id}"><img src="img/warning{if ! $nodeinfo.warning}off{else}on{/if}.gif" alt=""></a>
		</td>
		<td style="width: 99%;" colspan="2">
			<span class="bold">{if $nodeinfo.warning}{trans("notice enabled")}{else}{trans("notice disabled")}{/if}</span>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/time.gif" alt="">
		</td>
		<td style="width: 1%; white-space: nowrap;">
			<span class="bold">{trans("last online:")}</span>
		</td>
		<td style="width: 98%;">
			{if $nodeinfo.lastonline}{$nodeinfo.lastonlinedate}{else}-{/if}
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/users.gif" alt="">
		</td>
		<td style="width: 1%;">
			<span class="bold">{trans("Created:")}<br />
			{trans("Modified:")}</span>
		</td>
		<td style="width: 98%;">
			{$nodeinfo.createdby}, {$nodeinfo.creationdateh}<br />
			{if $nodeinfo.moddate}{$nodeinfo.modifiedby}, {$nodeinfo.moddateh}{else}-{/if}
		</td>
	</tr>
{if $nodestats.month.download.data || $nodestats.month.upload.data}
	<tr class="LIGHT">
		<td style="width: 1%;">
			<img src="img/traffic.gif" alt="">
		</td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			<span class="bold">{trans("Traffic stats from last (download/upload):")}</span>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 1%;"></td>
		<td style="width: 99%; white-space: nowrap;" colspan="2">
			<table style="width: 100%;" cellpadding="3">
				<tr>
					<td style="width: 1%; white-space: nowrap;">
						<a href="javascript:popup('?m=trafficgraph&nodeid={$nodeinfo.id}&bar=hour',1,1,10,10)"><span class="bold">{trans("hour:")}</span></a>
					</td>
					<td style="width: 99%; white-space: nowrap;">
						{$nodestats.hour.download.data|string_format:"%.2f"} {$nodestats.hour.download.units} ({$nodestats.hour.downavg|string_format:"%d"} kbit/s) / {$nodestats.hour.upload.data|string_format:"%.2f"} {$nodestats.hour.upload.units} ({$nodestats.hour.upavg|string_format:"%d"} kbit/s) 
					</td>
				</tr>
				<tr>
					<td style="width:1%; white-space: nowrap;">
						<a href="javascript:popup('?m=trafficgraph&nodeid={$nodeinfo.id}&bar=day',1,1,10,10)"><span class="bold">{trans("24 hour:")}</span></a>
					</td>
					<td style="width: 99%; white-space: nowrap;">
						{$nodestats.day.download.data|string_format:"%.2f"} {$nodestats.day.download.units} ({$nodestats.day.downavg|string_format:"%d"} kbit/s) / {$nodestats.day.upload.data|string_format:"%.2f"} {$nodestats.day.upload.units} ({$nodestats.day.upavg|string_format:"%d"} kbit/s)
					</td>
				</tr>
				<tr>
					<td style="width: 1%; white-space: nowrap;">
						<a href="javascript:popup('?m=trafficgraph&nodeid={$nodeinfo.id}&bar=month',1,1,10,10)"><span class="bold">{trans("30 days:")}</span></a>
					</td>
					<td style="width: 99%; white-space: nowrap;">
						{$nodestats.month.download.data|string_format:"%.2f"} {$nodestats.month.download.units} ({$nodestats.month.downavg|string_format:"%d"} kbit/s) / {$nodestats.month.upload.data|string_format:"%.2f"} {$nodestats.month.upload.units} ({$nodestats.month.upavg|string_format:"%d"} kbit/s)
					</td>
				</tr>
			</table>
		</td>
	</tr>
{/if}
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr class="LIGHT">
		<td style="width: 100%; text-align: right;" class="FBOTTOMU" colspan="3">
			<a href="?m=nodeedit&id={$nodeinfo.id}" accesskey="E">{trans("Edit")} <img src="img/edit.gif" alt=""></a>
			<a href="?m=nodedel&id={$nodeinfo.id}" onClick="return confirmLink(this, '{t a=$nodeinfo.name}Are you sure, you want to remove node \'$a\' from database?{/t}')">{trans("Delete")} <img src="img/delete.gif" alt=""></a>
		</td>
	</tr>	
</table>

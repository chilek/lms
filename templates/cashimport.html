{include file="header.html"}
<!--// $Id$ //-->
<H1>{$layout.pagetitle}</H1>
{literal}
<SCRIPT type="text/javascript">
	<!--
	function CheckAll()
	{
		for (var i=0; i<document.cashimport.elements.length; i++)
		{
			var e = document.cashimport.elements[i];
			if (e.name != 'allbox')
			e.checked = document.cashimport.allbox.checked;
		}
	}
	
	function CheckAll2()
	{
		document.cashimport.allbox.checked = !document.cashimport.allbox.checked;
		CheckAll();
	}
	
	function Delete()
	{
		document.cashimport.action += '&action=delete';
		document.cashimport.submit();
	}

	//-->
</SCRIPT>
{/literal}
<P><FORM NAME="cashimport" ACTION="?m=cashimport" METHOD="post">
<INPUT type="submit" class="hiddenbtn">
<TABLE WIDTH="100%" CELLPADDING="3">
	<TR CLASS="DARK">
		<TD CLASS="fleftu" WIDTH="1%">
			{t}ID:{/t}
		</TD>
		<TD WIDTH="1%" CLASS="fbt">
			{t}Date:{/t}
		</TD>
		<TD WIDTH="1%" CLASS="fbt">
			<B>{t}Value:{/t}</B>
		</TD>
		<TD WIDTH="40%" CLASS="fbt">
			{t}Customer:{/t}
		</TD>
		<TD WIDTH="55%" CLASS="fbt">
			{t}Description:{/t}
		</TD>
		<TD WIDTH="1%" CLASS="fbt" nowrap>
			{t}Link to:{/t}
		</TD>
		<TD WIDTH="1%" CLASS="frightu" ALIGN="RIGHT" nowrap>
			<B>{t}Total:{/t} {$listdata.total}</B>&nbsp;
		</TD>
	</TR>
	{cycle values="light,lucid" print=false}
	{section name=importlist loop=$importlist}
	<TR class="{cycle}">
		<TD CLASS="fleft">
			{$importlist[importlist].id|string_format:"%04d"}
		</TD>
		<TD NOWRAP>
			{$importlist[importlist].date|date_format:"%Y/%m/%d"}
		</TD>
		<TD NOWRAP ALIGN="RIGHT">
			<B>{$importlist[importlist].value|money_format}</B>
		</TD>
		<TD ALIGN="LEFT">
			{$importlist[importlist].customer}
		</TD>
		<TD ALIGN="LEFT">
			{$importlist[importlist].description}
		</TD>
		<TD ALIGN="RIGHT" CLASS="fright" COLSPAN="2" NOWRAP>
			{if !$importlist[importlist].customerid}
			<SELECT NAME="customer[{$importlist[importlist].id}]" {tip text="Select customer" trigger=$importlist[importlist].id}>
				<OPTION VALUE="0">{t}- select customer -{/t}</OPTION>
				{section name=customerlist loop=$customerlist}
				<OPTION VALUE="{$customerlist[customerlist].id}" {if $customerlist[customerlist].id == $importlist[importlist].customerid}SELECTED{/if}>{$customerlist[customerlist].customername|truncate:40:"...":true} ({$customerlist[customerlist].id|string_format:"%04d"})</OPTION>
				{/section}
			</SELECT>&nbsp;
			{else}
			<INPUT TYPE="hidden" NAME="customer[{$importlist[importlist].id}]" VALUE="{$importlist[importlist].customerid}">
			{/if}
			{cycle print=false}
			<INPUT class="box {cycle}" TYPE="checkbox" NAME="marks[{$importlist[importlist].id}]" VALUE="{$importlist[importlist].id}">
		</TD>
	</TR>
	{sectionelse}
	<TR>
		<TD class="fall" ALIGN="center"  COLSPAN="7">
			<P>&nbsp;</P>
			<P><B>{t}No cash operations to import.{/t}</B></P>
			<P>&nbsp;</P>
		</TD>
	</TR>	
	{/section}
	<TR CLASS="dark">
		<TD CLASS="fleftu" COLSPAN="4">
			<INPUT class="box dark" TYPE="checkbox" NAME="allbox" onClick="CheckAll2();" VALUE="Check All">
			<A HREF="javascript:CheckAll2();">{t}Check All{/t}</A>
		</TD>
		<TD CLASS="frightu" COLSPAN="3" align="right" nowrap>
			<A HREF="javascript:Delete();">{t}Delete{/t} <IMG src="img/delete.gif" ALT=""></A>
			<A HREF="javascript:document.cashimport.submit();">{t}Submit{/t} <IMG src="img/save.gif" ALT=""></A>
		</TD>
	</TR>
</TABLE>
</FORM></P>
{if $error.lines}
<P><TABLE width="100%" CELLPADDING="3">
	<TR class="DARK">
		<TD class="fall" width="100%" colspan="2">
			<B>{t}Errors and Duplicated Entries{/t}:</B>
		</TD>
	</TR>
	<TR>
		<TD class="fall" width="100%">
			<TABLE cellpadding="5" cellspacing="0" WIDTH="100%">
                                <TR class="dark">
				    <TD width="1%"><B>{t}Line:{/t}</B></TD>
				    <TD width="99%"><B>{t}Content:{/t}</B></TD>
				</TR>
				{cycle name=err values="light,lucid" print=false}
				{foreach from=$error.lines key=key item=item}
				<TR class="{cycle name=err}">
				    <TD>{$key}.</TD>
				    <TD>
				    {if is_array($item)}
				    <TABLE width="100%" class="red">
					{if $item.date}<TR><TD width="1%">{t}Date:{/t}</TD><TD width="99%">{$item.date|date_format:"%Y/%m/%d"}</TD></TR>{/if}
					{if $item.customer}<TR><TD width="1%">{t}Customer:{/t}</TD><TD width="99%">
					    {$item.customer}{if $item.customerid} ({$item.customerid|string_format:"%04d"}){/if}</TD></TR>{/if}
					{if $item.value}<TR><TD width="1%">{t}Value:{/t}</TD><TD width="99%">{$item.value|money_format}</TD></TR>{/if}
					{if $item.comment}<TR><TD width="1%">{t}Description:{/t}</TD><TD width="99%">{$item.comment}</TD></TR>{/if}
				    </TABLE>
				    {else}
				    {$item}
				    {/if}
				    </TD>
				</TR>
				{/foreach}
			</TABLE>
		</TD>
	</TR>
</TABLE></P>
{/if}
<P><FORM name="parser" enctype="multipart/form-data" method="post" action="?m=cashimportparser">
<INPUT type="submit" class="hiddenbtn">
<TABLE width="100%" CELLPADDING="3">
	<TR class="DARK">
		<TD class="fall" width="100%" colspan="2">
			<B>{t}Enter path to file with data to import{/t}</B>
		</TD>
	</TR>
	<TR class="LIGHT">
		<TD class="fbl" width="1%" NOWRAP>
			<IMG src="img/attach.gif" alt="">
			<B>{t}Import file:{/t} </B><INPUT name="file" type="file" size="70" {tip text="Enter path to file or click 'Browse' button" trigger="file"}>
		</TD>
		<TD class="fbr" width="99%" align="right" nowrap>
			<A href="javascript: document.parser.submit();">{t}Submit{/t} <IMG src="img/save.gif" alt=""></A>
		</TD>
	</TR>
</TABLE>
</FORM></P>
{include file="footer.html"}

----------------------------------------------------------------------
                    LAN Management System 1.1-cvs
----------------------------------------------------------------------
                      Opis praw dostêpu do LMS
----------------------------------------------------------------------
Od  20.04.2003  LMS  ma  mo¿liwo¶æ  definiowania  poziomów  dostêpu do
systemu.  W  tym  tek¶cie  postaram  siê  opisaæ  jak  funkcjonuje  to
rozwi±zanie.

Dziêki  zastosowaniu  kolumny  `rights`  w  tabeli  `admins` unikn±³em
konieczno¶ci  modyfikacji  bazy  danych.  W  LMS mo¿na zdefiniowaæ 256
regu³ dostêpu. Ka¿da z nich mo¿e zabraniaæ, b±d¼ pozwalaæ,na dostêp do
konkretnych modu³ów. Przypisywanie tych poziomów dostêpu polega nie na
ustawianiu  konkretnego  poziomu,  a  ustawianiu czy admin ma prawo do
danego  poziomu  czy nie (po polsku: mo¿emy przypisaæ adminowi dowoln±
kombinacjê poziomów a nie tylko jeden).

Aktualnie  zdefiniowanych  jest  osiem regu³ dostêpu. 
Siedem z nich s± to regu³y zezwalaj±ce na dostêp do modu³ów oraz jedna
zabraniaj±ca.

Decyzja  czy  u¿ytkownik  ma prawo dostêpu do modu³u czy nie przebiega
nastêpuj±co:

-  najpierw  sprawdzana  jest  lista  modu³ów do których zawsze ma siê
dostêp  (aktualnie  welcome,  copyrights,  logout, chpasswd, przy czym
chpasswd umo¿liwia tylko zmianê w³asnego has³a).

-  potem  s±  sprawdzamy  czy  modu³  pasuje do regu³ w poszczególnych
poziomach do których administrator ma dostêp

-  na  koñcu podejmowana jest decyzja czy u¿ytkownik ma uprawnienia by
do  modu³u siê dobraæ. Je¿eli modu³ siê za³apa³ na któr±kolwiek poziom
który   zabrania  dostêpu  dostêp  zostanie  zabroniony  nawet  je¿eli
administrator  ma  ustawiony  poziom który pozwala na dostêp do modu³u
(np.  kto¶  ma  pe³ny  dostêp oraz brak dostêpu do modu³u od dodawania
komputerów,  nie  bêdzie  on  móg³ siê odwo³aæ do tego modu³u). Je¿eli
modu³  pasuje  do poziomu który pozwala na dostêp do danego modu³u LMS
zezwala  na  dalsz± pracê. Je¿eli natomiast modu³ siê nie "za³apa³" na
¿aden  poziom  równierz  zostanie  mu  wy¶wietlony  komunikat  o braku
dostêpu.

Dodatkow±  komplikacj±  tego  rozwi±zania jest, i¿ je¿eli nie ustawimy
¿adnego   poziomu   dostêpu   administorowi,  zostanie  mu  przypisany
automatycznie  poziom  dostêpu  o  numerze  0  (czyli aktualnie 'pe³en
dostêp').  Jest  to  zabezpieczenie  np. przed prac± z LMS pod wp³ywem
alkoholu.

A jak to jest zapisywane?

W  sumie  tutaj  to  wyt³umaczê  bardziej  dla developerów, gdy¿ osoby
korzystaj±ce z LMS raczej nie bêd± zainteresowane.

Oryginalnie poziomy dostêpu mia³y byæ definiowane poprzez ró¿ne litery
By³o  to  za³o¿enie  z  czasów LMS-0.4, lecz nigdy nie wykorzystane. Z
racji  tego  ¿e  wesz³o  to  do 1.0 d³ugo siê g³owi³em jak wykorzystaæ
64-znakowego  stringa. Otó¿ w kolumnie rights jest poprostu 64-znakowa
(256-bitowa)  liczba  hexadecymalna.  Wiêc  ka¿dy jej znak mo¿e opisaæ
maksymalnie  cztery bity kombinacji (4*64 = 256 - st±d ilo¶æ mo¿liwych
poziomów).  Tak  wiêc  w³±czenie  jakiego¶  poziomu  dostêpu  powoduje
ustawienie  w  tej  liczbie  odpowiedniego  bitu.  I tak je¿eli "pe³en
dostêp"  ma pozycjê 0 w lib/accesstable.php, zostanie ustawiony bit 0,
czyli  bêdzie  to liczba 1. Wiêc poziomy mog± mieæ numery od 0 do 255.
Nie jest to finalne ograniczenie. Stosuj±c wiêcej liter i znaków mo¿na
rozszerzyæ ilo¶æ mo¿liwych kombinacji do przynajmniej 6 bitów na znak,
co da nam 384 kombinacje.

$Id$

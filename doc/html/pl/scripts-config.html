<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Opis i konfiguracja</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="LMS - LAN Management System 1.11-cvs"
HREF="index.html"><LINK
REL="UP"
TITLE="Skrypty"
HREF="scripts.html"><LINK
REL="PREVIOUS"
TITLE="Lista dostÄpnych skryptĂłw"
HREF="scripts-list.html"><LINK
REL="NEXT"
TITLE="Generator plikĂłw konfiguracyjnych (lms-mgc)"
HREF="mgc.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="../images/style.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=UTF-8"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#EBE4D6"
TEXT="#000000"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>LMS - LAN Management System 1.11-cvs</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="scripts-list.html"
ACCESSKEY="P"
>Poprzedni</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Rozdzia&#322; 4. Skrypty</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="mgc.html"
ACCESSKEY="N"
>Nast&#281;pny</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SCRIPTS-CONFIG"
>4.3. Opis i konfiguracja</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-NOTIFY"
>4.3.1. lms-notify</A
></H2
><P
>lms-notify jest dobrym sposobem przypominania ludziom o tym Ĺźe do pracy sieci 
		i ĹÄcz konieczne sÄ ich pieniÄĹźki. Pozwala on na napisanie kilku[-nastu] plikĂłw 
		tekstowych i traktowania ich jako szablonĂłw do mailingu. Skrypt jest 
		wielofunkcyjny, wĹÄczenie okreĹlonego zadania nastÄpuje poprzez
		zdefiniowanie lokalizacji pliku z szablonem wiadomoĹci. Do wysyĹania poczty
		zostaĹ zastosowany moduĹ Mail::Sender.</P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="LMS-NOTIFY-TEMPLATES"
>4.3.1.1. Szablony</A
></H3
><P
>W szablonach moĹźna uĹźywaÄ nastÄpujÄcych zmiennych:</P
><UL
><LI
><P
>%date-m - zostanie zastÄpione aktualnym miesiÄcem, liczÄc od 1 poprzedzone 0, np. 02</P
></LI
><LI
><P
>%date-y - zostanie zastÄpione aktualnym rokiem, np. 2003</P
></LI
><LI
><P
>%date_month_name - zostanie zastÄpione nazwÄ bieĹźÄcego miesiÄca, np. marzec</P
></LI
><LI
><P
>%saldo - zostanie zastÄpione aktualnym saldem klienta, np. 535</P
></LI
><LI
><P
>%abonament - zostanie zastÄpione kwotÄ abonamentu jaka 
					jest do danego klienta przypisana, np. 107</P
></LI
><LI
><P
>%b - saldo z zanegowanym znakiem, np. 107</P
></LI
><LI
><P
>%B - saldo z prawdziwym znakiem, np. -107</P
></LI
><LI
><P
>%pin - numer PIN klienta</P
></LI
><LI
><P
>%cid - ID klienta</P
></LI
><LI
><P
>%number - numer dokumentu (tylko w powiadomieniu o fakturze lub nocie obciÄĹźeniowej)</P
></LI
><LI
><P
>%value - wartoĹÄ brutto na fakturze (tylko w powiadomieniu o fakturze)</P
></LI
><LI
><P
>%last_10_in_a_table - wyciÄg ostatnich 10 operacji kasowych na koncie klienta (tylko wiadomoĹci e-mail), np.:</P
></LI
></UL
><DIV
CLASS="EXAMPLE"
><A
NAME="NOTIFY-EXAMPLE"
></A
><P
><B
>Przyk&#322;ad 4-1. Lms-notify: PrzykĹadowy wyciÄg 10 ostatnich operacji kasowych</B
></P
><PRE
CLASS="SCREEN"
>-----------+------------------------------------------------------+---------
2003-02-02 | Abonament za miesiÄc 2003/02                         |  107.00
2003-02-01 | WpĹata                                               | -107.00
2003-02-01 | Abonament za miesiÄc 2003/02                         |  107.00
2003-02-01 | WpĹata                                               | -321.00
2003-01-31 | Abonament za miesiÄc 2003/01                         |  107.00
2003-01-31 | Abonament za miesiÄc 2003/01                         |  107.00
2003-01-31 | Abonament za miesiÄc 2003/01                         |  107.00
-----------+------------------------------------------------------+---------</PRE
></DIV
><DIV
CLASS="EXAMPLE"
><A
NAME="NOTIFY-TEMPLATE"
></A
><P
><B
>Przyk&#322;ad 4-2. Lms-notify: PrzykĹad szablonu</B
></P
><PRE
CLASS="SCREEN"
>UWAGA! Ta wiadomoĹÄ zostaĹa wygenerowana automatycznie.

Uprzejmie informujemy iĹź na Pani/Pana koncie figuruje zalegĹoĹÄ w opĹatach za
internet w wysokoĹci %B zĹ.

JeĹźeli porozumieli siÄ juĹź PaĹstwo z administratorami w kwestii opĹaty za
bieĹźÄcy miesiÄc czyli %date-m %date-y roku, prosimy o
zignorowanie tej wiadomoĹci.

W wypadku gdy uwaĹźajÄ PaĹstwo iĹź zalegĹoĹÄ ta jest nieporozumieniem prosimy o
jak najszybszy kontakt.

Wszelkie informacje na temat PaĹstwa rozliczeĹ mogÄ PaĹstwo znaleĹşÄ pod
adresem http://www.naszasiec.pl/mojekonto/

JeĹźeli chcieliby PaĹstwo uregulowaÄ zalegĹoĹci prosimy o kontakt:

DziaĹ RozliczeĹ ASK NaszaSiec

Gwidon MniejwaĹźny
telefon: 0-606666666
e-mail: gwidonm@naszasiec.pl

ps. zaĹÄczamy ostatnie 10 operacji jakie zostaĹo zarejestrowane przez nasz
system billingowy na PaĹstwa koncie:

Data       | Opis                                                 | WartoĹÄ
%last_10_in_a_table

--
Amatorska SieÄ Komputerowa NaszaSiec
http://www.naszasiec.pl/</PRE
></DIV
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="LMS-NOTIFY-CONFIG"
>4.3.1.2. Konfiguracja</A
></H3
><P
>KonfiguracjÄ dla lms-notify moĹźna ustaliÄ w pliku 
			<TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[notify]</I
></SPAN
>. 
			MoĹźesz tam ustawiÄ nastÄpujÄce parametry, ktĂłre majÄ zastosowanie
			rĂłwnieĹź dla skryptĂłw <A
HREF="scripts-config.html#LMS-NOTIFY-SMS"
>lms-notify-sms</A
> i <A
HREF="scripts-config.html#LMS-NOTIFY-MESSAGES"
>lms-notify-messages</A
>:</P
><UL
><LI
><P
>debtors_template (opcjonalny)</P
><P
>Lokalizacja pliku z szablonem wiadomoĹci wysyĹanej do 
				zadĹuĹźonych klientĂłw. Pozostawienie tej opcji pustej wyĹÄczy
				powiadomienia o zadĹuĹźeniu. DomyĹlnie: pusta</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>debtors_template = /etc/lms/debtors.txt</SAMP
></P
></LI
><LI
><P
>debtors_subject (opcjonalny)</P
><P
>Temat wiadomoĹci o zadĹuĹźeniu. DomyĹlnie: 'Debtors notification'</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>debtors_subject = 'Powiadomienie o zadĹuĹźeniu'</SAMP
></P
></LI
><LI
><P
>invoices_template (opcjonalny)</P
><P
>Lokalizacja pliku z szablonem wiadomoĹci z informacjÄ o 
				wystawieniu faktury. Pod uwagÄ brane sÄ faktury wystawione
				w ciÄgu ostatnich 24 godzin od uruchomienia skryptu.	
				Pozostawienie tej opcji pustej wyĹÄczy
				powiadomienia o nowych fakturach. DomyĹlnie: pusta</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>invoices_template = /etc/lms/new_invoice.txt</SAMP
></P
></LI
><LI
><P
>invoices_subject (opcjonalny)</P
><P
>Temat wiadomoĹci o nowej fakturze. DomyĹlnie: 'New invoice notification'</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>invoices_subject = 'Powiadomienie o wystawieniu faktury'</SAMP
></P
></LI
><LI
><P
>notes_template (opcjonalny)</P
><P
>Lokalizacja pliku z szablonem wiadomoĹci z informacjÄ o 
				wystawieniu noty obciÄĹźeniowej. Pod uwagÄ brane sÄ noty wystawione
				w ciÄgu ostatnich 24 godzin od uruchomienia skryptu.	
				Pozostawienie tej opcji pustej wyĹÄczy
				powiadomienia o nowych notach. DomyĹlnie: pusta</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>notes_template = /etc/lms/new_note.txt</SAMP
></P
></LI
><LI
><P
>notes_subject (opcjonalny)</P
><P
>Temat wiadomoĹci o nowej nocie obciÄĹźeniowej. DomyĹlnie: 'New debit note notification'</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>notes_subject = 'Powiadomienie o wystawieniu noty obciÄĹźeniowej'</SAMP
></P
></LI
><LI
><P
>deadline_template (opcjonalny)</P
><P
>Lokalizacja pliku z szablonem wiadomoĹci wysyĹanej do 
				zadĹuĹźonych klientĂłw, posiadajÄcych przeterminowane 
				(nierozliczone) faktury. Pozostawienie tej opcji pustej wyĹÄczy
				powiadomienia. DomyĹlnie: pusta</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>deadline_template = /etc/lms/deadline.txt</SAMP
></P
></LI
><LI
><P
>deadline_subject (opcjonalny)</P
><P
>Temat wiadomoĹci o przeterminowanych fakturach. DomyĹlnie: 'Invoice deadline notification'</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>deadline_subject = 'Powiadomienie o zalegĹoĹci'</SAMP
></P
></LI
><LI
><P
>limit (opcjonalny)</P
><P
>Pozwala na ustalenie limitu bilansu poniĹźej ktĂłrego do klienta 
				zostanie wysĹana wiadomoĹÄ z informacjÄ o zadĹuĹźeniu. DomyĹlnie: 0</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
></UL
><P
>PoniĹźej przedstawiono opcje dotyczÄce wyĹÄcznie wiadomoĹci e-mail.</P
><UL
><LI
><P
>mailfrom (wymagana)</P
><P
>Adres e-mail z ktĂłrego zostanie wysĹany e-mail. ProszÄ pamiÄtaÄ, Ĺźe na niektĂłrych MTA (np. exim) konto to musi istnieÄ w systemie. DomyĹlnie: pusta.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mailfrom = staff@domain.pl</SAMP
></P
></LI
><LI
><P
>mailfname</P
><P
>Nazwa nadawcy maila. DomyĹlnie: pusta.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mailfname = Administratorzy</SAMP
></P
></LI
><LI
><P
>smtp_host</P
><P
>Serwer SMTP, przez ktĂłry ma zostaÄ wysĹana wiadomoĹÄ. DomyĹlnie: localhost</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_host = smtp.mydomain.pl</SAMP
></P
></LI
><LI
><P
>smtp_auth</P
><P
>SposĂłb autoryzacji. Dozwolone wartoĹci: LOGIN, PLAIN, CRAM-MD5, NTLM.
				DomyĹlnie: pusta (brak autoryzacji)</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_auth = LOGIN</SAMP
></P
></LI
><LI
><P
>smtp_user</P
><P
>Login do autoryzacji SMTP. DomyĹlnie: pusty</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_user = admin</SAMP
></P
></LI
><LI
><P
>smtp_pass</P
><P
>HasĹo do konta zdefiniowanego w opcji smtp_user. DomyĹlnie: puste</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_pass = password</SAMP
></P
></LI
><LI
><P
>debug_email (opcjonalny)</P
><P
>Adres e-mail do debugowania. Gdy ustawiony, caĹa poczta 
				zostaje wysĹana na dany email zamiast do klientĂłw. Przydatne do 
				debugowania i sprawdzania czy wszystko dziaĹa OK. DomyĹlnie: 
				nie ustawiony.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>debug_email = lexx@domain.pl</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-NOTIFY-SMS"
>4.3.2. lms-notify-sms</A
></H2
><P
>lms-notify-sms to odpowiednik <A
HREF="scripts-config.html#LMS-NOTIFY"
>lms-notify</A
>,
		sĹuĹźÄcy do wysyĹania smsĂłw. Obecnie skrypt wspiera dwie usĹugi, smstools oraz gnokii.
		Wyboru usĹugi dokonuje siÄ w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[sms]</I
></SPAN
>. Skrypt jest 
		wielofunkcyjny, wĹÄczenie okreĹlonego zadania nastÄpuje poprzez
		zdefiniowanie lokalizacji pliku z szablonem wiadomoĹci.</P
><P
>KonfiguracjÄ dla lms-notify-sms moĹźna ustaliÄ w pliku 
		<TT
CLASS="FILENAME"
>lms.ini</TT
> 
		w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[notify-sms]</I
></SPAN
>, oprĂłcz opcji dostÄpnych w
		<A
HREF="scripts-config.html#LMS-NOTIFY"
>lms-notify</A
> masz do dyspozycji nastÄpujÄce opcje:
		<UL
><LI
><P
>service (opcjonalny)</P
><P
>Pozwala na wybranie usĹugi SMS niezaleĹźnie od tej,
			ktĂłrÄ podano w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[sms]</I
></SPAN
>. DomyĹlnie: pusta</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>service = smstools</SAMP
></P
></LI
></UL
>
		</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-NOTIFY-MESSAGES"
>4.3.3. lms-notify-messages</A
></H2
><P
>lms-notify-messages to odpowiednik <A
HREF="scripts-config.html#LMS-NOTIFY"
>lms-notify</A
>,
		sĹuĹźÄcy do ustawiania powiadomieĹ, ktĂłre bÄdÄ pojawiaÄ siÄ
		w przeglÄdarkach internetowych klientĂłw. Skrypt jest 
		wielofunkcyjny, wĹÄczenie okreĹlonego zadania nastÄpuje poprzez
		zdefiniowanie lokalizacji pliku z szablonem wiadomoĹci.</P
><P
>KonfiguracjÄ dla lms-notify-messages przeprowadza siÄ w pliku 
		<TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[notify-messages]</I
></SPAN
>.
		</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-CUTOFF"
>4.3.4. lms-cutoff</A
></H2
><P
>Skrypt pozwala na odĹÄczenie (a raczej zmianÄ w bazie danych stanu komputerĂłw na wyĹÄczony) klientĂłw ktĂłrych bilans jest poniĹźej zadanej wartoĹci. WĹaĹciwe odĹÄczanie powinno byÄ realizowane przez generator plikĂłw konfiguracyjnych.</P
><P
>KonfiguracjÄ dla lms-cutoff moĹźemy ustaliÄ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[cutoff]</I
></SPAN
>. MoĹźemy tam ustawiÄ nastÄpujÄce parametry:</P
><UL
><LI
><P
>limit (opcjonalny)</P
><P
>Pozwala na ustalenie limitu bilansu poniĹźej ktĂłrego do bazy danych zostanie zapisany stan odĹÄczony. DomyĹlnie: 0</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>message (optional)</P
><P
>JeĹli nie jest pusta, wiadomoĹÄ ta po doĹÄczeniu uĹźytkownika zostanie 
	   zapisana do jego rekordu w polu wiadomoĹci administracyjnej. W treĹci wiadomoĹci
	   moĹźna uĹźyÄ zmiennej %now, ktĂłra zostanie zamieniona na bieĹźÄcÄ datÄ oraz
	   zmiennych %b i %B tak jak w skrypcie lms-notify.
	   DomyĹlnie: 'Automatic cutoff caused by exceeding of liabilities limit on %now'</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>message = ''</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-PAYMENTS"
>4.3.5. lms-payments</A
></H2
><P
>Skrypt sĹuĹźÄcy do naliczania opĹat abonamentowych przypisanych
	 klientom oraz opĹat staĹych. Ponadto zapisuje dane do faktur.
	 Aby dziaĹaĹ poprawnie powinien byÄ uruchamiany codziennie.</P
><P
>Skrypt ten udostÄpnia trzy opcje do fakturowania, ktĂłre moĹźna ustawiÄ
	 w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[payments]</I
></SPAN
> pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>:
	  <UL
><LI
><P
>deadline (opcjonalny)</P
><P
>Pozwala na ustalenie terminu pĹatnoĹci w dniach. DomyĹlnie: 14</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>deadline = 7</SAMP
></P
></LI
><LI
><P
>paytype (opcjonalny)</P
><P
>OkreĹla rodzaj pĹatnoĹci. DomyĹlnie: 'TRANSFER'</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>paytype = 'PRZELEW'</SAMP
></P
></LI
><LI
><P
>comment (opcjonalny)</P
><P
>Opis pozycji na fakturze za naliczane zobowiÄzanie</P
><P
>DomyĹlnie: 'Tariff %tariff subscription for period %period'</P
><P
>NiektĂłre ze sĹĂłw kluczowych sÄ zastÄpowane:</P
><P
>%tariff - nazwa taryfy</P
><P
>%period - okres (liczony od dziĹ do ostatniego dnia cyklu rozliczeniowego, w formacie RRRR/MM/DD)</P
><P
>%current_month - okres od pierwszego dnia bieĹźÄcego miesiÄca do jego koĹca</P
><P
>%current_period - bieĹźÄcy miesiÄc w formacie MM/RRRR</P
><P
>%next_period - nastÄpny miesiÄc w formacie MM/RRRR</P
><P
>%desc - opis taryfy</P
><P
>PrzykĹad:       <SAMP
CLASS="PROMPT"
>comment = 'Abonament za %current_month w/g taryfy %tariff'</SAMP
></P
></LI
><LI
><P
>settlement_comment (opcjonalny)</P
><P
>Opis pozycji z tytuĹu wyrĂłwnania niepeĹnego okresu zobowiÄzania.</P
><P
>DomyĹlnie odpowiada opcji <SAMP
CLASS="PROMPT"
>comment</SAMP
></P
><P
>PrzykĹad:       <SAMP
CLASS="PROMPT"
>settlement_comment = 'WyrĂłwnanie za okres %period'</SAMP
></P
></LI
><LI
><P
>suspension_description (opcjonalny)</P
><P
>Tekst dodawany na koĹcu opisu operacji dla obciÄĹźeĹ zawieszonych. 
	   DomyĹlnie: ''</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>suspension_description = (zawieszenie)</SAMP
></P
></LI
></UL
>
	 </P
><P
>Ponadto mamy do dyspozycji jeden przydatny parametr wiersza poleceĹ
	 <SAMP
CLASS="PROMPT"
>--fakedate</SAMP
> (<SAMP
CLASS="PROMPT"
>-f</SAMP
>). Przy jego uĹźyciu moĹźna 
	 sprawiÄ, aby skrypt dziaĹaĹ z podmienionÄ datÄ systemowÄ (w formacie YYYY/MM/DD),
	 na przykĹad <SAMP
CLASS="PROMPT"
>--fakedate=2004/10/10</SAMP
>.
	 </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-TRAFFIC"
>4.3.6. lms-traffic</A
></H2
><P
>Skrypt sĹuĹźy do logowania informacji o iloĹci danych pobranych i wysĹanych
	przez kaĹźdy komputer w sieci lokalnej. W bazie danych zapisywana jest iloĹÄ
	danych w bajtach, numer komputera z bazy lms i znacznik czasu. 
	Od klienta zaleĹźy w jakich odstÄpach dane bÄdÄ odczytywane.
	PoniewaĹź dane odczytywane sÄ z pliku utworzonego przez klienta, nie ma
	znaczenia z jakiego ĹşrĂłdĹa pochodzÄ, moĹźe to byÄ iptables, ipchains lub
	program zewnÄtrzny np. ipfm.
    </P
><P
>PrzeglÄdanie wykresĂłw wykorzystania ĹÄcza oraz definiowanie filtrĂłw
	dostÄpne jest z gĹĂłwnego menu 'Statystyki'.
    </P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="LMS-TRAFFIC-CONFIG"
>4.3.6.1. Instalacja</A
></H3
><P
>Przed uruchomieniem lms-traffic naleĹźy zadbaÄ o utworzenie
	    pliku z danymi. ZawartoĹÄ pliku powinna mieÄ nastÄpujÄcy format:</P
><PRE
CLASS="SCREEN"
>&lt;adres IP&gt; &lt;n_spacji&gt; &lt;upload&gt; &lt;n_spacji&gt; &lt;download&gt;
&lt;adres IP&gt; &lt;n_spacji&gt; &lt;upload&gt; &lt;n_spacji&gt; &lt;download&gt;
...</PRE
><P
>Skrypt tworzÄcy statystyki naleĹźy uruchamiaÄ z takÄ samÄ czÄstotliwoĹciÄ 
	    co lms-traffic.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>PrzykĹad takiego skryptu dla iptables znajduje siÄ w 
	    pliku <TT
CLASS="FILENAME"
>/sample/traffic_ipt.pl</TT
>.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>NastÄpnie instalujemy skrypt dopisujÄc do crontaba.
	    OprĂłcz standardowych opcji wiersza poleceĹ moĹźliwe jest
	    zdefiniowanie lokalizacji pliku z logiem</P
><PRE
CLASS="SCREEN"
>-f=/plik 	poĹoĹźenie i nazwa pliku ze statystykami domyĹlnie /var/log/traffic.log</PRE
><P
>		<DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>CzÄstotliwoĹÄ zapisywania danych do bazy ustala uĹźytkownik.
		Ustawienie jej poniĹźej 10 minut, moĹźe spowodowaÄ szybki przyrost iloĹci rekordĂłw w
		bazie danych, a co za tym idzie zwiÄkszyÄ czas oczekiwania na wyĹwietlenie
		wynikĂłw.</P
></TD
></TR
></TABLE
></DIV
>
	    </P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-TRAFFIC-LOGIPTABLES"
>4.3.7. lms-traffic-logiptables</A
></H2
><P
>Skrypt sĹuĹźy do logowania informacji o iloĹci danych pobranych i wysĹanych
	przez kaĹźdy komputer z sieci lokalnej, na podstawie licznikĂłw iptables. Dane 
	sczytuje z firewalla, tworzÄc jednoczeĹnie odpowiednie reguĹy. Zatem, nie jest 
	konieczne rÄczne tworzenie reguĹ iptables, ani wywoĹywanie skryptu  
	<TT
CLASS="FILENAME"
>lms-traffic</TT
>.
	</P
><P
>KonfiguracjÄ naleĹźy umieĹciÄ w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[traffic-logiptables]</I
></SPAN
>:
	    <UL
><LI
><P
>outfile</P
><P
>Lokalizacja skryptu z reguĹami iptables. DomyĹlnie: /etc/rc.d/rc.stat</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>outfile = /etc/rc.d/rc.stat</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. DomyĹlnie: /usr/sbin/iptables</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>wan_interfaces</P
><P
>Nazwy interfejsĂłw, na ktĂłrych dane majÄ byÄ zliczane. DomyĹlnie: niezdefiniowane.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>wan_interfaces = eth0</SAMP
></P
></LI
><LI
><P
>local_ports</P
><P
>Lista portĂłw (ĹşrĂłdĹowych i docelowych) dla zliczanych pakietĂłw. DomyĹlnie: niezdefiniowane.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>local_ports = 80</SAMP
></P
></LI
><LI
><P
>script_owneruid</P
><P
>UID wĹaĹciciela skryptu okreĹlonego w 'outfile'. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_owneruid = 0</SAMP
></P
></LI
><LI
><P
>script_ownergid</P
><P
>GID wĹaĹciciela skryptu okreĹlonego w 'outfile'. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_ownergid = 0</SAMP
></P
></LI
><LI
><P
>script_permission</P
><P
>Uprawnienia skryptu okreĹlonego w 'outfile'. DomyĹlnie: 700 (rwx------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_permission = 700</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
></UL
>
	</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-MAKEDHCPCONF"
>4.3.8. lms-makedhcpconf</A
></H2
><P
>Tworzenie pliku konfiguracyjnego serwera DHCP - dhcpd.conf. KonfiguracjÄ
	skryptu umieszcza siÄ w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[dhcp]</I
></SPAN
>:
	    <UL
><LI
><P
>config_file</P
><P
>Lokalizacja pliku wynikowego. DomyĹlnie: /etc/dhcpd.conf</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_file = /tmp/dhcpd.conf</SAMP
></P
></LI
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>customergroups</P
><P
>Lista nazw grup (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony konfig dla wszystkich grup.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>customergroups = grupa1 grupa2</SAMP
></P
></LI
><LI
><P
>default_lease_time</P
><P
>DomyĹlny czas dzierĹźawy. DomyĹlnie: 86400.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>default_lease_time = 43200</SAMP
></P
></LI
><LI
><P
>max_lease_time</P
><P
>Maksymalny czas dzierĹźawy. DomyĹlnie: 86400.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>max_lease_time = 43200</SAMP
></P
></LI
><LI
><P
>ignore_ddns</P
><P
>Nie generuj wpisu 'ddns-update-style none;' na poczÄtku pliku.
		    Przydatne przy starszych (2.2) wersjach demona dhcpd. DomyĹlnie: wyĹÄczone.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>ignore_ddns = 1</SAMP
></P
></LI
><LI
><P
>log_facility</P
><P
>Ustawienie trybu logowania daemona dhcp. JeĹźeli puste to tryb domyĹlny.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>log_facility = 7</SAMP
></P
></LI
><LI
><P
>authoritative</P
><P
>Dodanie wpisu 'authoritative;' na poczÄtku pliku.
		    DomyĹlnie: wyĹÄczone.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>authoritative = 1</SAMP
></P
></LI
><LI
><P
>script_owneruid</P
><P
>UID wĹaĹciciela skryptu okreĹlonego w 'config_file'. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_owneruid = 0</SAMP
></P
></LI
><LI
><P
>script_ownergid</P
><P
>GID wĹaĹciciela skryptu okreĹlonego w 'config_file'. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_ownergid = 0</SAMP
></P
></LI
><LI
><P
>script_permission</P
><P
>Uprawnienia skryptu okreĹlonego w 'config_file'. DomyĹlnie: 600 (rwx------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_permission = 700</SAMP
></P
></LI
></UL
>
	</P
><P
>MoĹźesz podaÄ czasy dzierĹźawy dla konkretnych sieci poprzez stworzenie
	sekcji <SAMP
CLASS="PROMPT"
>[dhcp:nazwasieci]</SAMP
> np.:
<PRE
CLASS="SCREEN"
>[dhcp:public-custa] # nazwa sieci maĹymi literami!
default_lease_time = 3600
max_lease_time     = 3600</PRE
>

MoĹźesz podaÄ gateway, serwer dns, nazwÄ domeny i wins dla konkretnego
hosta poprzez stworzenie sekcji <SAMP
CLASS="PROMPT"
>[dhcp:adresip]</SAMP
> np.:
<PRE
CLASS="SCREEN"
>[dhcp:213.25.209.216]
domain  = anotherdomain.pl
gateway = 213.25.209.251
dns     = 213.25.209.8
wins    = 213.25.209.10</PRE
>
	</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-MAKEIPTABLES"
>4.3.9. lms-makeiptables, lms-makeipchains</A
></H2
><P
>Para skryptĂłw sĹuĹźÄcych do generowania plikĂłw zawierajÄcych
	    reguĹy firewalla. Do utworzonego pliku moĹźesz doĹÄczyÄ inne wczeĹniej
	    utworzone pliki, a w koĹcu nadaÄ mu odpowiednie uprawnienia. Skrypty nie
	    uruchamiajÄ wygenerowanych plikĂłw.</P
><P
>KonfiguracjÄ dla tych skryptĂłw moĹźesz ustaliÄ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[iptables]</I
></SPAN
>
	    (i odpowiednio <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[ipchains]</I
></SPAN
>). Oba skrypty posiadajÄ te same
	    opcje: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku firewalla. JeĹli nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>iptables_binary (ipchains_binary)</P
><P
>Lokalizacja programu iptables (ipchains). DomyĹlnie: /usr/sbin/iptables (/usr/sbin/ipchains)</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>script_file</P
><P
>Plik, do ktĂłrego zapisujemy reguĹy firewalla. DomyĹlnie: /etc/rc.d/rc.masq</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_file = /etc/rc.d/rc.firewall</SAMP
></P
></LI
><LI
><P
>pre_script</P
><P
>Plik wykonywany PO wyczyszczeniu reguĹek, ale PRZED ustawieniem nowych. 
		    DomyĹlnie: niezdefiniowany.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>pre_script = /etc/rc.d/rc.masq-pre</SAMP
></P
></LI
><LI
><P
>post_script</P
><P
>Plik wykonywany PO ustawieniu reguĹek. DomyĹlnie: niezdefiniowany.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>post_script = /etc/rc.d/rc.masq-post</SAMP
></P
></LI
><LI
><P
>forward_to</P
><P
>Lista sieci, dla ktĂłrych wĹÄczamy forwarding. MoĹźliwe wartoĹci: "" - peĹny forward, 
		    "dowolny ciÄg" - wyĹÄcz forward, "siec1 siec2" - lista sieci z wĹÄczonym forwardingiem.  
		    DomyĹlnie: peĹny forward.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>forward_to = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>script_owneruid</P
><P
>UID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_owneruid = 0</SAMP
></P
></LI
><LI
><P
>script_ownergid</P
><P
>GID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_ownergid = 0</SAMP
></P
></LI
><LI
><P
>script_permission</P
><P
>Uprawnienia pliku skryptu. DomyĹlnie: 700 (rwx------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>script_permission = 700</SAMP
></P
></LI
><LI
><P
>snat_address</P
><P
>Adres SNAT. JeĹli nie ustawiono, dla hostĂłw z adresami publicznymi bÄdzie
		    uĹźyte "-j MASQUERADE". JeĹli ustawiono zostanie uĹźyte "-j SNAT --to xxx.xxx.xxx.xxx".
		    Dotyczy lms-makeiptables. DomyĹlnie: nie ustawiony.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>snat_address = 123.123.123.123</SAMP
></P
></LI
><LI
><P
>tcp_redirect_ports (udp_redirect_ports)</P
><P
>Konfiguracja przekierowaĹ w formie port_ĹşrĂłdĹowy:port_docelowy dla
		    przekierowaĹ na lokalnÄ maszynÄ dla poĹÄczeĹ wychodzÄcych. Dotyczy lms-makeipchains.
		    DomyĹlnie: nie ustawione.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>tcp_redirect_ports = 80:3128 25:25</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-ETHERDESC"
>4.3.10. lms-etherdesc</A
></H2
><P
>Skrypt sĹuĹźÄcy do generowania pliku zawierajÄcego MAC adresy oraz
	    nazwy hostĂłw pobierane z bazy lms'a. Adresy zapisywane sÄ w formacie 'stripped mac',
	    czyli bez ":". Tego typu plik wykorzystywany jest przez pakiet <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>iptraf</I
></SPAN
>.
	    </P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[ether]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>etherdesc_owneruid</P
><P
>UID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>etherdesc_owneruid = 0</SAMP
></P
></LI
><LI
><P
>etherdesc_file</P
><P
>Lokalizacja pliku. DomyĹlnie: /var/lib/iptraf/ethernet.desc.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>etherdesc_file = /etc/ethernet.desc</SAMP
></P
></LI
><LI
><P
>etherdesc_ownergid</P
><P
>GID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>etherdesc_ownergid = 0</SAMP
></P
></LI
><LI
><P
>etherdesc_permission</P
><P
>Uprawnienia pliku skryptu. DomyĹlnie: 600 (rw-------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>etherdesc_permission = 600</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-SENDINVOICES"
>4.3.11. lms-sendinvoices</A
></H2
><P
>Skrypt sĹuĹźy do wysyĹania pocztÄ elektronicznÄ faktur, jako zaĹÄcznikĂłw
	do wiadomoĹci. Faktury generowane sÄ na podstawie szablonu dostÄpnego w lms-ui,
	dlatego wymagane jest podanie klienta i hasĹa do interfejsu www lms-ui.</P
><P
>W odrĂłĹźnieniu od pozostaĹych skryptĂłw ten wymaga dodatkowych moduĹĂłw perla:
	LWP::UserAgent, MIME::QuotedPrint oraz Mail::Sender.</P
><P
>KonfiguracjÄ naleĹźy umieĹciÄ w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[sendinvoices]</I
></SPAN
>:
	    <UL
><LI
><P
>lms_url</P
><P
>Adres do lms-ui. DomyĹlnie: http://localhost/lms/</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>lms_url = http://lms.mynet.pl</SAMP
></P
></LI
><LI
><P
>lms_user</P
><P
>Login uĹźytkownika. DomyĹlnie: pusty</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>lms_user = admin</SAMP
></P
></LI
><LI
><P
>lms_password</P
><P
>HasĹo do lms-ui. DomyĹlnie: puste</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>lms_password = moje_hasĹo</SAMP
></P
></LI
><LI
><P
>debug_email</P
><P
>Konto pocztowe do testĂłw. DomyĹlnie: niezdefiniowane.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>debug_email = admin@mynet.pl</SAMP
></P
></LI
><LI
><P
>sender_name</P
><P
>Nadawca listu. DomyĹlnie: niezdefiniowany.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>sender_name = ASK MyNet</SAMP
></P
></LI
><LI
><P
>sender_email</P
><P
>Adres nadawcy listu. DomyĹlnie: niezdefiniowany.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>sender_email = admin@mynet.pl</SAMP
></P
></LI
><LI
><P
>mail_subject</P
><P
>Temat wiadomoĹci. MoĹźna uĹźyÄ zmiennej %invoice zastÄpowanej numerem faktury. 
		    DomyĹlnie: 'Invoice No. %invoice'.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mail_subject = 'Nowa faktura'</SAMP
></P
></LI
><LI
><P
>mail_body</P
><P
>TreĹÄ wiadomoĹci. MoĹźna uĹźyÄ zmiennej %invoice, ktĂłra zostanie zastÄpiona numerem faktury. 
		    DomyĹlnie: 'Attached file with Invoice No. %invoice'.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mail_body = ''</SAMP
></P
></LI
><LI
><P
>customergroups</P
><P
>Lista nazw grup (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione 
		podczas wysyĹki. DomyĹlnie: nie ustawiona - wszystkie grupy.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>customergroups = grupa1 grupa2</SAMP
></P
></LI
><LI
><P
>smtp_host</P
><P
>Serwer SMTP, przez ktĂłry ma zostaÄ wysĹana wiadomoĹÄ. DomyĹlnie: localhost</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_host = smtp.mydomain.pl</SAMP
></P
></LI
><LI
><P
>smtp_auth</P
><P
>SposĂłb autoryzacji. Dozwolone wartoĹci: LOGIN, PLAIN, CRAM-MD5, NTLM. DomyĹlnie: pusta (brak autoryzacji)</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_auth = LOGIN</SAMP
></P
></LI
><LI
><P
>smtp_user</P
><P
>Login do autoryzacji SMTP. DomyĹlnie: pusty</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_user = admin</SAMP
></P
></LI
><LI
><P
>smtp_pass</P
><P
>HasĹo do konta zdefiniowanego w opcji smtp_user. DomyĹlnie: puste</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_pass = password</SAMP
></P
></LI
></UL
>
	 Ponadto mamy do dyspozycji jeden przydatny parametr wiersza poleceĹ
	 <SAMP
CLASS="PROMPT"
>--fakedate</SAMP
> (<SAMP
CLASS="PROMPT"
>-f</SAMP
>). Przy jego uĹźyciu moĹźna 
	 sprawiÄ, aby skrypt dziaĹaĹ z podmienionÄ datÄ systemowÄ (w formacie YYYY/MM/DD),
	 na przykĹad <SAMP
CLASS="PROMPT"
>--fakedate=2004/10/10</SAMP
>.
	 </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-MAKEMACS"
>4.3.12. lms-makemacs</A
></H2
><P
>Skrypt sĹuĹźÄcy do generowania pliku zawierajÄcego reguĹy netfiltra filtrujÄce ruch
	    klientĂłw na bazie testu adresu ĹşrĂłdĹowego MAC. Dla kaĹźdego komputera generowana jest
	    jedna reguĹa dla tablicy nat, zadanego ĹaĹcucha, testujÄca adres ĹşrĂłdĹowy IP pakietu oraz adres
	    ĹşrĂłdĹowy MAC ramki. JeĹli testy zakoĹczÄ siÄ pozytywnie nastÄpuje powrĂłt do ĹaĹcucha nadrzÄdnego
	    za pomocÄ decyzji RETURN. Na koĹcu listy reguĹ dodawane sÄ 2 reguĹy przekierowujÄce ruch http
	    oraz webcache na podany w konfiguracji adres IP oraz port (z wykorzystaniem decyzji DNAT).
	    Przekierowanie moĹźe odbywaÄ siÄ na wirtualny host www z zawiadomieniem klienta
	    o zalegĹoĹciach finansowych bez moĹźliwoĹci wyĹÄczenia zawiadomienia. Na koĹcu dodawana jest 
	    reguĹa blokujÄca jakikolwiek inny ruch.
	    </P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[macs]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>customergroups </P
><P
>Lista nazw grup klientĂłw (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup klientĂłw.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>customergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. DomyĹlnie: /sbin/iptables</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. DomyĹlnie: /etc/rc.d/rc.macs.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/conf.d/rc.macs</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. DomyĹlnie: 700 (rwx------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_permission = 700</SAMP
></P
></LI
><LI
><P
>chain</P
><P
>ĹaĹcuch do ktĂłrego bÄdÄ dodawane generowane reguĹy. DomyĹlnie: MACS.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>chain = TESTY_MACOW</SAMP
></P
></LI
><LI
><P
>redirect_address</P
><P
>Adres IP + port na ktĂłry bÄdzie przekierowywany niesklasyfikowany ruch http i webcache. DomyĹlnie: 127.0.0.1:80.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>redirect_address = 192.168.1.1:3000</SAMP
></P
></LI
><LI
><P
>lock_noaccess</P
><P
>Czy generowaÄ reguĹki testujÄce z decyzjÄ RETURN dla komputerĂłw, ktĂłre sÄ odĹÄczone. DomyĹlnie: 0 (reguĹy sÄ generowane)</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>lock_noaccess = 1</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-MAKEHOSTS"
>4.3.13. lms-makehosts</A
></H2
><P
>Skrypt sĹuĹźÄcy do generowania pliku /etc/hosts zawierajÄcego odwzorowania nazw komputerĂłw
	    na adresy IP.
	    </P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[hosts]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>customergroups </P
><P
>Lista nazw grup klientĂłw (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup klientĂłw.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>customergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. DomyĹlnie: /etc/hosts.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/hosts</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. DomyĹlnie: 644 (rw-r--r--).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_permission = 600</SAMP
></P
></LI
><LI
><P
>config_header</P
><P
>Pierwsza linia w pliku /etc/hosts. DomyĹlnie: 127.0.0.1 localhost localhost.localdomain.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_header = 192.168.1.1 serwer serwer.nasza-siec</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-MAKEWARNINGS"
>4.3.14. lms-makewarnings</A
></H2
><P
>Skrypt sĹuĹźÄcy do generowania pliku zawierajÄcego reguĹy netfiltra przekierowujÄce ruch http i webcache
	    klientĂłw o saldzie mniejszym lub rĂłwnym od zadanego na zadany adres IP i port (wykorzystywana
	    jest tablica nat, testy adresĂłw ĹşrĂłdĹowych IP oraz decyzja DNAT).
	    </P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[warnings]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>customergroups </P
><P
>Lista nazw grup klientĂłw (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup klientĂłw.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>customergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. DomyĹlnie: /sbin/iptables</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. DomyĹlnie: /etc/rc.d/rc.warnings.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/conf.d/rc.warnings</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. DomyĹlnie: 700 (rwx------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_permission = 700</SAMP
></P
></LI
><LI
><P
>chain</P
><P
>ĹaĹcuch do ktĂłrego bÄdÄ dodawane generowane reguĹy. DomyĹlnie: WARNINGS.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>chain = OSTRZEZENIA</SAMP
></P
></LI
><LI
><P
>redirect_address</P
><P
>Adres IP + port na ktĂłry bÄdzie przekierowywany ruch http i webcache pochodzÄcy z hostĂłw dla ktĂłrych ma byÄ wĹÄczone ostrzeĹźenie o zalegĹoĹciach finansowych. DomyĹlnie: 127.0.0.1:80.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>redirect_address = 192.168.1.1:3001</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Saldo klienta przy ktĂłrym dla wszystkich komputerĂłw klienta generowane sÄ reguĹki przekierowujÄce ruch. DomyĹlnie: 0 </P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>limit = -85</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-MAKEMESSAGES"
>4.3.15. lms-makemessages</A
></H2
><P
>Skrypt sĹuĹźÄcy do generowania pliku zawierajÄcego reguĹy netfiltra przekierowujÄce ruch http i webcache
	    klientĂłw dla ktĂłrych zostaĹo wĹÄczone przekazywanie wiadomoĹci administracyjnej (ostrzeĹźenia) na zadany adres IP i port (wykorzystywana
	    jest tablica nat, testy adresĂłw ĹşrĂłdĹowych IP oraz decyzja DNAT).
	    </P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[messages]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>customergroups </P
><P
>Lista nazw grup klientĂłw (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas generowania
		    pliku. JeĹli nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup klientĂłw.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>customergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. DomyĹlnie: /sbin/iptables</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. DomyĹlnie: /etc/rc.d/rc.messages.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/conf.d/rc.messages</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID wĹaĹciciela pliku. DomyĹlnie: 0 (root).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. DomyĹlnie: 700 (rwx------).</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>config_permission = 700</SAMP
></P
></LI
><LI
><P
>chain</P
><P
>ĹaĹcuch do ktĂłrego bÄdÄ dodawane generowane reguĹy. DomyĹlnie: MESSAGES.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>chain = WIADOMOSCI</SAMP
></P
></LI
><LI
><P
>redirect_address</P
><P
>Adres IP + port na ktĂłry bÄdzie przekierowywany ruch http i webcache pochodzÄcy z hostĂłw dla ktĂłrych ma byÄ wĹÄczona wiadomoĹÄ administracyjna. DomyĹlnie: 127.0.0.1:80.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>redirect_address = 192.168.1.1:3002</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-FPING"
>4.3.16. lms-fping</A
></H2
><P
>Skrypt zapisuje do bazy informacje o aktywnoĹci komputerĂłw. 
	    Do skanowania wykorzystywany jest szybki program fping (z opcjami -ar1). 
	    Najpierw tworzona jest lista hostĂłw, a nastÄpnie, po wywoĹaniu fping'a, 
	    komputerom wĹÄczonym zostaje przypisana data i czas skanowania. DziÄki temu 
	    mamy w bazie informacje kiedy dany komputer byĹ ostatnio wĹÄczony.</P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[fping]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), ktĂłre majÄ byÄ uwzglÄdnione podczas skanowania.
		    JeĹli nie ustawiono przeskanowane zostanÄ wszystkie komputery.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>fping_binary</P
><P
>Lokalizacja programu fping. DomyĹlnie: /usr/sbin/fping</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>fping_binary = /usr/local/sbin/fping</SAMP
></P
></LI
><LI
><P
>temp_file</P
><P
>Lokalizacja pliku tymczasowego na listÄ hostĂłw, ktĂłry
		    po wykonaniu skryptu zostaje usuniÄty. DomyĹlnie: /tmp/fping_hosts.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>temp_file = /tmp/hosts</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-REMINDER"
>4.3.17. lms-reminder</A
></H2
><P
>Skrypt sĹuĹźy do przypominania klientom o zaplanowanych na dany dzieĹ 
	  zadaniach. Lista zdarzeĹ przypisanych w Terminarzu danemu klientowi w bieĹźÄcym
	  dniu zostaje wysĹana na jego adres e-mail.</P
><P
>KonfiguracjÄ dla lms-reminder umieszcza siÄ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> 
	  w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[reminder]</I
></SPAN
>. MoĹźesz tam ustawiÄ nastÄpujÄce parametry:</P
><UL
><LI
><P
>mailsubject (wymagany)</P
><P
>Pozwala na ustalenie tematu e-maila wysyĹanego do klienta. DomyĹlnie: nie ustawione.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mailsubject = 'Terminarz z LMSa'</SAMP
></P
></LI
><LI
><P
>mailfrom (wymagany)</P
><P
>Adres e-mail z ktĂłrego zostanie wysĹany e-mail. ProszÄ pamiÄtaÄ, Ĺźe na 
	    	    niektĂłrych MTA (np. exim) konto to musi istnieÄ w systemie. 
	    	    DomyĹlnie nieustawione.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mailfrom = staff@domain.pl</SAMP
></P
></LI
><LI
><P
>mailfname (wymagany)</P
><P
>Nazwa nadawcy maila.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mailfname = LMS</SAMP
></P
></LI
><LI
><P
>smtp_host</P
><P
>Serwer SMTP, przez ktĂłry ma zostaÄ wysĹana wiadomoĹÄ. DomyĹlnie: localhost</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_host = smtp.mydomain.pl</SAMP
></P
></LI
><LI
><P
>smtp_auth</P
><P
>SposĂłb autoryzacji. Dozwolone wartoĹci: LOGIN, PLAIN, CRAM-MD5, NTLM.
		    DomyĹlnie: pusta (brak autoryzacji)</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_auth = LOGIN</SAMP
></P
></LI
><LI
><P
>smtp_user</P
><P
>Login do autoryzacji SMTP. DomyĹlnie: pusty</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_user = admin</SAMP
></P
></LI
><LI
><P
>smtp_pass</P
><P
>HasĹo do konta zdefiniowanego w opcji smtp_user. DomyĹlnie: puste</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_pass = password</SAMP
></P
></LI
><LI
><P
>debug_email (opcjonalny)</P
><P
>Adres e-mail do debugowania. Gdy ustawiony, caĹa poczta zostaje 
	    	    wysĹana na dany email zamiast do klientĂłw. Przydatne do debugowania 
	    	    i sprawdzania czy wszystko dziaĹa OK. DomyĹlnie: nie ustawiony.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>debug_email = alec@domain.pl</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="LMS-RTPARSER"
>4.3.18. lms-rtparser</A
></H2
><P
>Jest to tzw. backend dla systemu Helpdesk, czyli skrypt ktĂłry wspĂłĹpracujÄc
	    z serwerem pocztowym zapisuje do bazy danych wszystkie wiadomoĹci skierowane na
	    adresy Helpdesk'a. Skrypt pobiera z wejĹcia wiadomoĹÄ pocztowÄ, parsuje zawartoĹÄ
	    i umieszcza zgĹoszenie w kolejce, wysyĹajÄc do zgĹaszajÄcych
	    potwierdzenie przyjÄcia wiadomoĹci. W temacie potwierdzenia znajduje siÄ symbol
	    zgĹoszenia. Podczas parsowania wiadomoĹci nastÄpuje, na 
	    podstawie tematu wiadomoĹci, prĂłba rozpoznania czy wiadomoĹÄ nie jest odpowiedziÄ na innÄ wiadomoĹÄ z juĹź
	    przypisanym numerem zgĹoszenia. Od wiadomoĹci zostajÄ odĹÄczone zaĹÄczniki
	    i umieszczone w katalogu zdefiniowanym w opcji <TT
CLASS="FILENAME"
>mail_dir</TT
>.</P
><P
>OprĂłcz moduĹĂłw Perla standardowo wymaganych przez resztÄ skryptĂłw, naleĹźy 
	    zainstalowaÄ takĹźe moduĹy <TT
CLASS="FILENAME"
>MIME::Parser</TT
> i <TT
CLASS="FILENAME"
>MIME::Words</TT
> z 
	    pakietu MIME-Tools oraz <TT
CLASS="FILENAME"
>Mail::Sender</TT
> i <TT
CLASS="FILENAME"
>Text::Iconv</TT
>.</P
><P
>Skrypt moĹźna uruchamiaÄ na wiele sposobĂłw. Jednym z nich jest
	    stworzenie skryptu powĹoki, ktĂłry odczytujÄc skrzynkÄ pocztowÄ wywoĹa lms-rtparser
	    dla kaĹźdego maila. Wygodniejszym zastosowaniem jest jednak zintegrowanie
	    go z serwerem pocztowym. PoniĹźej przedstawiono sposĂłb podĹÄczenia go do
	    postfixa przy uĹźyciu opcji header_checks.
<PRE
CLASS="SCREEN"
># plik main.cf:
header_checks = regexp:/etc/postfix/header_checks

# plik header_checks
/^To:.*adres@domena.*/ FILTER filter:dummy

# plik master.cf:
filter unix - n n - 10 pipe
      -flags=Rq user=nobody argv=/path/to/lms-rtparser</PRE
>
	    PowyĹźszy sposĂłb dziaĹa dla postfixa w wersjach nowszych od 2.0.
	    WczeĹniejsze wersje nie obsĹugujÄ FILTER w header_checks. Z tym
	    problemem moĹźna sobie poradziÄ uĹźywajÄc procmaila:
<PRE
CLASS="SCREEN"
># plik main.cf
mailbox_command = /usr/bin/procmail

# w katalogu domowym klienta, ktĂłrego maile majÄ byÄ obsĹugiwane przez HelpDesk:
# plik .forward
"|IFS=' ' &#38;&#38; exec /usr/bin/procmail -f - || exit 75 #YOUR_USERNAME"

# plik .procmailrc
:0 c
   * ^To.*adres@domena
   | /bin/lms-rtparser

:0 A
$DEFAULT</PRE
></P
><P
>Kolejny listing to przykĹad podĹÄczenia parsera do Exima 
	    przy uĹźyciu filtrĂłw systemowych:
<PRE
CLASS="SCREEN"
># plik exim.conf

system_filter_pipe_transport = address_pipe

# plik system_filter.txt

if $recipients is "adres_kolejki@domena.pl"
then 
     pipe "/sciezka/do/lms-rtparser -q id_kolejki"
endif</PRE
></P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>JeĹźeli chcesz aby wiadomoĹci wprowadzane poprzez <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>lms-ui</I
></SPAN
>
	    byĹy kierowane do parsera, zamiast bezpoĹrednio zapisywane do bazy, powinieneĹ wĹÄczyÄ
	    opcjÄ konfiguracyjnÄ <TT
CLASS="FILENAME"
>helpdesk_backend_mode</TT
> w sekcji
	    <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[phpui]</I
></SPAN
>.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>KonfiguracjÄ tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[rt]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>default_queue</P
><P
>Numer ID kolejki, do ktĂłrej trafiÄ zgĹoszenia. JeĹli nie
		    podano, Kolejka zostanie odszukana na podstawie adresu odbiorcy maila.
		    Opcja ta moĹźe zostaÄ nadpisana przy pomocy parametru -q przy
		    uruchomieniu skryptu. DomyĹlnie: niezdefiniowana.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>default_queue = </SAMP
></P
></LI
><LI
><P
>mail_from</P
><P
>Nadawca potwierdzenia (adres). JeĹli nie zdefiniowano, zostanie uĹźyty adres
		    kolejki do ktĂłrej zapisano zgĹoszenie. DomyĹlnie: pusty.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mail_from = rt@net.pl</SAMP
></P
></LI
><LI
><P
>mail_from_name</P
><P
>Nadawca potwierdzenia (nazwa). DomyĹlnie: niezdefiniowana.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mail_from_name = 'BOK SuperLAN'</SAMP
></P
></LI
><LI
><P
>autoreply_subject</P
><P
>Temat potwierdzenia. Tu moĹźna korzystaÄ ze zmiennych %tid - 
		    identyfikator zgĹoszenia i %subject - temat zgĹoszenia.
		    DomyĹlnie: "[RT#%tid] Receipt of request '%subject'".</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>autoreply_subject = "[RT#%tid] Potwierdzenie odbioru zgĹoszenia o temacie '%subject'"</SAMP
></P
></LI
><LI
><P
>autoreply_body</P
><P
>TreĹÄ potwierdzenia. Tu moĹźna korzystaÄ ze zmiennych: %tid - 
		    identyfikator zgĹoszenia i %subject - temat zgĹoszenia.
		    DomyĹlnie: "Your request was registered in our system.\nTo this request was assigned ticket identifier RT#%tid.\nPlease, place string [RT#%tid] in subject field of any\nmail relating to this request.\n."</P
><P
>Example:	<SAMP
CLASS="PROMPT"
>autoreply_body = "PaĹstwa zgĹoszenie zostaĹo zarejestrowane w naszym systemie.\nZgĹoszeniu zostaĹ nadany numer: RT#%tid.\nW korespondencji zwiÄzanej z tym zgĹoszeniem prosimy podawaÄ w temacie ciÄg znakĂłw [RT#%tid].\n"</SAMP
></P
></LI
><LI
><P
>smtp_host</P
><P
>Serwer SMTP, przez ktĂłry ma zostaÄ wysĹana wiadomoĹÄ. DomyĹlnie: localhost</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_host = smtp.mydomain.pl</SAMP
></P
></LI
><LI
><P
>smtp_auth</P
><P
>SposĂłb autoryzacji. Dozwolone wartoĹci: LOGIN, PLAIN, CRAM-MD5, NTLM.
		    DomyĹlnie: pusta (brak autoryzacji)</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_auth = LOGIN</SAMP
></P
></LI
><LI
><P
>smtp_user</P
><P
>Login do autoryzacji SMTP. DomyĹlnie: pusty</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_user = admin</SAMP
></P
></LI
><LI
><P
>smtp_pass</P
><P
>HasĹo do konta zdefiniowanego w opcji smtp_user. DomyĹlnie: puste</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>smtp_pass = password</SAMP
></P
></LI
><LI
><P
>mail_dir</P
><P
>Katalog w ktĂłrym zostanÄ zapisane zaĹÄczniki. Katalog ten powinien byÄ
		    dostÄpny dla apache'a i klienta uruchamiajÄcego lms-rtparser. Gdy nie ustawiono, 
		    zaĹÄczniki zostanÄ utracone. DomyĹlnie: niezdefiniowany.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>mail_dir = /usr/local/lms/mail</SAMP
></P
></LI
><LI
><P
>tmp_dir</P
><P
>Katalog tymczasowy. DomyĹlnie zostanie uĹźyty katalog 
		    zdefiniowany w zmiennej systemowej lub <TT
CLASS="FILENAME"
>/tmp</TT
>.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>tmp_dir = /home/user/tmp</SAMP
></P
></LI
><LI
><P
>auto_open</P
><P
>WĹÄczenie tej opcji spowoduje, Ĺźe w momencie odebrania
		    wiadomoĹci dotyczÄcej zgĹoszenia zamkniÄtego (lub martwego)
		    zgĹoszenie to zostanie otwarte. DomyĹlnie: wyĹÄczone.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>auto_open = 1</SAMP
></P
></LI
><LI
><P
>newticket_notify</P
><P
>WĹÄczenie tej opcji spowoduje wysyĹanie powiadomieĹ o
		    nowych zgĹoszeniach do uĹźytkownikĂłw ktĂłrzy majÄ prawa do
		    konkretnej kolejki. DomyĹlnie: wyĹÄczone.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>newticket_notify = 1</SAMP
></P
></LI
><LI
><P
>lms_url</P
><P
>Do powiadomienia o nowym zgĹoszeniu zostaje zaĹÄczony link 
		    do tego zgĹoszenia w LMS-UI, aby uĹźytkownik mĂłgĹ szybko przejĹÄ do
		    tego zgĹoszenia. DomyĹlnie: http://localhost/lms/.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>lms_url = https://lms.domena.pl/</SAMP
></P
></LI
><LI
><P
>include_customerinfo</P
><P
>Do powiadomienia o nowym zgĹoszeniu zostajÄ zaĹÄczone podstawowe 
			dane klienta, jeĹźeli zostaĹ on rozpoznany po adresie mailowym. 
			DomyĹlnie: wĹÄczona.</P
><P
>PrzykĹad:	<SAMP
CLASS="PROMPT"
>include_customerinfo = 0</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="scripts-list.html"
ACCESSKEY="P"
>Poprzedni</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Spis tre&#347;ci</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="mgc.html"
ACCESSKEY="N"
>Nast&#281;pny</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Lista dostÄpnych skryptĂłw</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="scripts.html"
ACCESSKEY="U"
>Pocz&#261;tek rozdzia&#322;u</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Generator plikĂłw konfiguracyjnych (lms-mgc)</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
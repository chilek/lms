<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Modu³y</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="LMS - LAN Management System 1.7-cvs"
HREF="index.html"><LINK
REL="UP"
TITLE="LMS Daemon"
HREF="daemon.html"><LINK
REL="PREVIOUS"
TITLE="LMS Daemon"
HREF="daemon.html"><LINK
REL="NEXT"
TITLE="T-Script"
HREF="tscript.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="../images/style.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=ISO-8859-2"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#EBE4D6"
TEXT="#000000"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>LMS - LAN Management System 1.7-cvs</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="daemon.html"
ACCESSKEY="P"
>Poprzedni</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Rozdzia&#322; 6. LMS Daemon</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="tscript.html"
ACCESSKEY="N"
>Nast&#281;pny</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="DAEMON-MODULES"
>6.2. Modu³y</A
></H1
><P
>Sam demon potrafi tylko uruchamiaæ modu³y i to one odwalaj± ca³± robotê. 
	Wiêkszo¶æ modu³ów jest przeznaczona do okre¶lonego zastosowania, jedynie 'hostfile' 
	mo¿na u¿ywaæ do ró¿nych konfigów (us³ug), np. ró¿nych typów firewalli.
	Parametry konfiguracyjne modu³ów umieszcza siê w sekcjach instancji je wywo³uj±cych.</P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-MODULESLIST"
>6.2.1. Lista dostêpnych modu³ów</A
></H2
><DIV
CLASS="TABLE"
><A
NAME="MODULES-LIST"
></A
><P
><B
>Tabela 6-1. Lista modu³ów demona lmsd</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="200"
ALIGN="CENTER"><COL
WIDTH="300"
ALIGN="CENTER"><THEAD
><TR
><TH
>Nazwa</TH
><TH
>Opis</TH
></TR
></THEAD
><TBODY
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-SYSTEM"
>system</A
></TD
><TD
>Wywo³ywanie poleceñ pow³oki</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-PARSER"
>parser</A
></TD
><TD
>Parser uniwersalnych skryptów T-Script</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-DHCP"
>dhcp</A
></TD
><TD
>Konfiguracja serwera dhcpd</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-CUTOFF"
>cutoff</A
></TD
><TD
>Od³±czanie klientów z zaleg³o¶ciami w op³atach</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-DNS"
>dns</A
></TD
><TD
>Konfiguracja serwera dns</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-ETHERS"
>ethers</A
></TD
><TD
>Tworzenie pliku /etc/ethers</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-HOSTFILE"
>hostfile</A
></TD
><TD
>Modu³ uniwersalny (np. tworzenie regu³ iptables)</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-NOTIFY"
>notify</A
></TD
><TD
>Powiadamianie klientów o zaleg³o¶ciach w op³atach poczt± elektroniczn±</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-GGNOTIFY"
>ggnotify</A
></TD
><TD
>Powiadamianie klientów o zaleg³o¶ciach w op³atach przez gadu-gadu</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-PAYMENTS"
>payments</A
></TD
><TD
>Naliczanie op³at abonamentowych</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-OIDENT"
>oident</A
></TD
><TD
>Konfiguracja oident</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-TC"
>tc</A
></TD
><TD
>Tworzenie regu³ HTB</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-TRAFFIC"
>traffic</A
></TD
><TD
>Statystyki wykorzystania ³±cza</TD
></TR
><TR
><TD
><A
HREF="daemon-modules.html#DAEMON-PINGER"
>pinger</A
></TD
><TD
>Badanie aktywno¶ci klientów</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-SYSTEM"
>6.2.2. System</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="SYSTEM-DESC"
>6.2.2.1. Opis</A
></H3
><P
>Jedyne co robi ten modu³ to wykonanie zadanego polecenia (listy poleceñ)
		    pow³oki i/lub komendy SQL. Mo¿e siê przydaæ gdy chcesz podczas prze³adowania konfiguracji 
		    wykonaæ jak±¶ komendê lub uruchomiæ zewnêtrzny skrypt, na przyk³ad jeden 
		    z tych, które mo¿esz znale¼æ w katalogu <TT
CLASS="FILENAME"
>/bin</TT
>.
		    W pierwszej kolejno¶ci jest wykonywane polecenie SQL.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="SYSTEM-CONFIG"
>6.2.2.2. Konfiguracja</A
></H3
><P
>W zwi±zku z powy¿szym mo¿esz zdefiniowaæ jedynie tre¶æ polecenia SQL lub
		    shella. Pow³oka powinna sobie tak¿e poradziæ z list± poleceñ oddzielonych 
		    ¶rednikami:</P
><UL
><LI
><P
>sql</P
><P
>Polecenie SQL. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>sql = 'DELETE FROM stats WHERE dt &#60; %NOW% - 365*86400'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'echo -n "tu modu³ "; echo "system"'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-PAYMENTS"
>6.2.3. Payments</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="PAYMENTS-DESC"
>6.2.3.1. Opis</A
></H3
><P
>Modu³ nalicza op³aty abonamentowe klientów oraz op³aty sta³e. Nale¿y go uruchamiaæ 
		    codziennie. Op³aty naliczane na podstawie przypisanych klientowi
		    taryf zapisywane s± do bazy wraz z komentarzem okre¶lonym zmienn± 'comment'.
		    Po naliczeniu op³at tworzone s± faktury. Komentarz do op³aty sta³ej to zlepek
		    sk³adaj±cy siê z jej nazwy oraz wierzyciela. Na koñcu usuwane s± z bazy nieaktualne
		    obci±¿enia klientów.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="PAYMENTS-CONFIG"
>6.2.3.2. Konfiguracja</A
></H3
><P
>Dla tego modu³u s± dostêpne nastêpuj±ce zmienne kofiguracyjne:</P
><UL
><LI
><P
>comment</P
><P
>Komentarz do operacji. '%period' zostanie zamienione na daty od-do 
			    nale¿nego abonamentu, np. '2003/10/10 - 2003/11/09', a '%tariff' na nazwê
			    odpowiedniej taryfy. Domy¶lnie: 'Subscription: '%tariff' for period: %period'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>comment = 'Abonament miesiêczny za okres %period' </SAMP
></P
></LI
><LI
><P
>up_payments</P
><P
>"Naliczanie z góry", czyli czy okres w komentarzu ma byæ liczony do 
			    przodu, czy do ty³u w stosunku do daty naliczenia op³aty. Domy¶lnie: yes.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>up_payments = no</SAMP
></P
></LI
><LI
><P
>expiry_days</P
><P
>Okre¶la liczbê dni od daty wyga¶niêcia przypisanych klientowi zobowi±zañ, 
			    po której dane tego zobowi±zania zostan± usuniête z bazy. Przy ustawieniu na '0' dane
			    zostan± usuniête natychmiast po dacie, do której obowi±zywa³o zobowi±zanie. Domy¶lnie: 30.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>expiry_days = 365</SAMP
></P
></LI
><LI
><P
>deadline</P
><P
>Termin p³atno¶ci podany w dniach. Domy¶lnie: 14.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>deadline = 21</SAMP
></P
></LI
><LI
><P
>paytype</P
><P
>Rozdzaj p³atno¶ci. Domy¶lnie: 'TRANSFER'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>paytype = 'GOTÓWKA'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-NOTIFY"
>6.2.4. Notify</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="NOTIFY-DESC"
>6.2.4.1. Opis</A
></H3
><P
>Modu³ 'notify' s³u¿y do informowania klientów o zaleg³o¶ciach
		    w op³atach za pomoc± poczty elektronicznej. Aktualne saldo klienta
		    porównywane jest ze zmienn± 'limit', je¶li jest ni¿sze - wiadomo¶æ
		    zostaje wys³ana. Tre¶æ wiadomo¶ci pobierana jest z przygotowanego szablonu, 
		    w którym mo¿na stosowaæ nastêpuj±ce zmienne:
		    <UL
><LI
><P
>%saldo - aktualne saldo klienta (tak¿e %B)</P
></LI
><LI
><P
>%b - warto¶æ bezwzglêdna aktualnego salda klienta</P
></LI
><LI
><P
>%pin - PIN klienta</P
></LI
><LI
><P
>%name - imiê klienta</P
></LI
><LI
><P
>%lastname - nazwisko/nazwa klienta</P
></LI
><LI
><P
>%last_10_in_a_table - wyci±g ostatnich 10 operacji na kocie klienta</P
></LI
></UL
></P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="NOTIFY-CONFIG"
>6.2.4.2. Konfiguracja</A
></H3
><P
>Poni¿ej przedstawiono dostêpne opcje konfiguracyjne modu³u 'notify':</P
><UL
><LI
><P
>template</P
><P
>Lokalizacja pliku z szablonem wiadomo¶ci. Domy¶lnie: pusty</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>template = modules/notify/sample/mailtemplate</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Domy¶lnie: /tmp/mail</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/mail.txt</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wysy³aj±ce e-maila. '%address' zostanie zast±pione
			    adresem e-mail klienta. Domy¶lnie: 'mail -s "Liabilities Information" %address &lt; /tmp/mail'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'mail %address -s "musisz zap³aciæ, bo jak nie..." &lt; /tmp/mail.txt'</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Wiadomo¶æ o zaleg³o¶ciach zostaje wys³ana je¶li saldo klienta 
			    spadnie poni¿ej kwoty okre¶lonej zmienn± limit. Domy¶lnie: 0</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>debug_mail</P
><P
>Okre¶la adres na który zostan± wys³ane wszystkie wiadomo¶ci, przydatne
			    podczas testów. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>debug_mail = localhost@moja.net</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-GGNOTIFY"
>6.2.5. Ggnotify</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="GGNOTIFY-DESC"
>6.2.5.1. Opis</A
></H3
><P
>Odpowiednik modu³u 'notify' s³u¿±cy do wysy³ania wiadomo¶ci gadu-gadu.
		    Aktualne saldo klienta porównywane jest ze zmienn± 'limit', je¶li jest ni¿sze 
		    - wiadomo¶æ zostaje wys³ana. Tre¶æ wiadomo¶ci pobierana jest z przygotowanego szablonu, 
		    w którym mo¿na stosowaæ zmienne takie jak dla modu³u 'notify' (mo¿e to byæ te¿ ten sam 
		    szablon).</P
><P
>Modu³ wymaga zainstalowanej biblioteki <TT
CLASS="FILENAME"
>libgadu</TT
> oraz ¼róde³
		    programu <TT
CLASS="FILENAME"
>ekg</TT
>. Odpowiednie ¶cie¿ki do nich nale¿y ustawiæ
		    w <TT
CLASS="FILENAME"
>modules/ggnotify/Makefile</TT
> przed kompilacj± modu³u.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="GGNOTIFY-CONFIG"
>6.2.5.2. Konfiguracja</A
></H3
><P
>Podobnie jak w 'notify' masz do dyspozycji nastêpuj±ce zmienne:</P
><UL
><LI
><P
>template</P
><P
>Lokalizacja pliku z szablonem wiadomo¶ci. Domy¶lnie: pusty.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>template = modules/ggnotify/sample/mailtemplate</SAMP
></P
></LI
><LI
><P
>uin</P
><P
>Identyfikator gadu-gadu u¿ytkownika wysy³aj±cego wiadomo¶ci. 
			    Domy¶lnie: pusty.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>uin = 1234567</SAMP
></P
></LI
><LI
><P
>password</P
><P
>Has³o dla konta okre¶lonego zmienn± 'uin'. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>password = "moje_trudne__has³o"</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Wiadomo¶æ o zaleg³o¶ciach zostaje wys³ana je¶li saldo klienta 
			    spadnie poni¿ej kwoty okre¶lonej zmienn± limit. Domy¶lnie: 0</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>debug_uin</P
><P
>Je¶li ustawione, na to konto zostan± wys³ane wszystkie wiadomo¶ci.
			    Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>debug_uin = 7654321</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-CUTOFF"
>6.2.6. Cutoff</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="CUTOFF-DESC"
>6.2.6.1. Opis</A
></H3
><P
>Cutoff zmienia status komputerów na 'od³±czony' i/lub w³±cza ostrze¿enia
		    klientom, którzy maj± na koncie zaleg³o¶ci wiêksze ni¿ okre¶lony limit. Ten modu³ 
		    nie zajmuje siê fizycznym blokowaniem dostêpu do sieci.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="CUTOFF-CONFIG"
>6.2.6.2. Konfiguracja</A
></H3
><P
>Dla modu³u 'cutoff' mamy nastêpuj±ce opcje:</P
><UL
><LI
><P
>limit</P
><P
>Od³±czenie nastêpuje je¶li saldo klienta spadnie poni¿ej
			    kwoty okre¶lonej t± zmienn±. Domy¶lnie: 0.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Okre¶la komendê systemow±, która zostanie wywo³ana je¿eli co najmniej
			    jeden klient zostanie od³±czony lub zostanie w³±czone ostrze¿enie. 
			    Domy¶lnie: nieustawiona.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'lmsd -qi firewall'</SAMP
></P
></LI
><LI
><P
>warning</P
><P
>W³±cza ostrze¿enie dla od³±czanego klienta i przypisuje mu 
			    okre¶lon± w tej opcji tre¶æ. Je¿eli pusta, ostrze¿enie nie bêdzie w³±czane.
			    Data w ostrze¿eniu ukryta jest pod zmienn± '%time'.
			    Domy¶lnie: 'Blocked automatically due to payment deadline override on %time".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>warning = ""</SAMP
></P
></LI
><LI
><P
>warnings_only</P
><P
>Ta opcja pozwala zdecydowaæ, czy chcemy u¿yæ naszego 
			    modu³u wy³±cznie do w³±czania ostrze¿eñ. Domy¶lnie: wy³±czona.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>warnings_only = true</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-DHCP"
>6.2.7. Dhcp</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="DHCP-DESC"
>6.2.7.1. Opis</A
></H3
><P
>Modu³ zarz±dzaj±cy serwerem DHCP, tworzy plik konfiguracyjny oraz
		    restartuje us³ugê. Zmienna 'command' umo¿liwia równie¿ wykonywanie innych 
		    czynno¶ci (programów).</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="DHCP-CONFIG"
>6.2.7.2. Konfiguracja</A
></H3
><P
>Wiêkszo¶æ parametrów konfiguracyjnych odpowiada fragmentom 
		    pliku konfiguracyjnego dhcpd, które w typowych zastosowaniach
		    nie wymagaj± zmiany:</P
><UL
><LI
><P
>file</P
><P
>Okre¶la lokalizacjê pliku konfiguracyjnego serwera dhcp. 
			    Domy¶lnie: /etc/dhcpd.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/dhcpd.conf</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie wykonywane po utworzeniu pliku konfiguracyjnego. 
			    Domy¶lnie: pusta.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'killall -HUP dhcpd'</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek pliku. Domy¶lnie: pusty.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "authoritative;"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka pliku. Domy¶lnie: pusty.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>subnet_start</P
><P
>Nag³ówek podsieci. '%a' - nazwa, '%m' - maska. Domy¶lnie: "subnet %a netmask %m {\ndefault-lease-time 86400;\nmax-lease-time 86400;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_start = "subnet %a netmask %m {default-lease-time 3600;"</SAMP
></P
></LI
><LI
><P
>subnet_end</P
><P
>Stopka podsieci. Domy¶lnie: "}".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_end = '\t}'</SAMP
></P
></LI
><LI
><P
>subnet_gateway</P
><P
>Brama podsieci. '%i' zostanie zamienione na adres ip. Domy¶lnie: 'option routers %i;'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_gateway = "option routers %i"</SAMP
></P
></LI
><LI
><P
>subnet_dns</P
><P
>DNS'y podsieci. '%i - adresy dns'ów. Domy¶lnie: "option domain-name-servers %i;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_dns = "option domain-name-servers 192.168.0.1"</SAMP
></P
></LI
><LI
><P
>subnet_domain</P
><P
>Nazwa domenowa podsieci. '%n' - nazwa. Domy¶lnie: "option domain-name %n;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_domain = "option domain-name test.%n;"</SAMP
></P
></LI
><LI
><P
>subnet_wins</P
><P
>Serwery wins. '%i' - adres ip serwera. Domy¶lnie: "option netbios-name-servers %i;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_wins = ""</SAMP
></P
></LI
><LI
><P
>subnet_range</P
><P
>Zakres adresów podsieci. '%s' - adres pocz±tkowy, '%e' - koniec zakresu. Domy¶lnie: "range %s %e;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_range = "range %s %e;"</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Parametry hostów, gdzie '%n' - nazwa hosta, '%m' - MAC, '%i' - adres ip. 
			    Domy¶lnie: "\thost %n {\n\t\thardware ethernet %m; fixed-address %i; \n\t}".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host = "host %n {hardware ethernet %m; fixed-address %i;}"</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>customergroups</P
><P
>Lista nazw grup klientów, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>customergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-HOSTFILE"
>6.2.8. Hostfile</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="HOSTFILE-DESC"
>6.2.8.1. Opis</A
></H3
><P
>Modu³ 'hostfile' jest do¶æ uniwersalnym narzêdziem. Poniewa¿ 
		    wykonuje pêtlê po wszystkich komputerach w bazie rozró¿niaj±c ich
		    status (od³±czony/pod³±czony), sieæ do której s± pod³aczone oraz
		    grupy do których nale¿± ich w³a¶ciciele, dlatego mo¿liwe jest tworzenie np. regu³
		    dowolnego firewalla, czy te¿ pliku /etc/hosts. Dane zapisuje do pliku 
		    i nastêpnie wykonuje okre¶lone polecenie pow³oki.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="HOSTFILE-CONFIG"
>6.2.8.2. Konfiguracja</A
></H3
><P
>W opcjach 'grantedhost' i 'deniedhost' oraz 'public_deniedhost' i 'public_grantedhost'
		    mo¿na stosowaæ specjalne zmienne, które podczas zapisu do pliku zostan± 
		    zast±pione odpowiednimi dla danego komputera danymi:
		    <TABLE
BORDER="0"
><TBODY
><TR
><TD
>%i - adres IP,</TD
></TR
><TR
><TD
>%ipub - publiczny adres IP,</TD
></TR
><TR
><TD
>%id - ID komputera,</TD
></TR
><TR
><TD
>%m - mac adres,</TD
></TR
><TR
><TD
>%n - nazwa komputera,</TD
></TR
><TR
><TD
>%p - has³o,</TD
></TR
><TR
><TD
>%info - opis komputera,</TD
></TR
><TR
><TD
>%domain - domena,</TD
></TR
><TR
><TD
>%net - nazwa sieci, do której nale¿y host,</TD
></TR
><TR
><TD
>%if - interfejs sieci,</TD
></TR
><TR
><TD
>%addr - adres sieci,</TD
></TR
><TR
><TD
>%mask - maska sieci,</TD
></TR
><TR
><TD
>%gw - adres bramy,</TD
></TR
><TR
><TD
>%dns, %dns2 - adresy serwerów DNS,</TD
></TR
><TR
><TD
>%wins - adres serwera WINS.</TD
></TR
></TBODY
></TABLE
></P
><P
>Poni¿ej opcje udostêpniane przez ten modu³:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Domy¶lnie: /tmp/hostfile</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/rc.d/rc.firewall</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wyk. po utworzeniu pliku 'file'. Domy¶lnie: puste</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = '/bin/sh /etc/rc.d/rc.firewall'</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek pliku tymczasowego. Domy¶lnie: "/usr/sbin/iptables -F FORWARD\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "IPT=/usr/sbin/iptables \n$IPT -F FORWARD\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka pliku tymczasowego. Domy¶lnie: "/usr/sbin/iptables -A FORWARD -J REJECT\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = "$IPT -A FORWARD -J REJECT\n"</SAMP
></P
></LI
><LI
><P
>grantedhost</P
><P
>Tekst dla hosta pod³±czonego. Domy¶lnie: "/usr/sbin/iptables -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>grantedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n"</SAMP
></P
></LI
><LI
><P
>deniedhost</P
><P
>Tekst dla hosta od³±czonego. Domy¶lnie: "/usr/sbin/iptables -A FORWARD -s %i -m mac --mac-source %m -j REJECT\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>deniedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j REJECT\n"</SAMP
></P
></LI
><LI
><P
>public_grantedhost</P
><P
>Tekst dla hosta pod³±czonego, który posiada adres publiczny. 
			    Domy¶lnie regu³a okre¶lona opcj± 'grantedhost'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>public_grantedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n$IPT -t nat -A PREROUTING -p tcp -d %ipub -j DNAT --to-destination %i\n$IPT -t nat -A POSTROUTING -s %i -j SNAT --to-source %ipub\n"</SAMP
></P
></LI
><LI
><P
>public_deniedhost</P
><P
>Tekst dla hosta od³±czonego, który posiada adres publiczny. 
			    Domy¶lnie regu³a okre¶lona opcj± 'deniedhost'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>public_deniedhost = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>customergroups</P
><P
>Lista nazw grup klientów, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>customergroups = "grupa1 grupa2"</SAMP
></P
></LI
><LI
><P
>skip_dev_ips</P
><P
>Je¶li ustawiona na tak (yes, true) pominiête zostan± adresy urz±dzeñ sieciowych. Domy¶lnie: tak</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>skip_dev_ips = no</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-TRAFFIC"
>6.2.9. Traffic</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="TRAFFIC-DESC"
>6.2.9.1. Opis</A
></H3
><P
>'Traffic' to odpowiednik perlowego lms-traffic, zapisuj±cy do bazy statystyki
		    wykorzystania ³±cza z pliku utworzonego przez u¿ytkownika. Plik taki powinien mieæ 
		    format: ip_hosta upload download . Wiêcej informacji (w tym jak utworzyæ taki plik)
		    mo¿na znale¼æ w rozdziale dotycz±cym lms-traffic.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="TRAFFIC-CONFIG"
>6.2.9.2. Konfiguracja</A
></H3
><P
>Jedyny dostêpny parametr jest jednocze¶nie obowi±zkowy:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku ze statystykami firewalla. Domy¶lnie: /var/log/traffic.log</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/log</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-TC"
>6.2.10. Tc (HTB)</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="TC-DESC"
>6.2.10.1. Opis</A
></H3
><P
>Modu³ generuj±cy skrypt zawieraj±cy polecenia iptables i tc s³u¿±ce
		    do ograniczania pasma i limitowania po³±czeñ klientom. Regu³ki dla 
		    komputerów mo¿na dowolnie zdefiniowaæ i wykorzystaæ nie tylko do "traffic 
		    control". Zasada dzia³ania skryptu przedstawia siê nastêpuj±co: Najpierw z bazy
		    pobierane s± dane dla wszystkich klientów. Obliczane s± sumy ograniczeñ
		    (uprate, downrate, upceil, downceil, limity po³±czeñ) dla ka¿dego klienta
		    Nastêpnie wykonywana jest pêtla ze sprawdzeniem przynale¿no¶ci do grupy klientów
		    i sieci (je¶li okre¶lono). Je¶li warto¶ci ograniczeñ s± ró¿ne od zera nastêpuje
		    zapis regu³ do pliku z podmian± zmiennych. W regu³kach mo¿na stosowaæ nastêpuj±ce
		    zmienne: %name - nazwa hosta, %i - adres IP, %m - MAC, %uprate, %downrate, %upceil, 
		    %downceil, %plimit, %climit oraz %x - licznik o warto¶ci pocz±tkowej 100 
		    zwiêkszany o jeden dla ka¿dego komputera.</P
><P
>Domy¶lna polityka tworzenia klas htb zak³ada utworzenie jednej klasy dla
		    wszystkich komputerów klienta. Mo¿e to byæ zmienione za pomoc± opcji
		    'one_class_per_host'.</P
><P
>Konfiguracja domy¶lna zak³ada, ¿e twój system jest przystosowany
		    do zastosowania htb oraz iptables z modu³ami limit, connlimit, mark i ipp2p.
		    Mo¿esz sam spatchowaæ j±dro lub skorzystaæ ze ¼róde³ dostêpnych na stronie
		    <A
HREF="http://www.inet.one.pl"
TARGET="_top"
>www.inet.one.pl</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="TC-CONFIG"
>6.2.10.2. Konfiguracja</A
></H3
><P
>Masz do dyspozycji standardowe parametry takie jak customergroups, file,
		    command, networks i dodatkowo opcje definiuj±ce tre¶æ regu³ek tc i firewalla.
		    Domy¶lna konfiguracja przeznaczona jest dla ³±cz 512/128 kbit i 100mbit.</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Domy¶lnie: /etc/rc.d/rc.htb.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/rc.htb</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wykonywane po utworzeniu pliku. Domy¶lnie: "sh /etc/rc.d/rc.htb start".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = "chmod 700 /tmp/rc.htb; /tmp/rc.htb start"</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek skryptu. Domy¶lnie:
<PRE
CLASS="SCREEN"
>"#!/bin/sh
IPT=/usr/sbin/iptables
TC=/sbin/tc
LAN=eth0
WAN=eth1
BURST="burst 30k"

stop ()
{
$IPT -t mangle -D FORWARD -i $WAN -j LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -D FORWARD -o $WAN -j LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -F LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -X LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -F OUTPUT
$IPT -t filter -F FORWARD
$TC qdisc del dev $LAN root 2&#62; /dev/null
$TC qdisc del dev $WAN root 2&#62; /dev/null
}

start ()
{
stop
$IPT -t mangle -N LIMITS
$IPT -t mangle -I FORWARD -i $WAN -j LIMITS
$IPT -t mangle -I FORWARD -o $WAN -j LIMITS
# incomming traffic
$IPT -t mangle -A OUTPUT -j MARK --set-mark 1
$TC qdisc add dev $LAN root handle 1:0 htb default 3 r2q 1
$TC class add dev $LAN parent 1:0 classid 1:1 htb rate 99000kbit ceil 99000kbit quantum 1500
$TC class add dev $LAN parent 1:1 classid 1:2 htb rate   500kbit ceil   500kbit
$TC class add dev $LAN parent 1:1 classid 1:3 htb rate 98500kbit ceil 98500kbit prio 9 quantum 1500
$TC qdisc add dev $LAN parent 1:3 esfq perturb 10 hash dst
# priorities for ICMP, TOS 0x10 and ports 22 and 53
$TC class add dev $LAN parent 1:2 classid 1:20 htb rate 50kbit ceil 500kbit $BURST prio 1 quantum 1500
$TC qdisc add dev $LAN parent 1:20 esfq perturb 10 hash dst
$TC filter add dev $LAN parent 1:0 protocol ip prio 2 u32 match ip sport 22 0xffff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 2 u32 match ip sport 53 0xffff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 1 u32 match ip tos 0x10 0xff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 1 u32 match ip protocol 1 0xff flowid 1:20
# serwer -&#62; LAN
$TC filter add dev $LAN parent 1:0 protocol ip prio 4 handle 1 fw flowid 1:3

# outgoing traffic
$TC qdisc add dev $WAN root handle 2:0 htb default 11 r2q 1
$TC class add dev $WAN parent 2:0 classid 2:1 htb rate 120kbit ceil 120kbit
# priorities for ACK, ICMP, TOS 0x10, ports 22 and 53
$TC class add dev $WAN parent 2:1 classid 2:10 htb rate 60kbit ceil 120kbit prio 1 quantum 1500
$TC qdisc add dev $WAN parent 2:10 esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip protocol 6 0xff \
match u8 0x05 0x0f at 0 match u16 0x0000 0xffc0 at 1 match u8 0x10 0xff at 33 flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip dport 22 0xffff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip dport 53 0xffff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip tos 0x10 0xff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip protocol 1 0xff flowid 2:10
# serwer -&#62; Internet
$TC class add dev $WAN parent 2:1 classid 2:11 htb rate 30kbit ceil 120kbit prio 2 quantum 1500
$TC qdisc add dev $WAN parent 2:11 esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 3 handle 1 fw flowid 2:11
$TC filter add dev $WAN parent 2:0 protocol ip prio 9 u32 match ip dst 0/0 flowid 2:11</PRE
></P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "#!/bin/bash\n$TC=/usr/local/sbin/tc\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka skryptu. Domy¶lnie:
<PRE
CLASS="SCREEN"
>}

case "$1" in
    'start')
	start
    ;;
    'stop')
	stop
    ;;
    'status')
	echo "WAN Interface"
	echo "============="
	$TC class show dev $WAN | grep root
	$TC class show dev $WAN | grep -v root | sort | nl
	echo "LAN Interface"
	echo "============="
	$TC class show dev $LAN | grep root
	$TC class show dev $LAN | grep -v root | sort | nl
    ;;
    *)
	echo -e "\nUsage: rc.htb start|stop|status"
    ;;
esac</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>one_class_per_host</P
><P
>Okre¶la politykê tworzenia klas htb. W ustawieniu domy¶lnym
			    wszystkie komputery klienta zostan± wrzucone do jednej klasy.
			    Ustawienie tej opcji na 'true' spowoduje, ¿e regu³y okre¶lone w 
			    host_htb_up i host_htb_down zostan± wygenerowane dla wszystkich
			    komputerów klienta (z inn± warto¶ci± '%x'). Regu³y z host_mark_down,
			    host_mark_up, host_plimit i host_climit generowane s± dla ka¿dego
			    komputera niezale¿nie od ustawieñ tej zmiennej. Domy¶lnie: false</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>one_class_per_host = 1</SAMP
></P
></LI
><LI
><P
>host_mark_down</P
><P
>Regu³a markuj±ca dla ka¿dego komputera. Domy¶lnie:
<PRE
CLASS="SCREEN"
># %n
$IPT -t mangle -A LIMITS -d %i -j MARK --set-mark %x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_mark_down = ""</SAMP
></P
></LI
><LI
><P
>host_mark_up</P
><P
>Regu³a markuj±ca dla ka¿dego komputera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$IPT -t mangle -A LIMITS -s %i -j MARK --set-mark %x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_mark_up = ""</SAMP
></P
></LI
><LI
><P
>host_htb_down</P
><P
>Zestaw regu³ dla ka¿dego komputera, wykonywanych
			    gdy uprate i downrate s± ró¿ne od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$TC class add dev $LAN parent 1:2 classid 1:%x htb rate %downratekbit ceil %downceilkbit $BURST prio 2 quantum 1500
$TC qdisc add dev $LAN parent 1:%x esfq perturb 10 hash dst
$TC filter add dev $LAN parent 1:0 protocol ip prio 5 handle %x fw flowid 1:%x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_htb_down = ""</SAMP
></P
></LI
><LI
><P
>host_htb_up</P
><P
>Zestaw regu³ dla ka¿dego komputera, wykonywanych
			    gdy uprate i downrate s± ró¿ne od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$TC class add dev $WAN parent 2:1 classid 2:%x htb rate %upratekbit ceil %upceilkbit $BURST prio 2 quantum 1500
$TC qdisc add dev $WAN parent 2:%x esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 5 handle %x fw flowid 2:%x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_htb_up = ""</SAMP
></P
></LI
><LI
><P
>host_climit</P
><P
>Regu³ka z ograniczeniem ilo¶ci równoczesnych po³±czeñ tcp. Wykonywana
			    gdy climit w bazie jest ró¿ny od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$IPT -t filter -I FORWARD -p tcp -s %i -m connlimit --connlimit-above %climit -m ipp2p --ipp2p -j REJECT</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_climit = "$IPT -t filter -I FORWARD -p tcp -s %i -m connlimit --connlimit-above -j REJECT"</SAMP
></P
></LI
><LI
><P
>host_plimit</P
><P
>Regu³ka z ograniczeniem ilo¶ci pakietów w jednostce czasu (tutaj sekunda). Wykonywana
			    gdy plimit w bazie jest ró¿ny od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$IPT -t filter -I FORWARD -p tcp -d %i -m limit --limit %plimit/s -m ipp2p --ipp2p -j ACCEPT
$IPT -t filter -I FORWARD -p tcp -s %i -m limit --limit %plimit/s -m ipp2p --ipp2p -j ACCEPT</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_plimit = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>customergroups</P
><P
>Lista nazw grup klientów, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>customergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-DNS"
>6.2.11. Dns</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="DNS-DESC"
>6.2.11.1. Opis</A
></H3
><P
>Modu³ do konfiguracji stref serwera 'named' jest jednym z bardziej skomplikowanych.
		    Tworzy dla ka¿dej sieci pliki stref oraz odpowiednie wpisy w named.conf w oparciu
		    o szablony tych plików. Przyk³adowe szablony znajduj± siê w katalogu
		    <TT
CLASS="FILENAME"
>/modules/dns/sample</TT
>.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="DNS-CONFIG"
>6.2.11.2. Konfiguracja</A
></H3
><P
></P
><UL
><LI
><P
>forward-patterns</P
><P
>Katalog z szablonami stref. Domy¶lnie: forward.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>forward-patterns = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>reverse-patterns</P
><P
>Katalog z szablonami stref odwrotnych. Domy¶lnie: reverse.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>reverse-patterns = /dns/patterns/revers</SAMP
></P
></LI
><LI
><P
>generic-forward</P
><P
>Szablon domy¶lny. Zostanie wykorzystany je¶li w katalogu okre¶lonym
			    'forward-patterns' nie bêdzie pliku odpowiadaj±cego nazwie domenowej sieci.
			    Domy¶lnie: modules/dns/sample/forward/generic.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>generic-forward = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>generic-reverse</P
><P
>Szablon domy¶lny. Zostanie wykorzystany je¶li w katalogu okre¶lonym
			    'reverse-patterns' nie bêdzie pliku odpowiadaj±cego numerowi IP sieci.
			    Domy¶lnie: modules/dns/sample/reverse/generic.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>generic-reverse = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>forward-zones</P
><P
>Katalog na pliki wynikowe stref.
			    Domy¶lnie: modules/dns/sample/out/forward.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>forward-zones = /dns/forward</SAMP
></P
></LI
><LI
><P
>reverse-zones</P
><P
>Katalog na pliki wynikowe stref odwrotnych.
			    Domy¶lnie: modules/dns/sample/out/reverse.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>reverse-zones = /dns/reverse</SAMP
></P
></LI
><LI
><P
>host-reverse</P
><P
>Linia w pliku strefy odwr. odpowiadaj±ca ka¿demu komputerowi w dane sieci.
			    Domy¶lnie: "%n IN A %i\n".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host-reverse = "\t %n IN A %i\n"</SAMP
></P
></LI
><LI
><P
>host-forward</P
><P
>Linia w pliku strefy odpowiadaj±ca ka¿demu komputerowi w danej sieci.
			    Domy¶lnie: "%c IN PTR %n.%d.\n".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host-forward = "\t %c IN PTR %n.%d.\n"</SAMP
></P
></LI
><LI
><P
>conf-pattern</P
><P
>Lokalizacja szablonu g³ównego pliku konfiguracyjnego serwera.
			    Domy¶lnie: modules/dns/sample/named.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-pattern = /dns/patterns/named.conf</SAMP
></P
></LI
><LI
><P
>conf-output</P
><P
>Lokalizacja g³ównego pliku konfiguracyjnego serwera.
			    Domy¶lnie: /tmp/named.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-output = /etc/named.conf</SAMP
></P
></LI
><LI
><P
>conf-forward-entry</P
><P
>Wpis dla ka¿dej strefy w g³ównym pliku konfiguracyjnym.
			    Domy¶lnie: 'zone "%n" {\ntype master;\n file "forward/%n"; \nnotify yes; \n}; \n'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-forward-entry = 'zone "%n" { \n\ttype master; \n\tfile "forward/%n"; \n\tnotify yes; \n}; \n'</SAMP
></P
></LI
><LI
><P
>conf-reverse-entry</P
><P
>Wpis dla ka¿dej strefy odwr. w g³ównym pliku konfiguracyjnym.
			    Domy¶lnie: 'zone "%c.in-addr.arpa" { \ntype master; \nfile "reverse/%i"; \nnotify yes; \n}; \n'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-revers-entry = 'zone "%c.in-addr.arpa" { \n\ttype master; \n\tfile "reverse/%i"; \n\tnotify yes; \n}; \n'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie wykonywane po utworzeniu plików konf. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>custmergroups</P
><P
>Lista nazw grup klientów, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>customergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-ETHERS"
>6.2.12. Ethers</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="ETHERS-DESC"
>6.2.12.1. Opis</A
></H3
><P
>Modu³ tworz±cy konfiguracjê tablicy ARP systemu. Ustawiaj±c opcjê
		    'dummy_macs' mo¿na sprawiæ, aby komputerom od³±czonym zosta³ przypisany 
		    mac-adres 00:00:00:00:00:00.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="ETHERS-CONFIG"
>6.2.12.2. Konfiguracja</A
></H3
><P
>Tutaj s± tylko standardowe opcje:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku wynikowego. Domy¶lnie: /etc/ethers.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/ethers</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wykonywane po wygenerowaniu konfiga. Domy¶lnie: 'arp -f /etc/ethers'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = ""</SAMP
></P
></LI
><LI
><P
>dummy_macs</P
><P
>Je¶li ustawimy na 'yes', to komputerom od³±czonym zostanie
			    przypisany mac-adres '00:00:00:00:00:00'. Domy¶lnie: "no".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>dummy_macs = yes</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>customergroups</P
><P
>Lista nazw grup klientów, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>customergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-OIDENT"
>6.2.13. Oident</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="OIDENT-DESC"
>6.2.13.1. Opis</A
></H3
><P
>Modu³ do konfiguracji oidentd. W zasadzie mo¿na to zrobiæ modu³em
		    'hostfile', ale tutaj masz ju¿ gotowe ustawienia domy¶lne.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="OIDENT-CONFIG"
>6.2.13.2. Konfiguracja</A
></H3
><P
>A oto parametry modu³u 'oident'</P
><UL
><LI
><P
>begin</P
><P
>Tekst wstawiany na pocz±tku pliku. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "#Generowany automatycznie\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Tekst wstawiany na koñcu pliku. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Linia tekstu dla ka¿dego komputera. Domy¶lnie: "%i\t%n\tUNIX".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host = "%i %n WINDOWS"</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Nazwa pliku konfiguracyjnego. Domy¶lnie: /etc/oidentd.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/oident/identd.conf</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci do uwzglêdnienia. Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = 'lan1 lan2'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie do wykonania po utworzeniu pliku. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = "killall -HUP midentd"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-PINGER"
>6.2.14. Pinger</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="PINGER-DESC"
>6.2.14.1. Opis</A
></H3
><P
>Modu³ pinger to odpowiednik perlowego skryptu lms-fping. Ró¿nice s± jednak
		    zasadnicze. Nie potrzebuje zewnêtrznego programu i dzia³a przy wykorzystaniu
		    protoko³u ARP. Powodem tego jest mniej wiêcej dwukrotnie szybsze wykonanie
		    skanowania sieci. Nie ma tak¿e problemów z komputerami maj±cymi wy³±czone 
		    odpowiadanie na pingi. Po skanowaniu, wszystkim w³±czonym komputerom jest
		    ustawiany w bazie danych czas skanowania, wykorzystywany do obrazowania
		    aktywno¶ci komputerów np. na mapie sieci.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Pinger rozpoznaje interfejsy sieciowe na podstawie
		    nazwy, dlatego (np. gdy do zak³adania interfejsów wirtualnych/aliasów 
		    wykorzystujesz program <TT
CLASS="FILENAME"
>ip</TT
>) musisz nadawaæ interfejsom etykiety 
		    (ip addr add ... label ...). Pamiêtaj tak¿e, ¿eby nie u¿ywaæ w nazwach
		    kropek, ani my¶lników (mimo, ¿e <TT
CLASS="FILENAME"
>ip</TT
> na to pozwala), gdy¿ pinger
		    nie rozpozna poprawnie takiego interfejsu.</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="PINGER-CONFIG"
>6.2.14.2. Konfiguracja</A
></H3
><P
>Pinger udostêpnia tylko jedn± opcjê konfiguracyjn±:</P
><UL
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ skanowane. Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = 'lan1 lan2'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="DAEMON-PARSER"
>6.2.15. Parser</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="DAEMON-PARSER-INTRO"
>6.2.15.1. Wstêp</A
></H3
><P
>Modu³ parser jest oparty na skryptowym jêzyku
				<A
HREF="http://silvercoders.com/index.php?page=T_Script"
TARGET="_top"
>T-Script</A
>,
				którego g³ównym zadaniem jest generowanie plików tekstowych. Mo¿e byæ
				u¿ywany do przetwarzania szablonów z danymi pobieranymi z ró¿nych
				¼róde³ np. baz SQL lub plików tekstowych. W naszym przypadku tre¶æ
				skryptu (szablon) jest przechowywany w bazie danych, dlatego istnieje
				mo¿liwo¶æ jego edycji poprzez <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
>.
				W przysz³o¶ci modu³ parser mo¿e zast±piæ wiêkszo¶æ modu³ów 
				demona.</P
><P
>Opis jêzyka T-Script znajduje siê w rozdziale <A
HREF="tscript.html"
>T-Script</A
>.</P
><P
>Przed kompilacj± modu³u upewnij siê, ¿e posiadasz w systemie
				pakiety <TT
CLASS="FILENAME"
>bison</TT
> (co najmniej w wersji 1.875) oraz 
				<TT
CLASS="FILENAME"
>flex</TT
>.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="DAEMON-PARSER-CONFIG"
>6.2.15.2. Konfiguracja</A
></H3
><P
>Parser posiada nastêpuj±ce opcje:</P
><UL
><LI
><P
>script</P
><P
>Zawarto¶æ skryptu (szablonu). Domy¶lnie: pusta.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>script = '{var=1}zmienna var={var}'</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Lokalizacja pliku wynikowego. Domy¶lnie: pusta</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/parser.out</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki do wykonania po kompilacji skryptu. Domy¶lnie: pusta</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = "sh /tmp/parser.out"</SAMP
></P
></LI
></UL
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="daemon.html"
ACCESSKEY="P"
>Poprzedni</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Spis tre&#347;ci</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="tscript.html"
ACCESSKEY="N"
>Nast&#281;pny</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>LMS Daemon</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="daemon.html"
ACCESSKEY="U"
>Pocz&#261;tek rozdzia&#322;u</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>T-Script</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>LMS - LAN Management System 1.5-cvs</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="style.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=ISO-8859-2"></HEAD
><BODY
CLASS="BOOK"
BGCOLOR="#EBE4D6"
TEXT="#000000"
><DIV
CLASS="BOOK"
><A
NAME="AEN1"
></A
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>LMS - LAN Management System 1.5-cvs</A
></H1
><DIV
CLASS="MEDIAOBJECT"
><P
><IMG
SRC="images/logo-small.png"></P
></DIV
><H3
CLASS="CORPAUTHOR"
> LMS Developers</H3
><P
CLASS="COPYRIGHT"
>Copyright &copy; 2001-2004  LMS Developers</P
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Spis tre&#347;ci</B
></DT
><DT
>1. <A
HREF="#INTRO"
>Wstêp</A
></DT
><DD
><DL
><DT
>1.1. <A
HREF="#ABOUT-LMS"
>Czym jest LMS</A
></DT
><DT
>1.2. <A
HREF="#AUTHORS"
>Autorzy</A
></DT
><DT
>1.3. <A
HREF="#LEGALNOTICE"
>Licencja</A
></DT
><DT
>1.4. <A
HREF="#MOREINFO"
>Informacje dodatkowe</A
></DT
></DL
></DD
><DT
>2. <A
HREF="#INSTALL"
>Instalacja i konfiguracja</A
></DT
><DD
><DL
><DT
>2.1. <A
HREF="#INSTALL-INTRO"
>Wstêp</A
></DT
><DT
>2.2. <A
HREF="#INSTALL-REQUIREMENTS"
>Wymagania</A
></DT
><DT
>2.3. <A
HREF="#INSTALL-INSTALL"
>Instalacja LMS</A
></DT
><DT
>2.4. <A
HREF="#INSTALL-DB"
>Instalacja serwera baz danych</A
></DT
><DT
>2.5. <A
HREF="#INSTALL-CONFIG"
>Konfiguracja podstawowa</A
></DT
><DT
>2.6. <A
HREF="#INSTALL-RIGHTS"
>Prawa dostêpu</A
></DT
><DT
>2.7. <A
HREF="#INSTALL-UPGRADE"
>Upgrade</A
></DT
></DL
></DD
><DT
>3. <A
HREF="#USER"
>Interfejs U¿ytkownika (LMS-UI)</A
></DT
><DD
><DL
><DT
>3.1. <A
HREF="#USER-LOGIN"
>Logowanie</A
></DT
><DT
>3.2. <A
HREF="#MENU-ADMINISTRATION"
>Administracja</A
></DT
><DT
>3.3. <A
HREF="#MENU-USERS"
>U¿ytkownicy</A
></DT
><DT
>3.4. <A
HREF="#MENU-NODES"
>Komputery</A
></DT
><DT
>3.5. <A
HREF="#MENU-NETDEVICES"
>Osprzêt sieciowy</A
></DT
><DT
>3.6. <A
HREF="#MENU-NETWORKS"
>Sieci IP</A
></DT
><DT
>3.7. <A
HREF="#MENU-FINANCES"
>Taryfy i Finanse</A
></DT
><DT
>3.8. <A
HREF="#MENU-ACCOUNTS"
>Konta</A
></DT
><DT
>3.9. <A
HREF="#MENU-MAILING"
>Mailing</A
></DT
><DT
>3.10. <A
HREF="#MENU-RELOAD"
>Prze³adowanie</A
></DT
><DT
>3.11. <A
HREF="#MENU-STATS"
>Statystyki</A
></DT
><DT
>3.12. <A
HREF="#MENU-HELPDESK"
>Helpdesk</A
></DT
></DL
></DD
><DT
>4. <A
HREF="#SCRIPTS"
>Skrypty</A
></DT
><DD
><DL
><DT
>4.1. <A
HREF="#SCRIPTS-INSTALL"
>Instalacja</A
></DT
><DT
>4.2. <A
HREF="#SCRIPTS-LIST"
>Lista dostêpnych skryptów</A
></DT
><DT
>4.3. <A
HREF="#SCRIPTS-CONFIG"
>Opis i konfiguracja</A
></DT
></DL
></DD
><DT
>5. <A
HREF="#MGC"
>Generator plików konfiguracyjnych (lms-mgc)</A
></DT
><DD
><DL
><DT
>5.1. <A
HREF="#MGC-INSTALL"
>Instalacja</A
></DT
><DT
>5.2. <A
HREF="#MGC-CONFIG"
>Konfiguracja</A
></DT
><DT
>5.3. <A
HREF="#MGC-EXAMPLE"
>Przyk³ad zastosowania lms-mgc</A
></DT
></DL
></DD
><DT
>6. <A
HREF="#DAEMON"
>A.L.E.C's LMS Daemon</A
></DT
><DD
><DL
><DT
>6.1. <A
HREF="#DAEMON-INTRO"
>Informacje podstawowe</A
></DT
><DT
>6.2. <A
HREF="#DAEMON-MODULES"
>Modu³y</A
></DT
></DL
></DD
><DT
>7. <A
HREF="#DEVEL"
>Dla dociekliwych</A
></DT
><DD
><DL
><DT
>7.1. <A
HREF="#DEVEL-CATALOGS"
>Drzewo katalogów</A
></DT
><DT
>7.2. <A
HREF="#DEVEL-DB"
>Struktura bazy danych</A
></DT
><DT
>7.3. <A
HREF="#DEVEL-INI"
>Format pliku konfiguracyjnego</A
></DT
><DT
>7.4. <A
HREF="#DEVEL-GENFAKE"
>Generowanie danych losowych</A
></DT
><DT
>7.5. <A
HREF="#DEVEL-RIGHTS"
>Poziomy dostêpu</A
></DT
><DT
>7.6. <A
HREF="#DEVEL-LIMITS"
>Ograniczenia</A
></DT
></DL
></DD
><DT
>8. <A
HREF="#CONTRIB"
>Dodatki</A
></DT
><DD
><DL
><DT
>8.1. <A
HREF="#CONTRIB-CUSTOMER"
>Moje konto</A
></DT
><DT
>8.2. <A
HREF="#CONTRIB-CUSTOMER2"
>Moje konto 2</A
></DT
><DT
>8.3. <A
HREF="#CONTRIB-SQLPANEL"
>Panel SQL</A
></DT
><DT
>8.4. <A
HREF="#CONTRIB-SQUID-WARN"
>Ostrze¿enia + squid</A
></DT
></DL
></DD
><DT
>9. <A
HREF="#FAQ"
>FAQ</A
></DT
></DL
></DIV
><DIV
CLASS="LOT"
><DL
CLASS="LOT"
><DT
><B
>Spis tabel</B
></DT
><DT
>4-1. <A
HREF="#SCRIPTS-TABLE"
>Lista skryptów wykonywalnych</A
></DT
><DT
>6-1. <A
HREF="#MODULES-LIST"
>Lista modu³ów demona almsd</A
></DT
><DT
>7-1. <A
HREF="#CATALOG-TREE"
>Drzewo katalogów LMS</A
></DT
></DL
></DIV
><DIV
CLASS="LOT"
><DL
CLASS="LOT"
><DT
><B
>Spis przyk&#322;adów</B
></DT
><DT
>3-1. <A
HREF="#ACCOUNTS-E1"
>Konta. Konfiguracja proftpd.</A
></DT
><DT
>4-1. <A
HREF="#NOTIFY-EXAMPLE"
>Lms-notify: Przyk³adowy wyci±g 10 ostatnich operacji kasowych</A
></DT
><DT
>4-2. <A
HREF="#NOTIFY-TEMPLATE"
>Lms-notify: Przyk³ad szablonu</A
></DT
><DT
>5-1. <A
HREF="#INSTANCE-EXAMPLE"
>Lms-mgc: Przyk³ad instancji</A
></DT
><DT
>7-1. <A
HREF="#CONFIG-FORMAT"
>Format opcji konfiguracyjnych</A
></DT
></DL
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="INTRO"
></A
>Rozdzia&#322; 1. Wstêp</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="ABOUT-LMS"
>1.1. Czym jest LMS</A
></H2
><P
>"LMS" jest skrótem od "LAN Management System". Jest to zestaw aplikacji 
		w PHP, C i Perlu, u³atwiaj±cych zarz±dzanie sieciami osiedlowymi
		(popularnie zwanymi Amatorskimi Sieciami Komputerowymi), korzystaj±cych z bazy danych 
		MySQL, PostgreSQL lub SQLite. G³ówne za³o¿enia to uzyskanie jako¶ci us³ug oraz obs³ugi 
		u¿ytkowników na poziomie providera z prawdziwego zdarzenia. Najbardziej podstawowe 
		cechy LMS to:</P
><UL
><LI
><P
>baza danych u¿ytkowników (imiê, nazwisko, adres, numer telefonu, uwagi i inne),</P
></LI
><LI
><P
>baza danych komputerów (adres IP, adres MAC),</P
></LI
><LI
><P
>baza danych sprzêtu sieciowego (nazwa, ilo¶æ portów),</P
></LI
><LI
><P
>generowanie mapy sieci,</P
></LI
><LI
><P
>prowadzenie prostego rachunku operacji finansowych oraz stanu funduszów sieci,</P
></LI
><LI
><P
>zestawienia finansowe, fakturowanie,</P
></LI
><LI
><P
>ró¿ne op³aty i taryfy abonamentowe,</P
></LI
><LI
><P
>wysy³anie poczt± elektroniczn± upomnieñ do u¿ytkowników,</P
></LI
><LI
><P
>automatyczne naliczanie op³at miesiêcznych,</P
></LI
><LI
><P
>generowanie praktycznie jakiegokolwiek konfiga na podstawie danych 
			o komputerach w bazie (przyk³adowe konfigi obejmuj± rc.masq na iptables, 
			dhcpd.conf, oidentd_masq.conf, /etc/ethers, dns prosty i odwrotny, htb),</P
></LI
><LI
><P
>wizualizacja statystyk wykorzystania ³±cza,</P
></LI
><LI
><P
>system obs³ugi zg³oszeñ (Helpdesk).</P
></LI
></UL
><P
>Ca³o¶æ zosta³a wymy¶lona w ramach administracji <A
HREF="http://www.netx.waw.pl/"
TARGET="_top"
>ASK NetX</A
> 
		i tam jest nieustannie rozwijana i poddawana testom.</P
><P
>LMS nie zast±pi Ci umiejêtno¶ci jakie powinien mieæ administrator. 
		Je¶li nie potrafisz wykonaæ tak prostych czynno¶æ jak instalacja czy konfiguracja, 
		prawdopodobnie nie bêdziesz umia³ dostroiæ LMS do swojego systemu. Tak wiêc bez 
		znajomo¶ci systemów U*IX siê nie obejdzie.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="AUTHORS"
>1.2. Autorzy</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="LMS"
>1.2.1. LMS Developers</A
></H3
><UL
><LI
><P
>Kod PHP:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://www.baseciq.org"
TARGET="_top"
>£ukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
>Micha³ 'DziQs' Zapalski</TD
></TR
><TR
><TD
><A
HREF="http://debian.black.pl"
TARGET="_top"
>Rados³aw 'Warden' Antoniuk</A
></TD
></TR
><TR
><TD
>Krzysztof 'hunter' Drewicz</TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Król</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.alec.k27.prv.pl"
TARGET="_top"
>Aleksander A.L.E.C Machniak</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Kod C:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://k27.prv.pl/alec"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Król</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Kod Perl:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>£ukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
>Micha³ 'DziQs' Zapalski</TD
></TR
><TR
><TD
>Maciej 'agaran' Pijanka</TD
></TR
><TR
><TD
>Krzysztof 'hunter' Drewicz</TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Design:
		    <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>£ukasz 'Baseciq' Mozer</A
></TD
></TR
></TBODY
></TABLE
>
		    </P
></LI
><LI
><P
>HTML, JavaScript, CSS:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>£ukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
><A
HREF="http://plug.atn.pl/~bober/"
TARGET="_top"
>Pawe³ 'Bob_R' Czerski</A
></TD
></TR
><TR
><TD
><A
HREF="http://gamechannel.int.pl"
TARGET="_top"
>Pawe³ 'sickone' Kisiela</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Grafika:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://pierzak.melanz.org"
TARGET="_top"
>Piotr 'Pierzak' M.</A
></TD
></TR
><TR
><TD
><A
HREF="http://byko.pawlacz.net"
TARGET="_top"
>Grzegorz 'byko' Cichowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.kflis.net"
TARGET="_top"
>Kuba 'kflis' Flis</A
></TD
></TR
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>£ukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
><A
HREF="http://jimmac.musichall.cz"
TARGET="_top"
>Jakub 'Jimmac' Steiner</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Support MySQL:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://s.atn.pl"
TARGET="_top"
>Kuba 'shasta' Jankowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://debian.black.pl"
TARGET="_top"
>Rados³aw 'Warden' Antoniuk</A
></TD
></TR
><TR
><TD
>Przemys³aw Babiñski</TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Support Postgresql i SQLite:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://alec.k27.prv.pl"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Dokumentacja i strona WWW:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://alec.k27.prv.pl"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
><TR
><TD
><A
HREF="http://s.atn.pl"
TARGET="_top"
>Kuba 'shasta' Jankowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.rednet.krakow.pl/~jabbas/"
TARGET="_top"
>Grzegorz 'JaBBaS' Dziêgielewski</A
></TD
></TR
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>£ukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Król</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
><LI
><P
>Betatesterzy:
			<TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://byko.pawlacz.net"
TARGET="_top"
>Grzegorz 'byko' Cichowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://debian.black.pl"
TARGET="_top"
>Rados³aw 'Warden' Antoniuk</A
></TD
></TR
><TR
><TD
>Tomasz 'dzwonek' Dzwonkowski</TD
></TR
><TR
><TD
>Sebastian 'Victus' Frasunkiewicz</TD
></TR
><TR
><TD
><A
HREF="http://www.kflis.net"
TARGET="_top"
>Kuba 'kflis' Flis</A
></TD
></TR
><TR
><TD
>Krystian 'UFOczek' Kochanowski</TD
></TR
><TR
><TD
><A
HREF="http://www.rednet.krakow.pl/~jabbas/"
TARGET="_top"
>Grzegorz 'JaBBaS' Dziêgielewski</A
></TD
></TR
><TR
><TD
>Andrzej 'chsh' Gr±dziel</TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Król</A
></TD
></TR
></TBODY
></TABLE
>
			</P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="OTHERS"
>1.2.2. Inni</A
></H3
><P
>LMS zawiera fragmenty nastêpuj±cego oprogramowania: 
		<A
HREF="http://phpwizard.net/projects/phpMyAdmin/"
TARGET="_top"
>phpMyAdmin</A
>,
		<A
HREF="phpsysinfo.sourceforge.net"
TARGET="_top"
>phpsysinfo</A
>, 
		<A
HREF="florian-amrhein.de/newsportal/index-anglish.php3"
TARGET="_top"
>NewsPortal</A
>, 
		procedury konwersji liczb na postaæ s³own± autorstwa Piotra Klebana oraz
		przyk³ady kodu zawarte w <A
HREF="http://www.php.net/manual/pl/"
TARGET="_top"
>		Podrêczniku PHP</A
>.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="LEGALNOTICE"
>1.3. Licencja</A
></H2
><P
>Niniejszy  program  jest  oprogramowaniem  wolnodostêpnym;  
		mo¿esz  go rozprowadzaæ dalej i/lub modyfikowaæ na warunkach Powszechnej 
		Licencji Publicznej  GNU, wydanej przez Fundacjê Wolnodostêpnego Oprogramowania 
		- wed³ug wersji 2-giej tej Licencji lub której¶ z pó¼niejszych wersji.</P
><P
>Niniejszy program rozpowszechniany jest z nadziej±, i¿ bêdzie on u¿yteczny 
		- jednak  BEZ JAKIEJKOLWIEK GWARANCJI, nawet domy¶lnej gwarancji  
		PRZYDATNO¦CI HANDLOWEJ albo PRZYDATNO¦CI DO OKRE¦LONYCH ZASTOSOWAÑ.   
		W celu uzyskania bli¿szych informacji - Powszechna Licencja Publiczna GNU.</P
><P
>Z  pewno¶ci±  wraz  z  niniejszym  programem otrzyma³e¶ te¿ egzemplarz 
		Powszechnej Licencji Publicznej GNU; je¶li nie - napisz do Free Software 
		Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA. </P
><P
>Angielski tekst tej licencji znajduje siê <A
HREF="../COPYING"
TARGET="_top"
>		tutaj</A
>.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MOREINFO"
>1.4. Informacje dodatkowe</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="CONTACT"
>1.4.1. Kontakt z autorami</A
></H3
><P
>Najlepiej poprzez listê mailingow±, na któr± mo¿na siê zapisaæ wysy³aj±c
			pustego maila o temacie "subscribe lms" na adres <A
HREF="mailto: ecartis@lists.rulez.pl"
TARGET="_top"
>ecartis@lists.rulez.pl</A
>,
			a maile wysy³a siê na adres lms@lists.rulez.pl.
			</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="BUGS"
>1.4.2. Zg³aszanie b³êdów i pomys³ów</A
></H3
><P
>Aby efektywnie zg³osiæ b³±d lub nowy pomys³, najlepiej jest zapisaæ siê na listê mailingow±
			gdzie kto¶ z autorów b±d¼ u¿ytkowników bêdzie mia³ szansê odpowiedzieæ
			na pytania Ciê nurtuj±ce. Dostêpny jest tak¿e dla testów BTS, gdzie mo¿na
			zg³aszaæ b³êdy po uprzedniej rejestracji. Raporty z BTS id± tak¿e na listê
			mailingow±, wiêc najlepiej siê zapisaæ, zg³osiæ b³±d poprzez BTS, wys³aæ
			linka na listê i czekaæ na rozwój wydarzeñ. Adres BTS to <A
HREF="http://bts.rulez.pl"
TARGET="_top"
>			http://bts.rulez.pl</A
>.
			</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LATEST"
>1.4.3. Najnowsza wersja</A
></H3
><P
>Zawsze aktualn± werjsê LMS mo¿na pobraæ z repozytorium CVS za pomoc±
			interfejsu www <A
HREF="http://cvs.rulez.pl/viewcvs.cgi/lms/lms.tar.gz?tarball=1"
TARGET="_top"
>tutaj</A
>,
			lub klasycznie (dostêp anonimowy, puste has³o):</P
><PRE
CLASS="SCREEN"
>cvs -d :pserver:cvs@cvs.rulez.pl:/home/cvsroot login
cvs -d :pserver:cvs@cvs.rulez.pl:/home/cvsroot co lms
cvs -d :pserver:cvs@cvs.rulez.pl:/home/cvsroot logout</PRE
><P
>Repozytorium CVS mo¿na tak¿e przegl±daæ przy pomocy interfejsu WWW pod
			adresem <A
HREF="http://cvs.rulez.pl"
TARGET="_top"
>http://cvs.rulez.pl</A
>.
			</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="HISTORY"
>1.4.4. Historia zmian</A
></H3
><P
>Informacje o zmianach jakie zasz³y w kolejnych 
			wersjach LMS zawarte s± w pliku <A
HREF="../ChangeLog"
TARGET="_top"
>			ChangeLog</A
>.</P
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="INSTALL"
></A
>Rozdzia&#322; 2. Instalacja i konfiguracja</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="INSTALL-INTRO"
>2.1. Wstêp</A
></H2
><P
>LMS sk³ada siê z kilku modu³ów, podstawowym modu³em jest <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> 
	(interfejs u¿ytkownika). Jest on w ca³o¶ci napisany w PHP i do pracy wymaga bazy danych 
	(w³a¶ciwie to ka¿dy modu³ wymaga bazy danych). To w³a¶nie w <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> wykonujemy wszystkie 
	czynno¶ci, reszta modu³ów ma tylko za zadanie zautomatyzowaæ pracê LMS.</P
><P
>LMS to tak¿e zestaw skryptów w jêzyku Perl, i to w³a¶nie te skrypty wymagaj± 
	aby¶ posiada³ interpreter tego jêzyka. Je¶li bêdziesz chcia³ u¿ywaæ tych skryptów, 
	musisz mieæ Perl'a. Skrypty pozwalaj± m.in. na comiesiêczne naliczanie op³at abonamentowych 
	b±d¼ wysy³anie upomnieñ. Najwiêkszy z nich - <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
> jest skryptem, ale na tyle 
	uniwersalnym ¿e potrafi wygenerowaæ praktycznie dowolny plik konfiguracyjny i zrestartowaæ 
	us³ugê na twoim serwerze.</P
><P
>Jest jeszcze <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>A.L.E.C's LMS Daemon</I
></SPAN
>, napisany w jêzyku C. Jest on przeznaczony 
	(a w³a¶ciwie jego wtyczki) do generowania plików konfiguracyjnych i restartowania us³ug. 
	Mo¿na go stosowaæ jako zamiennik lub uzupe³nienie skryptów perlowych.
	Odpowiada on za to, aby to co zosta³o zmienione w <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> zosta³o zmienione tak¿e 
	w rzeczywisto¶ci.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-REQUIREMENTS"
>2.2. Wymagania</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-WWW"
>2.2.1. Serwer WWW</A
></H3
><P
>Poniewa¿ <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> jest napisane w PHP, niezbêdny jest serwer WWW z interpreterem 
		tego jêzyka. Preferowanym serwerem jest Apache 
		(<A
HREF="http://www.apache.org"
TARGET="_top"
>www.apache.org</A
>).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-PHP"
>2.2.2. Interpreter PHP</A
></H3
><P
>Interpreter powinien byæ w wersji 4.2.x lub nowszej, chocia¿ dzia³a te¿ 
		poprawnie na 4.1.x (ale poniewa¿ developerzy pracuj± na 4.2.3, nie mo¿na 
		zagwarantowaæ poprawnej pracy na starszych wersjach (unikaæ wersji 4.2.2). PHP mo¿na ¶ci±gn±æ ze 
		strony <A
HREF="http://www.php.net"
TARGET="_top"
>www.php.net</A
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-DB"
>2.2.3. Serwer baz danych</A
></H3
><P
>LMS nie bêdzie dzia³a³ prawid³owo na wersjach MySQL starszych od 3.23.xx.</P
><P
>LMS wspó³pracuje tak¿e z PostgreSQL w wersji 7.3.x lub nowszych.</P
><P
>Przy wspó³pracy LMS'a z baz± danych SQLite nie stwierdzono ¿adnych
	      problemów z tym, ¿e jedyn± przetestowan± wersj± jest wersja 2.8.11.</P
><P
>W celach eksperymentalnych/poznawczych wprowadzono mo¿liwo¶æ uruchomienia
	      interfejsu u¿ytkownika na bazie danych MS SQL Server 2000.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-SMARTY"
>2.2.4. Biblioteka Smarty</A
></H3
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> do pracy wymaga jeszcze biblioteki Smarty (<A
HREF="http://smarty.php.net"
TARGET="_top"
>http://smarty.php.net</A
>)
		 w wersji 2.5.0 lub wy¿szej (unikaæ wersji 2.6.4).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-PERL"
>2.2.5. Perl</A
></H3
><P
>O ile dla <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> wystarczy to co powy¿ej, to ¿eby mieæ dzia³aj±cy 
		<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
> i resztê skryptów potrzebujemy 
		tak¿e Perla i modu³y do niego, które mo¿na pobraæ z <A
HREF="http://www.cpan.org"
TARGET="_top"
>www.cpan.org</A
>,
		czyli:
	  <UL
><LI
><P
>perl w³a¶ciwy i jego podstawowe modu³y (POSIX, GetOpt::Long);</P
></LI
><LI
><P
>Net::SMTP;</P
></LI
><LI
><P
>Config::IniFiles;</P
></LI
><LI
><P
>DBI;</P
></LI
><LI
><P
>DBD-mysql (Je¶li masz zamiar u¿ywaæ mysql'a);</P
></LI
><LI
><P
>DBD-Pg (Je¶li masz zamiar u¿ywaæ postgres'a);</P
></LI
><LI
><P
>DBD-SQLite (Je¶li masz zamiar u¿ywaæ bazê SQLite);</P
></LI
></UL
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-C"
>2.2.6. Kompilator jêzyka C</A
></H3
><P
>Je¶li chcesz uruchomiæ <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>A.L.E.C's LMS Daemon</I
></SPAN
> bêdziesz potrzebowa³
	  dzia³aj±cy kompilator jêzyka C, gdy¿ jest on dostarczany wy³±cznie w postaci
	  kodu ¼ród³owego.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-INSTALL"
>2.3. Instalacja LMS</A
></H2
><P
>LMS w postaci archiwum tar.gz mo¿na pobraæ ze strony 
		domowej projektu (<A
HREF="http://www.lms.rulez.pl"
TARGET="_top"
>www.lms.rulez.pl</A
>),
		a nastêpnie rozpakowaæ i umie¶ciæ w wybranym katalogu (np. <TT
CLASS="FILENAME"
>/var/www/lms
		</TT
>) dostêpnym dla serwera www:
<PRE
CLASS="SCREEN"
>$ cd /var/www
$ wget http://lms.rulez.pl/download/stable/lms-x.x.x.tar.gz
$ tar zxf lms-x.x.x.tar.gz</PRE
>
		</P
><P
>Dostêpne s± dwa rodzaje paczek z LMS - zawieraj±ce bibliotekê
		Smarty (<TT
CLASS="FILENAME"
>lms-x.x.x+libs.tar.gz</TT
>) i bez niej. 
		Je¿eli nie skorzysta³e¶ z wersji archiwum zawieraj±cej biblioteki,	
		pobierz j± i umie¶æ w katalogu <TT
CLASS="FILENAME"
>lib</TT
>.
<PRE
CLASS="SCREEN"
>$ cd /var/www/lms/lib
$ wget http://smarty.php.net/distributions/Smarty-2.6.0.tar.gz
$ tar zxf Smarty-2.6.0.tar.gz
$ mv Smarty-2.6.0/libs Smarty</PRE
>
		</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Po³o¿enie wszystkich katalogów mo¿esz zmieniæ w sekcji
		<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[directories]</I
></SPAN
> pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>Pliki z konfiguracj± (<TT
CLASS="FILENAME"
>sample/lms.ini</TT
> i <TT
CLASS="FILENAME"
>		sample/lms-mgc.ini</TT
>) umie¶æ w katalogu <TT
CLASS="FILENAME"
>/etc/lms</TT
>.
		</P
><P
>Skrypty wykonywalne z katalogu <TT
CLASS="FILENAME"
>bin</TT
> 
		najlepiej przenie¶æ do katalogu <TT
CLASS="FILENAME"
>/usr/sbin</TT
>.
		</P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Serwer www musi mieæ prawo odczytu pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>
		oraz prawa odczytu i zapisu do katalogu <TT
CLASS="FILENAME"
>backup</TT
>. 
		Stanowi to potencjalne obni¿enie poziomu bezpieczeñstwa systemu.
		</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-DB"
>2.4. Instalacja serwera baz danych</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="INSTALL-MYSQL"
>2.4.1. MySQL</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-INTRO"
>2.4.1.1. Wstêp</A
></H4
><P
>Ta  bardzo  popularna  baza  jest  dostêpna  z wiêkszo¶ci± dystrybucji
			Linuksa.  Je¿eli  jednak bêdziesz musia³ j± zainstalowaæ samodzielnie,
			zacznij od ¶ci±gniêcia ¼róde³ z <A
HREF="http://www.mysql.org"
TARGET="_top"
>			www.mysql.org</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-SERVER"
>2.4.1.2. Instalacja serwera MySQL</A
></H4
><P
>Po rozpakowaniu, wejd¼ do katalogu z naszym MySQL i wydaj kolejno
			polecenia:
			<PRE
CLASS="SCREEN"
>$ ./configure --prefix=/usr/local/mysql
$ make
$ make install
$ /usr/local/mysql/bin/mysql_install_db
$ chown mysql -R /usr/local/mysql/var
$ /usr/local/mysql/bin/safe_mysqld &#38;
$ /usr/local/mysql/bin/mysqladmin -u root password nowe_has³o</PRE
>
		</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-DBCREATE"
>2.4.1.3. Utworzenie bazy danych</A
></H4
><P
>Konieczne  to  jest  je¿eli  uruchamiasz  LMS  po raz PIERWSZY. Je¿eli
			uaktualniasz LMS z poprzedniej wersji, odpowiednie adnotacje co nale¿y zrobiæ z baz± danych
			s± w pliku ChangeLog. Tak wiêc, wejd¼ do katalogu w którym masz LMS'a
			i uruchom shell mysql'a:
			<PRE
CLASS="SCREEN"
>mysql -u[tutaj wpisz u¿ytkownika z pe³nym dostêpem do bazy] -p
Enter password:[podaj has³o]
mysql&#62; create database lms;
mysql&#62; grant usage on lms.* to lms@localhost;
mysql&#62; grant select,insert,update,delete,create,alter on lms.* to lms@localhost identified by 'haslo';
mysql&#62; flush privileges;
mysql&#62; use lms;
mysql&#62; source doc/lms.mysql;</PRE
>
		</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-LMS"
>2.4.1.4. Konfiguracja LMS (lms.ini)</A
></H4
><P
>Poniewa¿  MySQL  jest  domy¶ln± baz± dla LMS'u, konfiguracja ogranicza
			siê  do  podania  w  sekcji  [database] pliku /etc/lms/lms.ini has³a i u¿ytkownika:
			<PRE
CLASS="SCREEN"
>user     = lms
password = has³o_z_pkt.3</PRE
>
		    </P
><P
>Po  takim  zabiegu,  o ile LMS'owi uda siê nawi±zaæ po³±czenie do bazy
			danych,  mo¿na ju¿ bez problemu dostaæ siê do systemu. Je¿eli jednak w
			bazie  danych  nie ma ¿adnego konta administratora, jedyn± rzecz± jak±
			zobaczysz bêdzie  formularz  dodania  administratora.  Je¿eli
			podasz  prawid³owe  dane  administratora, LMS przeniesie Ciê na stronê
			logowania gdzie od razu bêdziesz móg³ u¿yæ nowo utworzonego konta.
			</P
><P
>Zatrzymaj siê tutaj i dodaj co¶ do crona, tak dla ¶wiêtego spokoju:
			<PRE
CLASS="SCREEN"
>12 4 3,10,17,21,28 * * /usr/bin/mysqldump -u lms --password=Twoje-super-tajne-has³o \
		    --add-drop-table --add-locks lms &#62; backups/lms-auto-"$(date +%s)".sql</PRE
>
			</P
><P
>Spowoduje to wykonywanie o 4:12 rano, ka¿dego 3, 10, 17, 21 i 28 dnia
			miesi±ca automagicznie zrzutu danych z mysqla.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-PGSQL"
>2.4.2. PostgreSQL</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-INTRO"
>2.4.2.1. Wstêp</A
></H4
><P
>LMS jest testowany na PostgreSQL 7.3.4 i nowszych, ale poniewa¿ ¿adne
			skomplikowane w³a¶ciwo¶ci tej bazy nie s± wykorzystywane, nie powinno
			byæ problemów z innymi wersjami. Je¿eli nie masz zainstalowanego serwera
			PostgreSQL, najlepszym rozwi±zaniem bêdzie w³asnorêczna kompilacja
			ze ¼róde³ dostêpnych na stronie <A
HREF="http://www.postgresql.org"
TARGET="_top"
>			www.postgresql.org</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-SERVER"
>2.4.2.2. Instalacja</A
></H4
><P
>Jest to wersja skrócona instalacji, wiêcej informacji znajdziesz
			w dokumentacji postgresa. Po ¶ci±gniêciu i rozpakowaniu wejd¼
			do katalogu g³ównego i wpisz kolejno poni¿sze polecenia.
			<PRE
CLASS="SCREEN"
>$ ./configure --enable-locale
$ gmake
$ su
$ gmake install
$ adduser postgres
$ mkdir /usr/local/pgsql/data
$ chown postgres /usr/local/pgsql/data
$ su - postgres
$ /usr/local/pgsql/bin/initdb -D /usr/local/pgsql/data
$ /usr/local/pgsql/bin/postmaster -D /usr/local/pgsql/data &#62;logfile 2&#62;&#38;1 &#38;</PRE
>
			</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-DBCREATE"
>2.4.2.3. Utworzenie bazy danych</A
></H4
><P
>Maj±c uruchomiony serwer mo¿esz przyst±piæ do tworzenia bazy o nazwie 'lms',
			której w³a¶cicielem bêdzie u¿ytkownik z loginem 'lms'. 
			<PRE
CLASS="SCREEN"
>$ /usr/local/pgsql/bin/createuser -d -A -P lms
$ /usr/local/pgsql/bin/createdb -E LATIN2 -U lms lms
$ /usr/local/pgsql/bin/psql -d lms -U lms -f /lms/doc/lms.pgsql</PRE
>
		</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-LMS"
>2.4.2.4. Konfiguracja LMS (lms.ini)</A
></H4
><P
>Dla systemu LMS domy¶lnym serwerem baz danych jest MySQL, dlatego w sekcji
			[database] pliku /etc/lms/lms.ini nale¿y ustawiæ nastêpuj±ce opcje:
   			<PRE
CLASS="SCREEN"
>type     = postgres
user     = lms
password = has³o_podane_przy_tworzeniu_u¿ytkownika_lms</PRE
>
		    </P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Has³o jest wymagane w zale¿no¶ci od konfiguracji autentykacji
       			u¿ytkowników postgresa w <TT
CLASS="FILENAME"
>/usr/local/pgsql/data/pg_hba.conf</TT
>. 
       			Domy¶lnie has³o nie jest wymagane.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>Po takim zabiegu, o ile LMS'owi uda siê nawi±zaæ po³±czenie do bazy danych,
			mo¿na ju¿ bez problemu dostaæ siê do systemu. Je¿eli jednak w bazie danych
			nie ma ¿adnego konta administratora, jedyn± rzecz± jak± zobaczysz
			bêdzie formularz dodania administratora.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-SQLITE"
>2.4.3. SQLite</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-INTRO"
>2.4.3.1. Wstêp</A
></H4
><P
>Ta jednoplikowa baza jest chwalona za swoj± szybko¶æ, wg autorów
			okre¶lan± na 2-3 krotnie szybsz± od MySQL. Poza tym przy odpowiedniej 
			konfiguracji umo¿liwia wczytanie ca³ej bazy do pamiêci RAM przez co osi±gany jest
			znaczny wzrost wydajno¶ci. Poni¿ej przedstawiono krótki opis instalacji.
			¬ród³a mo¿na pobraæ z <A
HREF="http://www.sqlite.org"
TARGET="_top"
>			www.sqlite.org</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-SERVER"
>2.4.3.2. Instalacja SQLite</A
></H4
><P
>Opisano tutaj sposób instalacji bibliotek SQLite oraz 
			dodanie obs³ugi tej bazy do PHP (PHP w wersji 5.0 ma wbudowan±
			obs³ugê SQLite). Po rozpakowaniu ¼róde³, wejd¼ do katalogu z SQLite 
			i wydaj kolejno polecenia (¶cie¿ki przyk³adowe):
			<PRE
CLASS="SCREEN"
>$ ./configure
$ make
$ make install
$ ldconfig
$ pear download http://pecl.php.net/get/SQLite-1.0.2.tgz
$ pear install SQLite-1.0.2.tgz</PRE
>
			Nastêpnie w pliku php.ini ustaw:
			<PRE
CLASS="SCREEN"
>extension=sqlite.so</PRE
>
			Istnieje równie¿ mo¿liwo¶æ wkompilowania obs³ugi SQLite
			w PHP przy pomocy opcji <SAMP
CLASS="PROMPT"
>--with-sqlite</SAMP
>.
			</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-DBCREATE"
>2.4.3.3. Utworzenie bazy danych</A
></H4
><P
>Konieczne  to  jest  je¿eli  uruchamiasz  LMS  po raz PIERWSZY. 
			Tak wiêc, wejd¼ do katalogu w którym masz LMS'a	i uruchom shell sqlite'a:
			<PRE
CLASS="SCREEN"
>$ sqlite -init doc/lms.sqlite /usr/local/lms/lms.db
sqlite&#62; .exit
$ chown 99.98 /usr/local/lms/lms</PRE
>
			</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-LMS"
>2.4.3.4. Konfiguracja LMS (lms.ini)</A
></H4
><P
>Jednym z ograniczeñ SQLite jest brak autentykacji u¿ytkowników, dlatego
			konfiguracja ogranicza siê do podania typu oraz ¶cie¿ki do pliku bazy. W sekcji
			[database] pliku /etc/lms/lms.ini podajemy:
			<PRE
CLASS="SCREEN"
>type     = sqlite
database = /usr/local/lms/lms.db</PRE
>
		    </P
><P
>Po  takim  zabiegu, mo¿na ju¿ bez problemu dostaæ siê do systemu. Je¿eli jednak w
			bazie danych nie ma ¿adnego konta administratora, jedyn± rzecz± jak±
			zobaczysz bêdzie formularz dodania administratora.  
			</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-MSSQL"
>2.4.4. MS SQL Server</A
></H3
><P
>LMS na bazie Microsoftu? Czemu nie. W celach poznawczych
			i eksperymentalnych dodano mo¿liwo¶æ pod³aczenia LMSa do tej bazy.
			Nie nale¿y jednak liczyæ na jakikolwiek support z tym zwi±zany, ale
			traktowaæ to raczej jako ciekawostkê. Nie mo¿na tak¿e zagwarantowaæ
			¿e pomys³ bêdzie rozwijany. Niemniej ze wstêpnych testów
			przy u¿yciu MS SQL Server 2000 wynika, ¿e jest to mo¿liwe.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-CONFIG"
>2.5. Konfiguracja podstawowa</A
></H2
><P
>G³ównym plikiem konfiguracyjnym LMS jest <TT
CLASS="FILENAME"
>lms.ini</TT
>,
	    który nale¿y umie¶ciæ w katalogu <TT
CLASS="FILENAME"
>/etc/lms</TT
> lub w katalogu
	    g³ównym LMS'a. Zawiera on zmienne konfiguracyjne <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> 
	    oraz wszystkich skryptów wykonywalnych z wyj±tkiem <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
>.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Pamiêtaj o usuniêciu ¶redników na pocz±tku linii z ustawianym 
	    parametrem konfiguracyjnym.</P
></TD
></TR
></TABLE
></DIV
></P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-CONFIG-DB"
>2.5.1. Sekcja [database] - ustawienia bazy danych</A
></H3
><P
>	    <UL
><LI
><P
>type</P
><P
>Typ bazy danych. Aktualnie w 100% supportowany jest 'mysql', ale jak na razie nie 
	   widaæ wiêkszych problemów z 'postgres' i 'sqlite'. Domy¶lnie: mysql</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>type = mysql</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Host gdzie zainstalowana jest baza danych. Najczê¶ciej, localhost, ale mo¿na tutaj 
	   wstawiæ cokolwiek (ip, domena, ¶cie¿ka do gniazda w formacie '/path/to/socket'). 
	   Domy¶lnie: localhost</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>host = localhost</SAMP
></P
></LI
><LI
><P
>user</P
><P
>U¿ytkownik do bazy danych. W wielu wypadkach (je¿eli postêpowa³e¶ zgodnie ze 
	   wskazówkami w dokumentacji) bêdzie to 'lms'. Je¿eli chcesz u¿ywaæ konta uprzywilejowanego, 
	   prawdopodobnie wpiszesz 'root' (MySQL na wiêkszo¶ci *nixów), 'mysql' (na PLD) b±d¼ 
	   'postgres' (PostgreSQL). Domy¶lnie: mysql</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>user = lms</SAMP
></P
></LI
><LI
><P
>password</P
><P
>Has³o do bazy danych. Domy¶lnie puste.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>password = password</SAMP
></P
></LI
><LI
><P
>database</P
><P
>Nazwa bazy danych (a w przypadku SQLite ¶cie¿ka do pliku bazy), domy¶lnie lms.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>database = lms</SAMP
></P
></LI
></UL
>
	</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-CONFIG-DIR"
>2.5.2. Sekcja [directories] - ustawienia katalogów</A
></H3
><P
>        
	<UL
><LI
><P
>sys_dir</P
><P
>Katalog systemowy. Jest to miejsce gdzie jest ca³a zawarto¶æ UI LMS'a, czyli index.php, grafiki, 
	   templejty i reszta. Domy¶lnie, index.php stara siê sam odnale¼æ w filesystemie u¿ywaj±c getcwd(), ale 
	   lepiej by by³o gdyby mu powiedzieæ gdzie jest:</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>sys_dir = /var/www/htdocs/lms/</SAMP
></P
></LI
><LI
><P
>modules_dir</P
><P
>Katalog z "modu³ami" LMS'a. Czyli zawarto¶æ katalogu modules. Domy¶lnie jest to podkatalog 
	   modules w sys_dir.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>modules_dir = /usr/share/lms/modules/</SAMP
></P
></LI
><LI
><P
>lib_dir</P
><P
>Katalog z "bibliotekami" LMS'a. Czyli zawarto¶æ katalogu lib. Domy¶lnie to podkatalog lib w sys_dir.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>lib_dir = /usr/share/lms/lib/</SAMP
></P
></LI
><LI
><P
>backup_dir</P
><P
>Katalog z kopiami zapasowymi bazy danych - miejsce gdzie LMS zapisuje zrzuty z bazy. 
	   Domy¶lnie jest to podkatalog 'backups'.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>backup_dir = /var/backup/lms/</SAMP
></P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Je¶li katalog z kopiami zapasowymi bêdzie osi±galny z poziomu WWW, to ka¿dy 
	   bez autoryzacji bêdzie mia³ do nich dostêp.</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>smarty_dir</P
><P
>Katalog z bibliotek± Smarty - domy¶lnie podkatalog Smarty w lib_dir.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>smarty_dir = /usr/lib/php/Smarty</SAMP
></P
></LI
><LI
><P
>smarty_compile_dir</P
><P
>Katalog kompilacji Smartyego. Miejsce gdzie Smarty kompiluje szablony. Domy¶lnie to 
	   <TT
CLASS="FILENAME"
>templates_c</TT
> w katalogu sysdir.</P
><P
>Przyk³ad: 	<SAMP
CLASS="PROMPT"
>smarty_compile_dir = /var/smarty/compile/lms</SAMP
></P
></LI
><LI
><P
>smarty_templates_dir</P
><P
>Katalog z szablonami którymi Smartiego. Domy¶lnie to podkatalog templates z sys_dir'a.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>smarty_templates_dir = /usr/share/lms/templates</SAMP
></P
></LI
></UL
>
	</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-CONFIG-UI"
>2.5.3. Sekcja [phpui] - ustawienia interfejsu</A
></H3
><UL
><LI
><P
>allow_from  (opcjonalny)</P
><P
>Lista sieci i adresów IP które maj± dostêp do LMS. Je¿eli puste, ka¿dy adres IP ma dostêp do LMS'a, 
	je¿eli wpiszemy tutaj listê adresów b±d¼ klas adresowych, LMS odrzuci b³êdem HTTP 403 ka¿dego 
	niechcianego u¿ytkownika.</P
><P
>Przyk³ad:		<SAMP
CLASS="PROMPT"
>allow_from = 192.168.0.0/16, 213.25.209.224/27, 213.241.77.29</SAMP
></P
></LI
><LI
><P
>timeout</P
><P
>Timeout sesji www. Po tym czasie (w sekundach) u¿ytkownik zostanie wylogowany je¿eli nie 
    podejmie ¿adnej akcji. Domy¶lnie 600 sekund.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>timeout = 900</SAMP
></P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Nie ma mo¿liwo¶ci ustawienia braku timeoutu. Je¿eli ustawisz t± warto¶æ na zero, nie 
    bêdziesz móg³ korzystaæ z LMS!</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>userlist_pagelimit</P
><P
>Limit wy¶wietlanych pozycji na stronie w li¶cie u¿ytkowników. Domy¶lnie brak limitu.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>userlist_pagelimit = 10</SAMP
></P
></LI
><LI
><P
>nodelist_pagelimit</P
><P
>Limit wy¶wietlanych pozycji na stronie w li¶cie komputerów. Domy¶lnie brak limitu.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>nodelist_pagelimit = 10</SAMP
></P
></LI
><LI
><P
>balancelist_pagelimit</P
><P
>Limit wy¶wietlanych pozycji na stronie na rachunku u¿ytkownika. Domy¶lnie: 100.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>balancelist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>invoicelist_pagelimit</P
><P
>Limit wy¶wietlanych pozycji na stronie w li¶cie faktur. Domy¶lnie: 100</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>invoicelist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>ticketlist_pagelimit</P
><P
>Limit wy¶wietlanych pozycji na stronie w li¶cie zg³oszeñ. Domy¶lnie: 100</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>ticketlist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>networkhosts_pagelimit</P
><P
>Ilo¶æ komputerów wy¶wietlanych na jednej stronie w informacjach 
    o sieci. Domy¶lnie: 256.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networkhosts_pagelimit = 1024</SAMP
></P
></LI
><LI
><P
>accountlist_pagelimit</P
><P
>Limit wy¶wietlanych pozycji na stronie w li¶cie kont. Domy¶lnie: 100.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>accountlist_pagelimit = 25</SAMP
></P
></LI
><LI
><P
>reload_type</P
><P
>Typ reloadu. Dozwolone warto¶ci:</P
><P
>exec - wywo³ywanie jakiej¶ komendy (najczê¶ciej co¶ przez sudo, jaki¶ skrypt lub co¶, konfigurowalny
     poni¿ej)</P
><P
>sql  - zrobienie wpisów w SQL'u (te¿ mo¿na ustawiæ konkretne query SQL'a)</P
><P
>Domy¶lna warto¶æ to 'sql'.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>reload_type = exec</SAMP
></P
></LI
><LI
><P
>reload_execcmd</P
><P
>Komenda do wykonania podczas reloadu je¿eli reload_type jest ustawione na 'exec'. Domy¶lnie
    <TT
CLASS="FILENAME"
>/bin/true</TT
>. String ten puszczany do komendy system() wiêc proponujê rozwagê 
    i pomy¶lenie co siê robi i jak :) Generalnie ¶redniki powinny byæ parsowane przez bash'a, ale z paru 
    wzglêdów LMS sam dzieli poni¿szy ci±g pod wzglêdem ¶redników i wykonuje komendy pojedynczo.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>reload_execcmd = "sudo /usr/bin/reload_lms.sh"</SAMP
></P
></LI
><LI
><P
>reload_sqlquery</P
><P
>Zapytanie SQL wykonywane podczas reloadu, je¶li <SAMP
CLASS="PROMPT"
>reload_type = sql</SAMP
>.  
    Domy¶lnie zapytanie wrzuca do tabeli timestamps warto¶æ '_force'. W zapytaniu mo¿na u¿yæ 
    '%TIME%' jako podstawki pod aktualny timestamp unixowy. UWAGA! Znak ¶rednika jest 
    traktowany jako separator kwerend, tzn. oddzielaj±c znakiem ¶rednika mo¿esz wpisaæ kilka zapytañ SQL.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>reload_sqlquery = "INSERT INTO reload VALUES ('1','%TIME%')"</SAMP
></P
></LI
><LI
><P
>force_ssl</P
><P
>Wymuszanie SSL'a. Ustawienie tej zmiennej na 1 spowoduje ¿e LMS bêdzie wymusza³ po³±czenie 
    SSL powoduj±c redirect do 'https://'.$_SERVER[HTTP_HOST].$_SERVER[REQUEST_URI] przy ka¿dej 
    próbie dostêpu bez SSL. Domy¶lnie wy³±czone.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>force_ssl = 0</SAMP
></P
></LI
><LI
><P
>allow_mac_sharing</P
><P
>Przyzwolenie na dodawanie rekordów komputerów z adresami MAC ju¿ istniej±cymi (nie sprawdza 
    czy jaki¶ inny komputer posiada taki adres MAC). Domy¶lnie wy³±czone</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>allow_mac_sharing	= 1</SAMP
></P
></LI
><LI
><P
>smarty_debug</P
><P
>W³±czenie konsoli debugowej Smartyego, przydatne do ¶ledzenia warto¶ci przekazywanych z PHP 
    do Smartyego. Domy¶lnie wy³±czone.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>smarty_debug = 1</SAMP
></P
></LI
><LI
><P
>debug_email</P
><P
>Adres e-mail do debugowania - pod ten adres bêd± sz³y wiadomo¶ci wysy³ane z sekcji 'Mailing' LMS'a, 
    zamiast do w³a¶ciwych u¿ytkowników.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>debug_email = root@localhost</SAMP
></P
></LI
><LI
><P
>default_zip, default_city, default_address</P
><P
>Domy¶lny kod pocztowy, miasto, ulica, stosowane podczas wstawiania nowego
    u¿ytkownika. Przydatne gdy mamy do wpisania wielu u¿ytkowników z tej samej ulicy.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>default_zip = 39-300</SAMP
></P
></LI
><LI
><P
>use_current_payday</P
><P
>Okre¶la, czy ma byæ u¿yta aktualna data jako dzieñ zap³aty podczas
    przypisywania zobowi±zañ u¿ytkownikom. Domy¶lnie wy³±czone.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>use_current_payday = 1</SAMP
></P
></LI
><LI
><P
>lastonline_limit</P
><P
>Okre¶la czas (w sekundach), po którym komputer zostaje uznany za
    nieaktywny. Powinien odpowiadaæ czêstotliwo¶ci uruchamiania skryptu
    badaj±cego aktywno¶æ komputerów (np.lms-fping). Domy¶lnie: 600.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>lastonline_limit = 300</SAMP
></P
></LI
><LI
><P
>arpd_servers</P
><P
>Lista serwerów arpd do zczytywania MAC'adresów z odleg³ych sieci.
    Lista ta powinna zawieraæ wpisy w postaci adresIP[:port] oddzielone
    spacjami. Domy¶lnie pusta.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>arpd_servers = 192.168.1.1 192.168.2.1</SAMP
></P
></LI
><LI
><P
>helpdesk_backend_mode</P
><P
>W³±czenie tej opcji spowoduje, ¿e wszystkie wiadomo¶ci w systemie 
    helpdesk (oprócz tych skierowanych do zg³aszaj±cego) 
    bêd± wysy³ane do serwera pocztowego na adres odpowiedniej kolejki.
    Na serwerze tym powinien byæ uruchomiony skrypt lms-rtparser, który zajmie
    siê zapisem wiadomo¶ci do bazy danych. Domy¶lnie: wy³±czona.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>helpdesk_backend_mode = 1</SAMP
></P
></LI
><LI
><P
>contract_template</P
><P
>W³asny szablon umowy z u¿ytkownikiem. Mo¿na tak¿e dostosowaæ domy¶lny
    szablon. Domy¶lnie: contract.html.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>contract_template = "../my_templates/contract.html"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-RIGHTS"
>2.6. Prawa dostêpu</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="INSTALL-RIGHTS-IDEA"
>2.6.1. Idea</A
></H3
><P
>LMS  ma  mo¿liwo¶æ  zdefiniowania  do 256 regu³ dostêpu do systemu. Ka¿da z nich mo¿e
      zabraniaæ, b±d¼ pozwalaæ na dostêp do konkretnych modu³ów. Ka¿demu administratorowi mo¿na
      przydzieliæ dowoln± kombinacjê regu³ dostêpu.</P
><P
>Domy¶lnie zdefiniowanych jest osiem regu³ dostêpu. 
       <UL
><LI
><P
>pe³en dostêp</P
></LI
><LI
><P
>odczyt wszystkich danych</P
></LI
><LI
><P
>pod³±czanie i od³±czanie komputerów</P
></LI
><LI
><P
>manipulowanie finansami</P
></LI
><LI
><P
>prze³adowywanie konfiguracji</P
></LI
><LI
><P
>manipulowanie danymi u¿ytkowników</P
></LI
><LI
><P
>manipulowanie danymi komputerów</P
></LI
><LI
><P
>dostêp do statystyk</P
></LI
><LI
><P
>dostêp do korespondencji seryjnej</P
></LI
><LI
><P
>brak dostêpu do modyfikacji i zak³adania kont administratorów</P
></LI
><LI
><P
>zarz±dzanie Helpdeskiem (RT)</P
></LI
><LI
><P
>obs³uga Helpdesku (RT)</P
></LI
><LI
><P
>brak dostêpu</P
></LI
></UL
>
      Siedem z nich zezwala na dostêp do modu³ów oraz jedna zabrania. Modu³y do których 
      administrator ma zawsze dostêp to: welcome, copyrights,  logout, chpasswd (przy czym 
      chpasswd umo¿liwia tylko zmianê w³asnego has³a), dostêp do reszty jest zdefiniowany regu³ami.</P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Je¶li nie ustawimy administratorowi ¿adnej regu³y dostêpu, to LMS domy¶lnie
      przydzieli mu regu³kê 0, czyli pe³en dostêp.</P
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-RIGHTS-HOW"
>2.6.2. Jak to dzia³a?</A
></H3
><P
>Decyzja  czy  u¿ytkownik  ma prawo dostêpu do modu³u czy nie przebiega nastêpuj±co:
		<TABLE
BORDER="0"
><TBODY
><TR
><TD
>-  najpierw  sprawdzana  jest  lista  modu³ów, do których zawsze ma siê
		dostêp,</TD
></TR
><TR
><TD
>-  potem  nastêpuje sprawdzenie czy modu³ pasuje do regu³ w poszczególnych
		poziomach, do których administrator ma dostêp,</TD
></TR
><TR
><TD
>-  na  koñcu podejmowana jest decyzja czy u¿ytkownik ma uprawnienia by
		do  modu³u siê dobraæ. Je¿eli modu³ siê za³apa³ na którykolwiek poziom, który zabrania dostêpu,
		dostêp  zostanie  zabroniony  nawet  je¿eli administrator ma ustawiony poziom, który pozwala
		na dostêp do modu³u (np.  kto¶  ma  pe³ny  dostêp oraz brak dostêpu do modu³u dodawania
		komputerów,  nie  bêdzie  on  móg³ siê odwo³aæ do tego modu³u). Je¿eli modu³ pasuje do
		poziomu, który pozwala na dostêp do danego modu³u LMS zezwala na dalsz± pracê.
		Je¿eli natomiast modu³ siê nie "za³apa³" na ¿aden poziom równie¿ zostanie mu wy¶wietlony
		komunikat o braku dostêpu.</TD
></TR
></TBODY
></TABLE
>
		</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-UPGRADE"
>2.7. Upgrade</A
></H2
><P
>Uaktualnienie LMS'a przebiega w dwóch etapach. Najpierw utwórz
      katalog z plikami nowej wersji (nie zaleca siê nadpisywania starych plików
      nowymi), nastêpnie trzeba dokonaæ zmian w bazie.</P
><P
>Dla u³atwienia migracji danych w katalogu <TT
CLASS="FILENAME"
>/doc</TT
>
      przygotowano pliki <TT
CLASS="FILENAME"
>UPGRADE-1.0-1.5.mysql</TT
> i 
      <TT
CLASS="FILENAME"
>UPGRADE-1.0-1.5.pgsql</TT
> dla przej¶cia od wersji 1.0 do wersji 1.5
      oraz <TT
CLASS="FILENAME"
>UPGRADE-1.2-1.5.mysql</TT
> i <TT
CLASS="FILENAME"
>UPGRADE-1.2-1.5.pgsql
      </TT
> przy migracji od wersji 1.2 (oraz 1.3.0) do bie¿±cej. W nich znajdziesz krótki
      opis jak przeprowadziæ aktualizacjê w zale¿no¶ci od stosowanej bazy danych.
      W wersjach o numerze wy¿szym od 1.3.0 aktualizacja struktury bazy danych 
      nastêpuje automatycznie podczas pierwszego logowania.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>W wersjach wy¿szych od 1.0.x biblioteka ADOdb nie jest wymagana,
      mo¿na skasowaæ odpowiedni katalog z katalogu <TT
CLASS="FILENAME"
>/lib</TT
></P
></TD
></TR
></TABLE
></DIV
></P
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="USER"
></A
>Rozdzia&#322; 3. Interfejs U¿ytkownika (LMS-UI)</H1
><P
>LMS'owy Interfejs U¿ytkownika to panel administracyjny do tworzenia
  i zarz±dzania baz± u¿ytkowników i komputerów dostêpny za pomoc± przegl±darki
  internetowej. Umo¿liwia wprowadzanie danych komputerów,
  przypisanie ich do u¿ytkowników i sieci. Definiowanie op³at i zarz±dzanie finansami sieci,
  Szybkie wyszukiwanie danych o u¿ytkownikach i ich sprzêcie. Sporz±dzanie korespondencji
  seryjnej do u¿ytkowników, definiowanie praw dostêpu dla administratorów i ich hase³.
  Ponadto daje mo¿liwo¶æ przegl±dania statystyk wykorzystania ³±cza, a tak¿e
  tworzenia kopii bazy danych oraz zarz±dzania konfiguracj± us³ug na serwerze. 
  <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> posiada tak¿e wiele innych mo¿liwo¶ci, które w tym
  rozdziale zostan± opisane.</P
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="USER-LOGIN"
>3.1. Logowanie</A
></H2
><P
>Po wpisaniu w przegl±darce adresu do strony z lms'em, powita ciê
	ekran logowania. Musisz podaæ w³a¶ciwy login oraz has³o. Has³a w bazie
	danych przechowywane s± w formie zaszyfrowanej.</P
><P
>Je¿eli jest to twoje pierwsze logowanie i nie masz jeszcze
	za³o¿onego konta, zostaniesz przekierowany do modu³u tworzenia kont
	administratorów. W tym momencie bêdziesz mia³ tylko dostêp do tego
	jednego modu³u.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-ADMINISTRATION"
>3.2. Administracja</A
></H2
><P
>Po zalogowaniu do LMS'a znajdziesz siê w module (menu) administracji
	systemem LMS. Tutaj znajdziesz niezbêdne informacje o systemie. Bêdziesz
	móg³ zarz±dzaæ administratorami i tworzyæ/odtwarzaæ kopie bazy danych.</P
><P
>Z menu po lewej stronie wybierasz interesuj±cy ciê modu³. Mo¿esz równie¿
	dokonaæ zmiany has³a, wylogowaæ siê lub szybko przej¶æ do informacji o u¿ytkowniku i komputerze.
	W polach szybkiego wyszukiwania, oprócz id u¿ytkownika lub komputera, mo¿esz 
	podawaæ nazwisko, nazwê, fragment adresu, telefon, email, adres IP lub MAC. 
	W przypadku gdy w bazie znajduje siê wiêcej u¿ytkowników pasuj±cych do szukanych
	danych zostan± wy¶wietlone informacje tylko o jednym u¿ytkowniku lub komputerze.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ADMINISTRATION-INFO"
>3.2.1. Info</A
></H3
><P
>To panel na którym znajduj± siê podstawowe informacje na temat naszego 
	    systemu: wersja LMS i jego sk³adników, informacje o prawach autorskich, 
	    wersja j±dra i uptime serwera, dane statystyczne o u¿ytkownikach i komputerach,
	    bie¿±ce informacje o aktywno¶ci komputerów i stanie finansów sieci. 
	    Ponadto znajdziesz tu przydatne lms'owe linki.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ADMINISTRATION-ADMINS"
>3.2.2. Administratorzy</A
></H3
><P
>Panel 'Administratorzy' s³u¿y do zarz±dzania kontami administratorów, czyli osób
	    korzystaj±cych z LMS'a, zak³adania i przegl±dania ich kont, zmiany hase³ i definiowania 
	    praw dostêpu.</P
><P
> Prawa dostêpu zosta³y szczegó³owo opisane w rozdziale <A
HREF="#INSTALL-RIGHTS"
>Prawa dostêpu</A
>.</P
><P
>Po wybraniu menu 'Administratorzy' zobaczysz listê wszystkich administratorów
	    z informacj± o ostatnim logowaniu. Klikniêcie na pozycji z listy spowoduje wy¶wietlenie 
	    informacji szczegó³owych o danym koncie, w tym o zdefiniowanych prawach dostêpu. 
	    W ka¿dej chwili mo¿liwa jest zmiana danych i uprawnieñ za pomoc± przycisku 'Edytuj'. 
	    Aby za³o¿yæ nowe konto administratora skorzystaj z górnego menu 'Nowy administrator'.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ADMINISTRATION-NEWADMIN"
>3.2.3. Nowy administrator</A
></H3
><P
>Aby dodaæ nowe konto administratora nale¿y podaæ login oraz has³o, 
	    które nie mo¿e byæ puste. Podanie imienia, nazwiska i adresu poczty elektronicznej
	    nie jest wymagane. Poni¿ej mo¿na zaznaczyæ uprawnienia dostêpu do
	    systemu. Je¿eli wszystkie pola pozostawisz puste, administratorowi 
	    przypisany zostanie 'Pe³en dostêp'.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ADMINISTRATION-DB"
>3.2.4. Kopie zapasowe</A
></H3
><P
>Z panelu 'Kopie zapasowe' mo¿esz zarz±dzaæ kopiami awaryjnymi danych z bazy LMSa.
	    Kopia bazy to plik tekstowy zawieraj±cy zapytania SQL i dane z wszystkich tabel w bazie, zapisywany w
	    katalogu zdefiniowanym w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[directories]</I
></SPAN
> <TT
CLASS="FILENAME"
>lms.ini</TT
>
	    zmienn± <SAMP
CLASS="PROMPT"
>backup_dir</SAMP
>.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Domy¶lnie kopie zapisywane s± w katalogu <TT
CLASS="FILENAME"
>lms/backups</TT
>
	    dostêpnym przez przegl±darkê, dlatego dobrze by³o by przenie¶æ go w inne miejsce.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>Sporz±dzone kopie mo¿na w ka¿dej chwili przegl±daæ, usuwaæ lub zapisywaæ na lokalnym dysku.
	    Klikniêcie na ikonkê Odtwórz spowoduje wyczyszczenie bie¿±cej bazy danych i za³adowanie
	    do niej danych z wybranego pliku kopii. Tu¿ przed odtworzeniem tworzona jest kopia
	    aktualnej bazy danych.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-USERS"
>3.3. U¿ytkownicy</A
></H2
><P
>Tutaj zarz±dzasz danymi u¿ytkowników twojej sieci i ich finansami, ale tak¿e 
	ich komputerami. Mo¿esz na przyk³ad jednym klikniêciem od³±czyæ wszystkie 
	komputery u¿ytkownika.
	<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Do automatycznego od³±czania komputerów u¿ytkowników, których bilans jest poni¿ej zadanej warto¶ci
	s³u¿y skrypt lms-cutoff.</P
></TD
></TR
></TABLE
></DIV
></P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-LIST"
>3.3.1. Lista</A
></H3
><P
>Po wej¶ciu do panelu 'U¿ytkownicy' uka¿e siê lista u¿ytkowników,
	    któr± mo¿esz filtrowaæ wed³ug wybranych kryteriów (statusu, grupy lub sieci)
	    lub sortowaæ klikaj±c na nazwie kolumny. Na li¶cie ikona ¿arówki informuje
	    o statusie pod³±czenia komputerów u¿ytkownika, a ikona znaku drogowego
	    o statusie ostrze¿eñ. Klikniêcie na nich zmienia status na przeciwny w
	    stosunku do wszystkich komputerów danego u¿ytkownika. Gdy u¿ytkownik nie
	    posiada przypisanych ¿adnych komputerów ikony te zostan± zamienione znakiem
	    wykrzyknika.</P
><P
>U u¿ytkowników z saldem ujemnym pojawia siê link "Rozlicz", pozwalaj±cy na
	    zaksiêgowanie jednym klikniêciem wp³aty równowa¿±cej ujemne saldo.</P
><P
>Klikniêcie na wybranym u¿ytkowniku spowoduje przej¶cie do panelu
	    z informacjami szczegó³owymi o nim i przypisanych mu komputerach, taryfach oraz
	    operacjach finansowych. Tam te¿ mo¿esz modyfikowaæ dane u¿ytkownika, definiowaæ
	    op³aty abonamentowe i zaksiêgowaæ wp³atê lub obci±¿enie jego rachunku.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-NEW"
>3.3.2. Nowy</A
></H3
><P
>Dodaj±c nowego u¿ytkownika podajesz jego nazwisko/nazwê i dane teleadresowe
	    oraz status (pod³±czony/oczekuj±cy/zainteresowany).
	    <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Czêsto zg³aszane jest blêdne kapitalizowanie narodowych znaków diakrytycznych.
	    Odpowiedzialny za to jest serwer bazy danych i rozwi±zania nale¿y szukaæ w jego konfiguracji.</P
></TD
></TR
></TABLE
></DIV
>
	    </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-SEARCH"
>3.3.3. Szukaj</A
></H3
><P
>Mo¿liwe jest wyszukiwanie u¿ytkowników (tak¿e usuniêtych) wg zadanych kryteriów. Modu³ ten,
	    od pola szybkiego wyszukiwania z menu po lewej stronie, oprócz tego, ¿e jest bardziej rozbudowany 
	    i pozwala wyszukiwaæ wg wielu kryteriów, ró¿ni siê tak¿e tym, ¿e zwraca listê u¿ytkowników
	    spe³niaj±cych podane kryteria.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-GROUPS"
>3.3.4. Grupy</A
></H3
><P
>Tutaj zarz±dzasz grupami u¿ytkowników. Po klikniêciu menu 'Grupy'
	    uka¿e ci siê lista grup z podstawowymi informacjami o grupach. Klikaj±c 
	    na wybranej grupie przejdziesz do modu³u, w którym mo¿esz zmieniæ dane
	    tej sieci, przegl±daæ oraz przypisywaæ u¿ytkowników do grup.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-NEWGROPUP"
>3.3.5. Nowa grupa</A
></H3
><P
>Grupa powinna posiadaæ unikaln± nazwê, sk³adaj±c± siê z liter, cyfr, znaku
	    my¶lnika lub podkre¶lenia. Poniewa¿ grupy wykorzystywane s± w skryptach w nazwie
	    nie mo¿e byæ znaku spacji.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-WARNINGS"
>3.3.6. Ostrze¿enia</A
></H3
><P
>Tutaj mo¿na "hurtowo" przypisaæ tre¶æ wiadomo¶ci administracyjnej
	    u¿ytkownikom, których wybiera siê z listy w lewym oknie. Mo¿liwe jest
	    tak¿e w³±czenie lub wy³±czenie ostrze¿eñ wszystkim komputerom nale¿±cym
	    do wybranych u¿ytkowników.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-USERS-PRINTS"
>3.3.7. Wydruki</A
></H3
><P
>Zestaw modu³ów wy¶wietlaj±cych listy w formie przyjaznej dla drukarki
	    zawiera:
	    <UL
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Lista u¿ytkowników</I
></SPAN
> z wieloma filtrami i dowolnym sortowaniem,</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Raport wierzytelno¶ci</I
></SPAN
> u¿ytkownika(ów) na dany dzieñ,</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Bilans u¿ytkownika</I
></SPAN
> za wybrany okres</P
></LI
></UL
>
	    </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-NODES"
>3.4. Komputery</A
></H2
><P
>Panel ten s³u¿y do zarz±dzania komputerami i umo¿liwia: przegl±danie listy komputerów,
	wyszukiwanie, dodawanie nowych lub usuwanie ju¿	wpisanych do bazy komputerów, a tak¿e podgl±d 
	i zmianê informacji o nich.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NODES-LIST"
>3.4.1. Lista</A
></H3
><P
>Lista komputerów, ta która pokazuje siê po wej¶ciu do panelu 'Komputery'. 
	    obejmuje wszystkie komputery w bazie. Mo¿na j± sortowaæ klikaj±c na nazwie dowolnej 
	    kolumny. W ka¿dym wierszu, po prawej stronie znajduj± siê ikony s³u¿±ce kolejno do:
	    zmiany statusu komputera [Pod³±cz/Od³±cz], zmiany statusu ostrze¿enia [Ostrzegaj/Nie ostrzegaj],
	    usuniêcia z bazy [Usuñ], wywo³ania panelu edycyjnego [Edytuj] oraz wy¶wietlenia
	    informacji szczegó³owych na temat danego komputera [Info]. Do panelu informacyjnego,
	    który jest zintegrowany z panelem informacji o w³a¶cicielu komputera mo¿na tak¿e
	    przej¶æ klikaj±c na pod¶wietlonym wierszu.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NODES-NEW"
>3.4.2. Nowy</A
></H3
><P
>Tutaj dodaje siê nowe komputery do bazy danych. W tym celu definiujemy nazwê
	    komputera (sk³adaj±c± siê z liter, cyfr, znaku podkre¶lenia lub my¶lnika), jego w³a¶ciciela,
	    adres IP, adres MAC oraz status. Przy polach na adresy IP i MAC znajduj± siê linki
	    do paneli, w których mo¿na wybraæ dostêpny adres IP oraz znaleziony w sieci MAC.
	    Po wpisaniu danych naci¶nij "Zapisz". Przy wprowadzaniu danych dla wielu komputerów
	    wygodnie jest zaznaczyæ pole "Wywo³aj ponownie..."
	    <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Aby wyszukaæ komputery w swojej sieci
	    mo¿esz skorzystaæ z programu nbtscan. Je¶li jest on zainstalowany w systemie, po
	    naci¶niêciu 'Skanuj' zobaczysz listê znalezionych komputerów.</P
></TD
></TR
></TABLE
></DIV
>
	    <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Aby dodaæ komputer musisz mieæ sieæ i u¿ytkownika,
	    którym go przypiszesz.</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NODES-SEARCH"
>3.4.3. Szukaj</A
></H3
><P
>Wyszukiwanie komputerów wed³ug zadanych kryteriów. Mo¿esz podaæ 
	    ca³± lub fragment nazwy komputera oraz jego adresów IP i MAC.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NODES-WARNINGS"
>3.4.4. Ostrze¿enia</A
></H3
><P
>Tutaj definiuje siê tre¶æ wiadomo¶ci administracyjnych dla u¿ytkowników oraz
		w³±cza lub wy³±cza komputerom ostrze¿enia. Po lewej stronie znajduje siê lista, na
		której komputery z w³±czonym ostrze¿eniem zaznaczone s± kolorem czerwonym. Jesli chcesz
		tylko zmieniæ/przypisaæ u¿ytkownikom tre¶æ wiadomo¶ci administracyjnej, zaznacz odpowiednie
		komputery na li¶cie i pozostaw puste pola 'W³±cz ostrze¿enia' oraz 'Wy³±cz ostrze¿enia'.  </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NODES-PRINT"
>3.4.5. Wydruki</A
></H3
><P
>Wy¶wietlenie list komputerów, w formacie przyjaznym dla drukarki 
		z mo¿liwo¶ci± definiowania filtrów i sortowania podobnie jak na Li¶cie.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-NETDEVICES"
>3.5. Osprzêt sieciowy</A
></H2
><P
>W panelu przeznaczonym do ewidencji sprzêtu zarz±dzamy struktur± 
	sieci, urz±dzeniami typu swich, hub, router, serwer i po³±czeniami miêdzy
	nimi, a tak¿e przy³±czonymi do nich komputerami. Ka¿demu urzêdzeniu mo¿na przypisaæ 
	co najmniej jeden adres sieciowy.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NETDEVICES-LIST"
>3.5.1. Lista</A
></H3
><P
>Lista urz±dzeñ zawiera ich nazwy i symbole, po³o¿enie i opis, a ponadto 
		ilo¶æ dostêpnych portów. Lista mo¿e byæ sortowana wg dowolnego parametru/kolumny.
		Klikniêcie na wybranym urz±dzeniu spowoduje wy¶wietlenie informacji szczegó³owych 
		o nim, gdzie mo¿liwe jest definiowanie po³±czeñ urz±dzeñ i komputerów, adresów IP
		urz±dzenia oraz zamiana dwóch urz±dzeñ.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NETDEVICES-NEW"
>3.5.2. Nowe</A
></H3
><P
>Urz±dzenie sieciowe powinno posiadaæ unikaln± nazwê. Pozosta³e
		parametry tj. producent, model, nr seryjny, ilo¶æ portów, lokalizacja
		i opis s± opcjonalne.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NETDEVICES-MAP"
>3.5.3. Mapa</A
></H3
><P
>Generowanie graficznej mapy ca³ej sieci, na podstawie
		danych z bazy lms'a nastêpuje po wybraniu opcji menu 'Mapa'. Mo¿esz 
		zdefiniowaæ, które urz±dzenie jest nadrzêdne w stosunku do pozosta³ych.
		<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Do wygenerowania mapy potrzebna jest wbudowana w PHP obs³uga 
		biblioteki graficznej GD.</P
></TD
></TR
></TABLE
></DIV
>
		</P
><P
>Na mapie hosty wy³±czone oznaczone s± kolorem czarnym. Ikona z pytajnikiem
		oznacza, ¿e dany komputer nie by³ jeszcze skanowany/w³±czony. Aby skorzystaæ z 
		tej funkcjonalno¶ci nale¿y, korzystaj±c z crona, uruchamiaæ skrypt skanuj±cy.
		Na mapie komputer traktowany jest za w³±czony je¶li czas ostatniego pozytywnego
		skanowania nie jest starszy od zadanej warto¶ci (domy¶lnie 600 sekund).
		Parametr ten okre¶la siê przy pomocy opcji
		<TT
CLASS="FILENAME"
>lastonline_limit</TT
> w sekcji [phpui] pliku konfiguracyjnego.
		Powy¿sze odnosi siê równie¿ do urz±dzeñ z tym, ¿e status urz±dzenia okre¶la
		siê na podstawie statusu wszystkich jego adresów.
		Status komputerów jest tak¿e widoczny na li¶cie komputerów.
		<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Do badania aktywno¶ci hostów mo¿na wykorzystaæ skrypt lms-fping lub demona almsd.</P
></TD
></TR
></TABLE
></DIV
>
		</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-NETWORKS"
>3.6. Sieci IP</A
></H2
><P
>Tutaj definiujesz dane swojej sieci tj. klasê adresow±, domenê, DNS'y, bramê,
	zakres DHCP. Je¿eli LMS s³u¿y ci do zarz±dzania wieloma sieciami lub dzielisz jedn± sieæ 
	na podsieci, albo korzystasz z ró¿nych klas adresowych tutaj jest to mo¿liwe.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NETWORKS-LIST"
>3.6.1. Lista</A
></H3
><P
>Lista sieci oprócz podstawowych danych o sieciach zawiera podsumowanie ilo¶ci
	    adresów wolnych i przypisanych. Modyfikowanie w³a¶ciwo¶ci sieci nastêpuje w module 
	    dostêpnym po wybraniu sieci z listy lub bezpo¶rednio po klikniêciu ikony [Edytuj].</P
><P
>Podczas edycji danych sieci mo¿esz przegl±daæ listê komputerów z tej sieci, gdzie w 
	    miejscu adresu IP pojawia siê nazwa komputera/urz±dzenia, do którego mo¿esz przej¶æ 
	    klikaj±c na odpowiednim polu. Klikniêcie na polu z adresem IP przeniesie Ciê do modu³u
	    dodawania nowego komputera. Znajdziesz tu tak¿e dwa przydatne linki: <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>	    Porz±dkuj sieæ</I
></SPAN
> s³u¿±cy do przeadresowania komputerów, tak aby wyeliminowaæ 
	    luki w adresacji oraz <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Przeadresuj do sieci</I
></SPAN
> s³u¿±cy do przenoszenia wszystkich 
	    komputerów/urz±dzeñ z tej sieci do innej.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NETWORKS-NEW"
>3.6.2. Nowa sieæ</A
></H3
><P
>Definiuj±c now± sieæ musisz okre¶liæ jej unikaln± nazwê i klasê adresow±
	    podaj±c adres IP sieci i maskê. Pozosta³e dane s± opcjonalne.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-FINANCES"
>3.7. Taryfy i Finanse</A
></H2
><P
>Jest to w³a¶ciwie wiele modu³ów umo¿liwiaj±cych zarz±dzanie finansami sieci.
	Masz mo¿liwo¶æ definiowania taryf abonamentowych, op³at (zleceñ) sta³ych, ksiêgowania 
	operacji finansowych, przegl±dania bilansu i historii rachunku oraz sporz±dzania faktur
	i zestawieñ finansowych.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-TARIFFS-LIST"
>3.7.1. Lista taryf</A
></H3
><P
>Po wej¶ciu do panelu 'Taryfy i finanse' zobaczysz listê taryf zawieraj±c±
	    podstawowe informacje o nich. Klikaj±c wybran± taryfê na li¶cie zostaniesz
	    przeniesiony do modu³u 'Informacje o taryfie', gdzie mo¿esz edytowaæ jej parametry
	    lub zamieniaæ u¿ytkownikom taryfy. W polu 'ilo¶æ u¿ytkowników' podana jest liczba
	    u¿ytkowników, którym dana taryfa zosta³a przypisana oraz kolejno od lewej (w nawiasie) ca³kowita 
	    liczba przypisañ taryfy i liczba aktywnych przypisañ taryfy, uwzglêdniaj±ca okresy obowi±zywania.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-TARIFFS-NEW"
>3.7.2. Nowa taryfa</A
></H3
><P
>Definiuj±c now± taryfê musisz podaæ unikaln± nazwê, kwotê i stawkê podatku.
	    Przy czym "zw." w polu stawka podatku oznacza "zwolnienie z podatku".</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-PAYMENTS-LIST"
>3.7.3. Lista op³at</A
></H3
><P
>Lista op³at sta³ych ¶wiadczonych na rzecz innych podmiotów, oprócz elementów standardowych
	    zawiera ikonê [Nalicz], przy pomocy której mo¿na obci±¿yæ rachunek sieci. Automatycznym naliczaniem
	    op³at zajmuje siê skrypt 'lms-payments' lub odpowiedni modu³ demona almsd. Klikaj±c wybran± 
	    op³atê na li¶cie zostaniesz przeniesiony do modu³u 'Informacje o op³acie', gdzie mo¿esz 
	    edytowaæ jej parametry lub zaksiêgowaæ dan± op³atê w bazie operacji finansowych.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-PAYMENTS-NEW"
>3.7.4. Nowa op³ata</A
></H3
><P
>Nowej op³acie sta³ej przypisujesz unikaln± nazwê, wierzyciela oraz kwotê i dzieñ
	    naliczenia.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-BALANCE"
>3.7.5. Bilans finansowy</A
></H3
><P
>Historia operacji finansowych z podsumowaniem przychodu, rozchodu,
	    wp³at i zobowi±zañ u¿ytkowników. Ikona drukarki umo¿liwia wydruk faktury odpowiadaj±cej
	    danej pozycji z listy.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-NEWBALANCE"
>3.7.6. Nowa operacja</A
></H3
><P
>Wprowadzanie nowych operacji finansowych. Mo¿liwe jest
	    zaksiêgowanie tej samej wp³aty lub obci±¿enia wielu u¿ytkownikom równocze¶nie.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Do naliczania sta³ych op³at abonamentowych najlepiej wykorzystywaæ
	    skrypt lms-payments lub demona <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
>, które potrafi± ponadto
	    wystawiaæ faktury.</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-INVOICES-LIST"
>3.7.7. Lista faktur</A
></H3
><P
>Lista wystawionych faktur z mo¿liwo¶ci± wydruku wybranych faktur (ikona [Drukuj]) oraz rozliczenia
	    danej pozycji, czyli zaksiêgowania wp³aty (ikona [Rozlicz]).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-INVOICES-NEW"
>3.7.8. Nowa faktura</A
></H3
><P
>Rêczne wystawianie faktur dla wybranego u¿ytkownika.</P
><P
>LMS umo¿liwia wystawianie faktur automatycznie i rêcznie. Rêczne wystawienie dowolnej
		faktury jest mo¿liwe z menu 'Nowa faktura' w panelu 'Taryfy i finanse'. Automatyczne wystawianie faktur 
		wymaga w³±czenia tej opcji podczas przypisywania taryf u¿ytkownikom. W takim wypadku
		zapisem faktur do bazy zajmuje siê skrypt lms-payments lub demon <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
></P
><P
>Do poprawnego dzia³ania i tworzenia wydruków wymagane jest ustawienie podstawowych 
		opcji w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[invoices]</I
></SPAN
> <TT
CLASS="FILENAME"
>lms.ini</TT
>:
		<UL
><LI
><P
>number_template</P
><P
>Wzorzec numeru faktury. Dostêpne zmienne wzorca to: '%N' - numer kolejny w roku,
			'%M' - miesi±c wystawienia, '%Y' - rok wystawienia. Domy¶lnie: %N/LMS/%Y</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>number_template = %N/%Y</SAMP
></P
></LI
><LI
><P
>header</P
><P
>Dane sprzedawcy. Domy¶lnie: pusty. Mo¿na u¿yæ ci±gu "\n" aby oddzieliæ linie od siebie.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>header = "SuperNet ISP\nul.Nowa 15\n12-000 W±chock\n"</SAMP
></P
></LI
><LI
><P
>footer</P
><P
>Stopka faktury - np. dane sprzedawcy. Domy¶lnie: pusta. Stopka zostanie umieszczona na dole faktury, ma³± czcionk±. Podobnie jak i w przypadku opcji header, mo¿na u¿yæ ci±gu "\n" aby oddzieliæ linie od siebie.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>footer = "Blokowa Sieæ Komputerowa K-27 w Mielcu, tel.555-23-23, bla bla"</SAMP
></P
></LI
><LI
><P
>default_author</P
><P
>Domy¶lna osoba wystawiaj±ca fakturê. Domy¶lnie: puste</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>default_author = "specjalista d/s fakturowania"</SAMP
></P
></LI
></UL
>
		Ponadto dostêpne s± zmienne:
		<UL
><LI
><P
>cplace</P
><P
>Miejsce wystawienia faktury. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>cplace = Warszawa</SAMP
></P
></LI
><LI
><P
>template_file</P
><P
>Szablon faktury, który powinien znajdowaæ siê w
			katalogu <TT
CLASS="FILENAME"
>templates</TT
>. Domy¶lnie: invoice.html.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>template_file = invoice-mynet.html</SAMP
></P
></LI
><LI
><P
>content_type</P
><P
>Content-type dla faktury. Je¿eli wpiszesz tutaj 'application/octet-stream'
			to przegl±darka zechce wys³aæ plik do zapisania na dysku, zamiast go wy¶wietliæ.
			Przydatne je¶li u¿ywasz w³asnego templejta, który wygeneruje np.rtf'a lub xls'a.
			Domy¶lnie: 'text/html; charset=iso-8859-2'</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>content_type = application/octet-stream</SAMP
></P
></LI
><LI
><P
>attachment_name</P
><P
>Mo¿na podaæ nazwê pliku, jako który ma zostaæ zapisany gotowy
			wydruk. Domy¶lnie: pusta.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>attachment_name = faktura.xls</SAMP
></P
></LI
></UL
>
		</P
><P
>Wygenerowane faktury mo¿na obejrzeæ w dwojaki sposób: albo poprzez ikonkê drukarki 
		na wykazie bilansu finansowego (ogólnego b±d¼ pojedynczego u¿ytkownika), albo 
		poprzez 'Lista faktur' z menu 'Taryfy i finanse'. W przypadku listy faktur, mo¿liwe jest 
		tak¿e filtrowanie faktur do wydruku. Wynikowy dokument HTML zawiera orygina³y 
		i kopie, które s± oddzielone znacznikami podzia³u strony poprzez CSS. 
		Tak wiêc ka¿da nowoczesna przegl±darka zgodna z CSS powinna bezproblemowo drukowaæ 
		faktury ³adnie podzielone na strony. Funkcja ta by³a testowana na przegl±darkach 
		Microsoft Internet Explorer 6.0, Opera 7.02 oraz Mozilla 1.3.</P
><P
>			<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Praktycznie ka¿da przegl±darka internetowa ma mo¿liwo¶æ 
			konfiguracji wydruku, gdzie mo¿na wy³±czyæ funkcje takie jak drukowanie 
			stopki i nag³ówka, czy te¿ adresu na wydruku.</P
></TD
></TR
></TABLE
></DIV
>
			<DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>W bazie danych zapisywane s± kwoty brutto. </P
></TD
></TR
></TABLE
></DIV
>
		</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-FINANCES-PRINT"
>3.7.9. Wydruki</A
></H3
><P
>Wydruki zestawieñ finansowych obejmuj±:
	    <UL
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Bilans finansowy sieci</I
></SPAN
> obejmuj±cy operacje finansowe 
		    za dany okres z mo¿liwo¶ci± wybrania administratora.</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>£±czny przychód bezrachunkowy sieci</I
></SPAN
> w danym okresie.</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Raport wierzytelno¶ci</I
></SPAN
> na dany dzieñ, dla wszystkich lub 
		    wybranego u¿ytkownika.</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Rejestr sprzeda¿y</I
></SPAN
>, czyli zestawienie faktur na dany okres.</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Bilans u¿ytkownika</I
></SPAN
> na dany okres.</P
></LI
></UL
>
	    </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-ACCOUNTS"
>3.8. Konta</A
></H2
><P
>Zarz±dzanie kontami ró¿nych us³ug na serwerze jest teraz
	mo¿liwe. Funkcjonalno¶æ ta jest przeznaczona dla zaawansowanych 
	administratorów. Wymaga znajomo¶ci tych us³ug i ich konfiguracji
	w celu korzystania z bazy danych.</P
><P
>W LMSie mo¿na utworzyæ cztery rodzaje kont: shell (1), poczta (2),
	www (4), ftp (8). W nawiasach podano numeryczne wewnêtrzne oznaczenie
	typu konta w bazie. Konta mog± byæ wielotypowe. Przyk³adowo, je¶li 
	zdefiniujesz konto shell+poczta+ftp w bazie zostanie zapisana cyfra 11.
	Oznacza to, ¿e do rozpoznawania typu konta w warunkach WHERE zapytañ
	SQL nale¿y stosowaæ sumowanie binarne (jak na przyk³adach w dalszej
	czê¶ci rozdzia³u).</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ACCOUNTS-LIST"
>3.8.1. Lista</A
></H3
><P
>Na li¶cie przedstawione s± podstawowe informacje o kontach.
	    Mo¿liwe jest dowolne sortowanie listy poprzez klikniêcie nazwy
	    kolumny oraz filtrowanie wg zadanych kryteriów. Przej¶cie do edycji 
	    danych konta nastêpuje po wybraniu ikony [Edytuj]. Administrator ma 
	    tak¿e prawo do zmiany has³a.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ACCOUNTS-NEW"
>3.8.2. Nowe konto</A
></H3
><P
>Definiuj±c dane konto musisz podaæ unikalny login, has³o,
	    wybraæ typ konta oraz przypisaæ u¿ytkownika (lub utworzyæ tzw. konto
	    systemowe). Nazwa domeny oraz data wa¿no¶ci konta s± opcjonalne.
	    Pozostawienie pustego pola z dat± oznacza, ¿e konto nigdy nie
	    wygasa.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ACCOUNTS-EXAMPLES"
>3.8.3. Przyk³ady</A
></H3
><P
></P
><P
>Poni¿szy listing zawiera istotne fragmenty pliku konfiguracyjnego
	    demona proftpd (w wersji 1.2.10) umo¿liwiaj±cy przechowywanie danych
	    o kontach ftp w bazie LMSa. Przyk³ad zawiera konfiguracjê dla bazy
	    danych PostgreSQL, w komentarzach podano rozwi±zania dla MySQLa:
	    <DIV
CLASS="EXAMPLE"
><A
NAME="ACCOUNTS-E1"
></A
><P
><B
>Przyk&#322;ad 3-1. Konta. Konfiguracja proftpd.</B
></P
><PRE
CLASS="SCREEN"
>  ServerName	"LMS FTP Server"
  
  #nazwa_bazy@host:port u¿ytkownik has³o
  SQLConnectInfo lms@localhost:5432 lms mypassword
  
  SQLAuthTypes Crypt Plaintext
  SQLUserInfo passwd login password uid NULL home NULL
  RequireValidShell off
  SQLAuthenticate users
  
  # utworzenie katalogu domowego gdy nie istnieje
  SQLHomedirOnDemand on
  
  # komunikat przy logowaniu
  SQLShowInfo PASS "230" "Last login: %{getlastlogin}"
  SQLLog PASS setlastlogin
  
  # SQLNamedQuery getlastlogin SELECT "CASE lastlogin WHEN 0 THEN '' ELSE FROM_UNIXTIME(lastlogin) END FROM passwd WHERE login='%u'"
  # SQLNamedQuery setlastlogin UPDATE "lastlogin=UNIX_TIMESTAMP() WHERE login='%u'" passwd 
  SQLNamedQuery getlastlogin SELECT "CASE lastlogin WHEN 0 THEN '' ELSE lastlogin::abstime::timestamp::text END FROM passwd WHERE login='%u'"
  SQLNamedQuery setlastlogin UPDATE "lastlogin=EXTRACT(EPOCH FROM CURRENT_TIMESTAMP(0)) WHERE login='%u'" passwd
  
  # Sprawdzamy datê wa¿no¶ci konta oraz ograniczamy szukanie do kont ftp
  # SQLUserWhereClause "type &#38; 8 = 8 AND (expdate = 0 OR expdate &gt; UNIX_TIMESTAMP())"
  SQLUserWhereClause "type &#38; 8 = 8 AND (expdate = 0 OR expdate &gt; EXTRACT(EPOCH FROM CURRENT_TIMESTAMP(0)))"</PRE
></DIV
></P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-MAILING"
>3.9. Mailing</A
></H2
><P
>Mailing, czyli Korespondencja Seryjna umo¿liwia wysy³anie wiadomo¶ci do grupy
	u¿ytkowników twojej sieci. Podajesz dane nadawcy, tre¶æ wiadomo¶ci oraz wybierasz grupê
	odbiorców, do której zostanie wys³any e-mail. Grupê adresatów mo¿na okre¶liæ
	wg statusu oraz sieci lub grup u¿ytkowników do których nale¿±.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Serwer musi byæ odpowiednio skonfigurowany do u¿ycia funkcji mail().</P
></TD
></TR
></TABLE
></DIV
>
	<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Do automatycznego wysy³ania upomnieñ do u¿ytkowników zalegaj±cych z op³atami mo¿na
	wykorzystaæ skrypt lms-notify lub modu³y notify i ggnotify demona <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
>.</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-RELOAD"
>3.10. Prze³adowanie</A
></H2
><P
>Klikniêcie na menu 'Prze³adowanie' spowoduje prze³adowanie konfiguracji i us³ug zdefiniowanych
	dla generatora plików konfiguracyjnych <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
> lub demona <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
>. 
	Wiêcej informacji znajdziesz w rozdzia³ach dotycz±cych <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
> oraz demona.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-STATS"
>3.11. Statystyki</A
></H2
><P
>Interfejs do przegl±dania statystyk wykorzystania ³±cza w postaci prostych wykresów jest
	dostêpny w menu 'Statystyki'. Dane statystyk zawieraj± lo¶æ danych wysy³anych i pobieranych 
	z Internetu (na danym interfejsie) dla ka¿dego komputera. Korzystaj±c z górnego menu mo¿esz szybko wygenerowaæ statystyki z ostatniej 
	godziny, ostatniego dnia, ostatnich 30 dni lub ostatniego roku.</P
><P
> 
	    <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Zapisem danych do bazy zajmuje siê skrypt lms-traffic, albo demon <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
>.</P
></TD
></TR
></TABLE
></DIV
>
	</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-STATS-FILTER"
>3.11.1. Filtr</A
></H3
><P
>Przed wygenerowaniem wykresu mo¿esz zdefiniowaæ parametry
	    okre¶laj±ce okres jaki ma byæ brany pod uwagê, ograniczyæ do jednej sieci (je¶li masz 
	    ich wiêcej), ilo¶ci komputerów oraz posortowaæ odpowiednio wyniki (na przyk³ad 
	    wed³ug downloadu).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-STATS-COMPACT"
>3.11.2. Kompaktowanie</A
></H3
><P
>W zale¿no¶ci od wybranej przez u¿ytkownika czêstotliwo¶ci zapisu, mo¿e
	    nast±piæ szybki przyrost danych w bazie, co spowoduje zwiêkszenie czasu
	    oczekiwania na rysowanie wykresów. Z tego powodu w menu 'Kompaktowanie'
	    udostêpniono mo¿liwo¶æ zmniejszenia rozmiarów bazy statystyk bez
	    utraty danych. Wybieraj±c poziom dok³adno¶ci danych, dane zostan± u¶rednione
	    w nastêpuj±cy sposób:
		<UL
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Poziom Niski</I
></SPAN
>: dane z poprzedniego dnia i starsze, zostan± u¶rednione
			do jednego dnia, czyli je¶li do bazy zapisywane by³y z czêstotliwo¶ci± 10 minut,
			to 6*24 wpisów zostanie zast±pione jednym.</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Poziom ¦redni</I
></SPAN
>: dane starsze ni¿ miesi±c zostan± u¶rednione do
			jednego dnia.</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Poziom Wysoki</I
></SPAN
>: dane starsze ni¿ miesi±c zostan± u¶rednione do
			jednej godziny.</P
></LI
></UL
>
	    <DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Kompaktowanie bazy danych jest procesem nieodwracalnym.</P
></TD
></TR
></TABLE
></DIV
>
	    </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MENU-HELPDESK"
>3.12. Helpdesk</A
></H2
><P
>Helpdesk (inaczej Request Tracker) to system obs³ugi zg³oszeñ.
	    W systemie mo¿na prowadziæ bazê wszystkich zg³oszeñ i zapytañ u¿ytkowników
	    sieci, ale tak¿e osób które nie s± wpisane do bazy LMS'a. Zg³oszenia mo¿na
	    pogrupowaæ w kategorie (kolejki) i wyszukiwaæ wg zadanych kryteriów.
	    Do ka¿dej kolejki mo¿na zdefiniowaæ uprawnienia dla administratorów.
	    </P
><P
>W menu po lewej stronie znajduje siê pole szybkiego wyszukiwania
	    zg³oszenia, w którym mo¿na podawaæ jego ID lub nazwisko zg³aszaj±cego je
	    u¿ytkownika. W drugim przypadku zostanie wy¶wietlona lista wszystkich zg³oszeñ
	    danego u¿ytkownika.</P
><P
>Ka¿de zg³oszenie posiada historiê, na któr± sk³adaj± siê wiadomo¶ci
	    od administratorów i u¿ytkowników. Administrator mo¿e wys³aæ swoj± wiadomo¶æ do 
	    u¿ytkownika, klikaj±c 'Wy¶lij' podczas dodawania wiadomo¶ci. (Nale¿y podaæ
	    e-mail odbiorcy. Adresem nadawcy bêdzie adres kolejki, a je¶li jest pusty, adres 
	    administratora). Wszystkie wiadomo¶ci tak¿e te wys³ane, zostaj± zapisane 
	    w historii zg³oszenia. Zg³oszenie mo¿e mieæ cztery stany: nowy, otwarty, rozwi±zany 
	    i martwy.</P
><P
>Skrypt <A
HREF="#LMS-RTPARSER"
>lms-rtparser</A
> zosta³ stworzony aby umo¿liwiæ
	    obs³ugê systemu i przesy³anie zg³oszeñ poczt± elektroniczn±.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-HELPDESK-LIST"
>3.12.1. Lista kolejek</A
></H3
><P
>Na li¶cie kolejek znajduj± siê podstawowe informacje i statystyki zg³oszeñ.
	    Klikniêcie na wybranej kolejce powoduje wy¶wietlenie listy zg³oszeñ. St±d mo¿na
	    tak¿e przej¶æ do informacji szczegó³owych (w tym tak¿e uprawnieniach) o kolejce lub
	    usun±æ wybran± kolejkê. Usuniêcie kolejki spowoduje tak¿e usuniêcie zg³oszeñ z bazy
	    danych przypisanych do niej.
	    </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-HELPDESK-NEWQUEUE"
>3.12.2. Nowa kolejka</A
></H3
><P
>Kolejka (kategoria) posiada nazwê, opcjonalny opis oraz opcjonalny adres
	    poczty elektronicznej, który u¿ywany jest do korespondencji. W tabeli 'Uprawnienia'
	    definiuje siê prawa do danej kolejki, które maj± moc wiêksz± od ogólnych 
	    uprawnieñ administratorów tzn. je¶li admin nie ma praw do danej kolejki, to nawet
	    je¶li ma 'pe³ny dostêp' zg³oszeñ w tej kolejce nie zobaczy. Prawo zapisu (dodawanie/edytowanie
	    zg³oszeñ i wiadomo¶ci) oznacza automatyczne prawo do odczytu. 
	    </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-HELPDESK-SEARCH"
>3.12.3. Wyszukaj</A
></H3
><P
>Wyszukiwanie zg³oszeñ polega na wybraniu z bazy zg³oszeñ spe³niaj±cych 
	    wszystkie podane kryteria (warunek AND, nie OR). Mo¿esz podaæ temat, w³a¶ciciela, 
	    kolejkê, status i zg³aszaj±cego. Klientów sieci wybieraj z listy, dla pozosta³ych
	    nale¿y podaæ Nazwisko/Imiê i/lub e-mail.
	    </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MENU-HELPDESK-NEWTICKET"
>3.12.4. Nowe zg³oszenie</A
></H3
><P
>Dodaj±c nowe zg³oszenie nale¿y okre¶liæ dla niego temat, tre¶æ, wybraæ kolejkê
	    oraz zg³aszaj±cego u¿ytkownika. Osoby spoza sieci wpisujemy w polach Nazwisko i Imiê.
	    Opcjonalnie, je¶li wiadomo¶æ zosta³a zg³oszona poczt± elektroniczn± podajemy adres 
	    e-mail (tak¿e dla u¿ytkownika zapisanego w bazie).</P
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="SCRIPTS"
></A
>Rozdzia&#322; 4. Skrypty</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="SCRIPTS-INSTALL"
>4.1. Instalacja</A
></H2
><P
>Je¶li chcesz ustawiæ konfiguracjê którego¶ ze skryptów, robi siê to
	w odpowiedniej sekcji <TT
CLASS="FILENAME"
>lms.ini</TT
>. Same skrypty 
	przenie¶ z katalogu <TT
CLASS="FILENAME"
>/lms/bin/</TT
> do katalogu <TT
CLASS="FILENAME"
>/usr/sbin</TT
>. 
	Po przeniesieniu musisz je jeszcze dopisaæ do crontaba tak, aby by³y uruchamiane 
	automatycznie, w³a¶nie wtedy kiedy tego chcesz.</P
><P
>Przyk³adowo, wpis w crontabie dla skryptu lms-payments (wykonywanego
	codziennie o godzinie 00:01) powinien wygl±daæ nastêpuj±co:</P
><PRE
CLASS="SCREEN"
>1 0 * * *       /usr/sbin/lms-payments 1 &gt; /dev/null</PRE
><P
>Po wiêcej informacji mo¿esz siêgn±æ do <B
CLASS="COMMAND"
>man crontab</B
></P
><P
>Wiêkszo¶æ lms'owych skryptów posiada dodatkowe opcje uruchomieniowe:</P
><PRE
CLASS="SCREEN"
>-C plik     po³o¿enie i nazwa alternatywnego pliku lms.ini, domy¶lnie /etc/lms/lms.ini
-q          wykonanie skryptu bez wy¶wietlania komunikatów               
-h          pomoc (a w zasadzie to tylko listing opcji)
-v          informacja o wersji skryptu</PRE
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="SCRIPTS-LIST"
>4.2. Lista dostêpnych skryptów</A
></H2
><DIV
CLASS="TABLE"
><A
NAME="SCRIPTS-TABLE"
></A
><P
><B
>Tabela 4-1. Lista skryptów wykonywalnych</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="200"
ALIGN="CENTER"><COL
WIDTH="300"
ALIGN="CENTER"><THEAD
><TR
><TH
>Nazwa</TH
><TH
>Opis</TH
></TR
></THEAD
><TBODY
><TR
><TD
><A
HREF="#LMS-NOTIFY"
>lms-notify</A
></TD
><TD
>Korespondencja seryjna do u¿ytkowników sieci</TD
></TR
><TR
><TD
><A
HREF="#LMS-NOTIFY-SMS"
>lms-notify-sms</A
></TD
><TD
>Powiadamianie o zaleg³o¶ciach sms'em</TD
></TR
><TR
><TD
><A
HREF="#LMS-CUTOFF"
>lms-cutoff</A
></TD
><TD
>Od³±czanie u¿ytkowników zad³u¿onych</TD
></TR
><TR
><TD
><A
HREF="#LMS-ETHERDESC"
>lms-etherdesc</A
></TD
><TD
>Generowanie pliku dla iptraf zawieraj±cego pary MAC adres - nazwa hosta</TD
></TR
><TR
><TD
><A
HREF="#LMS-PAYMENTS"
>lms-payments</A
></TD
><TD
>Naliczanie op³at okresowych (abonamentowych) z fakturowaniem</TD
></TR
><TR
><TD
><A
HREF="#LMS-TRAFFIC"
>lms-traffic</A
></TD
><TD
>Zapis statystyk wykorzystania ³±cza</TD
></TR
><TR
><TD
><A
HREF="#LMS-TRAFFIC-LOGIPTABLES"
>lms-traffic-logiptables</A
></TD
><TD
>Statystyki ³±cza dla iptables</TD
></TR
><TR
><TD
>lms-makearp</TD
><TD
>Tworzenie tablicy ARP (/etc/ethers)</TD
></TR
><TR
><TD
><A
HREF="#LMS-MAKEDHCPCONF"
>lms-makedhcpconf</A
></TD
><TD
>Konfiguracja serwera DHCP (dhcpd.conf)</TD
></TR
><TR
><TD
><A
HREF="#LMS-MAKEIPTABLES"
>lms-makeiptables</A
></TD
><TD
>Konfiguracja firewalla iptables</TD
></TR
><TR
><TD
>lms-makeipchains</TD
><TD
>Konfiguracja firewalla ipchains</TD
></TR
><TR
><TD
>lms-makeopenbsdpf</TD
><TD
>Konfiguracja firewalla dla systemu OpenBSD</TD
></TR
><TR
><TD
>lms-makeoidentconf</TD
><TD
>Konfiguracja oident</TD
></TR
><TR
><TD
><A
HREF="#LMS-SENDINVOICES"
>lms-sendinvoices</A
></TD
><TD
>Wysy³anie faktur do u¿ytkowników</TD
></TR
><TR
><TD
><A
HREF="#LMS-MAKEMACS"
>lms-makemacs</A
></TD
><TD
>Filtrowanie ruchu na bazie adresów ¼ród³owych MAC</TD
></TR
><TR
><TD
><A
HREF="#LMS-MAKEHOSTS"
>lms-makehosts</A
></TD
><TD
>Generuje plik /etc/hosts</TD
></TR
><TR
><TD
><A
HREF="#LMS-MAKEWARNINGS"
>lms-makewarnings</A
></TD
><TD
>Generuje regu³ki przekierowuj±ce ruch u¿ytkowników zad³u¿onych</TD
></TR
><TR
><TD
><A
HREF="#LMS-MAKEMESSAGES"
>lms-makemessages</A
></TD
><TD
>Generuje regu³ki przekierowuj±ce ruch u¿ytkowników, którym ustawiono wiadomo¶æ administracyjn±</TD
></TR
><TR
><TD
><A
HREF="#LMS-FPING"
>lms-fping</A
></TD
><TD
>Badanie aktywno¶ci komputerów.</TD
></TR
><TR
><TD
><A
HREF="#LMS-RTPARSER"
>lms-rtparser</A
></TD
><TD
>Backend do Helpdesk'a.</TD
></TR
></TBODY
></TABLE
></DIV
><P
> </P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="SCRIPTS-CONFIG"
>4.3. Opis i konfiguracja</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="LMS-NOTIFY"
>4.3.1. lms-notify</A
></H3
><P
>lms-notify jest dobrym sposobem przypominania ludziom o tym ¿e do pracy sieci 
	  i ³±cz konieczne s± ich pieni±¿ki. Pozwala on na napisanie kilku[-nastu] plików tekstowych 
	  (w iso-8859-2) i traktowania ich jako szablonów do mailingu.</P
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="LMS-NOTIFY-TEMPLATES"
>4.3.1.1. Szablony</A
></H4
><P
>W szablonach mo¿na u¿ywaæ nastêpuj±cych zmiennych:</P
><UL
><LI
><P
>%date-m - zostanie zast±pione aktualnym miesi±cem, licz±c od 1 poprzedzone 0, np. 02</P
></LI
><LI
><P
>%date-y - zostanie zast±pione aktualnym rokiem, np. 2003</P
></LI
><LI
><P
>%date_month_name - zostanie zast±pione nazw± bie¿±cego miesi±ca, np. marzec</P
></LI
><LI
><P
>%saldo - zostanie zast±pione aktualnym saldem u¿ytkownika, np. 535</P
></LI
><LI
><P
>%abonament - zostanie zast±pione kwot± abonamentu jaka jest do danego u¿ytkownika przypisana, np. 107</P
></LI
><LI
><P
>%b - saldo z zanegowanym znakiem, np. 107</P
></LI
><LI
><P
>%B - saldo z prawdziwym znakiem, np. -107</P
></LI
><LI
><P
>%last_10_in_a_table - wyci±g ostatnich 10 operacji kasowych na koncie u¿ytkownika, np:</P
></LI
><LI
><P
>%pin - numer PIN u¿ytkownika.</P
></LI
><LI
><P
>%phone1 - pierwszy numer telefonu u¿ytkownika.</P
></LI
></UL
><DIV
CLASS="EXAMPLE"
><A
NAME="NOTIFY-EXAMPLE"
></A
><P
><B
>Przyk&#322;ad 4-1. Lms-notify: Przyk³adowy wyci±g 10 ostatnich operacji kasowych</B
></P
><PRE
CLASS="SCREEN"
>Data       | Opis                                                 | Warto¶æ
-----------+------------------------------------------------------+---------
2003-02-02 | Abonament za miesi±c 2003/02                         |  107.00
2003-02-01 | Wp³ata                                               | -107.00
2003-02-01 | Abonament za miesi±c 2003/02                         |  107.00
2003-02-01 | Wp³ata                                               | -321.00
2003-01-31 | Abonament za miesi±c 2003/01                         |  107.00
2003-01-31 | Abonament za miesi±c 2003/01                         |  107.00
2003-01-31 | Abonament za miesi±c 2003/01                         |  107.00
-----------+------------------------------------------------------+---------</PRE
></DIV
><DIV
CLASS="EXAMPLE"
><A
NAME="NOTIFY-TEMPLATE"
></A
><P
><B
>Przyk&#322;ad 4-2. Lms-notify: Przyk³ad szablonu</B
></P
><PRE
CLASS="SCREEN"
>UWAGA! Ta wiadomo¶æ zosta³a wygenerowana automatycznie.

Uprzejmie informujemy i¿ na Pani/Pana koncie figuruje zaleg³o¶æ w op³atach za
internet w wysoko¶ci %B z³.

Je¿eli porozumieli siê ju¿ Pañstwo z administratorami w kwestii op³aty za
bie¿±cy miesi±c czyli %date-m %date-y roku, prosimy o
zignorowanie tej wiadomo¶ci.

W wypadku gdy uwa¿aj± Pañstwo i¿ zaleg³o¶æ ta jest nieporozumieniem prosimy o
jak najszybszy kontakt.

Wszelkie informacje na temat Pañstwa rozliczeñ mog± Pañstwo znale¼æ pod
adresem http://www.naszasiec.pl/mojekonto/

Je¿eli chcieliby Pañstwo uregulowaæ zaleg³o¶ci prosimy o kontakt:

Dzia³ Rozliczeñ ASK NaszaSiec

Gerwazy Regu³a
telefon: 0-509031337
e-mail: gerwazy@staff.naszasiec.pl

Gwidon Mniejwa¿ny
telefon: 0-606666666
e-mail: gwidonm@naszasiec.pl

ps. za³±czamy ostatnie 10 operacji jakie zosta³o zarejestrowane przez nasz
system bilingowy na Pañstwa koncie:

kwota operacji | typ operacji | data

%last_10_in_a_table

--
Amatorska Sieæ Komputerowa NaszaSiec
http://www.naszasiec.pl/</PRE
></DIV
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="LMS-NOTIFY-CONFIG"
>4.3.1.2. Konfiguracja</A
></H4
><P
>Konfiguracjê dla lms-notify mo¿na ustaliæ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[notify]</I
></SPAN
>. 
	   Mo¿esz tam ustawiæ nastêpuj±ce parametry:</P
><UL
><LI
><P
>limit (opcjonalny)</P
><P
>Pozwala na ustalenie limitu bilansu, poni¿ej którego do u¿ytkownika zostanie wys³any e-mail z upomnieniem. Domy¶lnie limit = 0</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>mailsubject (wymagany)</P
><P
>Pozwala na ustalenie tematu e-maila wysy³anego do u¿ytkownika. Mo¿na u¿ywaæ podstawieñ znanych z szablonów (%B, %b, %date-y, %date-m, %last_10_in_a_table). Domy¶lnie: nie ustawione.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mailsubject = Informacje o zaleg³o¶ciach w op³atach za internet</SAMP
></P
></LI
><LI
><P
>mailtemplate (wymagany)</P
><P
>Pozwala na wskazanie szablonu wiadomo¶ci, która zostanie wys³ana do u¿ytkownika. Wiêcej o szablonach tutaj. Domy¶lnie: nie ustawione.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mailtemplate = /etc/lms/notifytemplate.txt</SAMP
></P
></LI
><LI
><P
>mailfrom</P
><P
>Adres e-mail z którego zostanie wys³any e-mail. Proszê pamiêtaæ, ¿e na niektórych MTA (np. exim) konto to musi istnieæ w systemie. Domy¶lnie nieustawione</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mailfrom = staff@domain.pl</SAMP
></P
></LI
><LI
><P
>mailfname</P
><P
>Nazwa nadawcy maila</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mailfname = Administratorzy</SAMP
></P
></LI
><LI
><P
>smtp_server</P
><P
>Serwer SMTP, przez który ma zostaæ wys³ana wiadomo¶æ. Domy¶lnie: 127.0.0.1</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>smtp_server = smtp.mydomain.pl</SAMP
></P
></LI
><LI
><P
>debug_email (opcjonalny)</P
><P
>Adres e-mail do debugowania. Gdy ustawiony, ca³a poczta zostaje wys³ana na dany email zamiast do u¿ytkowników. Przydatne do debugowania i sprawdzania czy wszystko dzia³a OK. Domy¶lnie: nie ustawiony.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>debug_email = lexx@domain.pl</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-NOTIFY-SMS"
>4.3.2. lms-notify-sms</A
></H3
><P
>lms-notify-sms to odpowiednik lms-notify, s³u¿±cy do wysy³ania
	  smsów. Do wysy³ania wiadomo¶ci potrzebna jest komórka Nokii oraz oprogramowanie,
	  które nale¿y pobraæ z (<A
HREF="http://www.gnokii.org"
TARGET="_top"
>www.gnokii.org</A
>)
	  i zainstalowaæ w systemie.</P
><P
>Konfiguracjê dla lms-notify-sms mo¿na ustaliæ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> 
	  w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[notify-sms]</I
></SPAN
>, a masz do dyspozycji nastêpuj±ce opcje:</P
><UL
><LI
><P
>limit (opcjonalny)</P
><P
>Pozwala na ustalenie limitu bilansu poni¿ej którego do u¿ytkownika 
	     zostanie wys³any sms z upomnieniem. Domy¶lnie: 0</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>smstemplate (wymagany)</P
><P
>Szablon wiadomo¶ci. Domy¶lnie: nie ustawione.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>smstemplate = /etc/lms/smstemplate.txt</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-CUTOFF"
>4.3.3. lms-cutoff</A
></H3
><P
>Skrypt pozwala na od³±czenie (a raczej zmianê w bazie danych stanu komputerów na wy³±czony) u¿ytkowników których bilans jest poni¿ej zadanej warto¶ci. W³a¶ciwe od³±czanie powinno byæ realizowane przez generator plików konfiguracyjnych.</P
><P
>Konfiguracjê dla lms-cutoff mo¿emy ustaliæ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[cutoff]</I
></SPAN
>. Mo¿emy tam ustawiæ nastêpuj±ce parametry:</P
><UL
><LI
><P
>limit (opcjonalny)</P
><P
>Pozwala na ustalenie limitu bilansu poni¿ej którego do bazy danych zostanie zapisany stan od³±czony. Domy¶lnie: 0</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-PAYMENTS"
>4.3.4. lms-payments</A
></H3
><P
>Skrypt s³u¿±cy do naliczania op³at abonamentowych przypisanych
	 u¿ytkownikom oraz op³at sta³ych. Ponadto zapisuje dane do faktur.
	 Aby dzia³a³ poprawnie powinien byæ uruchamiany codziennie.</P
><P
>Skrypt ten udostêpnia dwie opcje do fakturowania, które mo¿na ustawiæ
	 w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[payments]</I
></SPAN
> pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>:</P
><UL
><LI
><P
>deadline (opcjonalny)</P
><P
>Pozwala na ustalenie terminu p³atno¶ci w dniach. Domy¶lnie: 14</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>deadline = 7</SAMP
></P
></LI
><LI
><P
>paytype (opcjonalny)</P
><P
>Okre¶la rodzaj p³atno¶ci. Domy¶lnie: 'PRZELEW'</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>paytype = 'GOTÓWKA'</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-TRAFFIC"
>4.3.5. lms-traffic</A
></H3
><P
>Skrypt s³u¿y do logowania informacji o ilo¶ci danych pobranych i wys³anych
	przez ka¿dy komputer w sieci lokalnej. W bazie danych zapisywana jest ilo¶æ
	danych w bajtach, numer komputera z bazy lms i znacznik czasu. 
	Od u¿ytkownika zale¿y w jakich odstêpach dane bêd± odczytywane.
	Poniewa¿ dane odczytywane s± z pliku utworzonego przez u¿ytkownika, nie ma
	znaczenia z jakiego ¼ród³a pochodz±, mo¿e to byæ iptables, ipchains lub
	program zewnêtrzny np. ipfm.
    </P
><P
>Przegl±danie wykresów wykorzystania ³±cza oraz definiowanie filtrów
	dostêpne jest z g³ównego menu 'Statystyki'.
    </P
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="LMS-TRAFFIC-CONFIG"
>4.3.5.1. Instalacja</A
></H4
><P
>Przed uruchomieniem lms-traffic nale¿y zadbaæ o utworzenie
	    pliku z danymi. Zawarto¶æ pliku powinna mieæ nastêpuj±cy format:</P
><PRE
CLASS="SCREEN"
>&lt;adres IP&gt; &lt;n_spacji&gt; &lt;upload&gt; &lt;n_spacji&gt; &lt;download&gt;
&lt;adres IP&gt; &lt;n_spacji&gt; &lt;upload&gt; &lt;n_spacji&gt; &lt;download&gt;
...</PRE
><P
>Skrypt tworz±cy statystyki nale¿y uruchamiaæ z tak± sam± czêstotliwo¶ci± 
	    co lms-traffic.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Przyk³ad takiego skryptu dla iptables znajduje siê w 
	    pliku <TT
CLASS="FILENAME"
>/sample/traffic_ipt.sh</TT
>.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>Nastêpnie instalujemy skrypt dopisuj±c do crontaba.
	    Oprócz standardowych opcji wiersza poleceñ mo¿liwe jest
	    zdefiniowanie lokalizacji pliku z logiem</P
><PRE
CLASS="SCREEN"
>-f=/plik 	po³o¿enie i nazwa pliku ze statystykami domy¶lnie /var/log/traffic.log</PRE
><P
>	    <DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Czêstotliwo¶æ zapisywania danych do bazy ustala u¿ytkownik. Ustawienie
	    jej poni¿ej 10 minut, mo¿e spowodowaæ szybki przyrost ilo¶ci rekordów w 
	    bazie danych, a co za tym idzie zwiêkszyæ czas oczekiwania na wy¶wietlenie
	    wyników.</P
></TD
></TR
></TABLE
></DIV
>
	    </P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-TRAFFIC-LOGIPTABLES"
>4.3.6. lms-traffic-logiptables</A
></H3
><P
>Skrypt s³u¿y do logowania informacji o ilo¶ci danych pobranych i wys³anych
	przez ka¿dy komputer z sieci lokalnej, na podstawie liczników iptables. Dane 
	sczytuje z firewalla, tworz±c jednocze¶nie odpowiednie regu³y. Zatem, nie jest 
	konieczne rêczne tworzenie regu³ iptables, ani wywo³ywanie skryptu  
	<TT
CLASS="FILENAME"
>lms-traffic</TT
>.
	</P
><P
>Konfiguracjê nale¿y umie¶ciæ w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[traffic-logiptables]</I
></SPAN
>:
	    <UL
><LI
><P
>outfile</P
><P
>Lokalizacja skryptu z regu³ami iptables. Domy¶lnie: /etc/rc.d/rc.stat</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>outfile = /etc/rc.d/rc.stat</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. Domy¶lnie: /usr/sbin/iptables</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>wan_interfaces</P
><P
>Nazwy interfejsów, na których dane maj± byæ zliczane. Domy¶lnie: niezdefiniowane.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>wan_interfaces = eth0</SAMP
></P
></LI
><LI
><P
>local_ports</P
><P
>Lista portów (¼ród³owych i docelowych) dla zliczanych pakietów. Domy¶lnie: niezdefiniowane.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>local_ports = 80</SAMP
></P
></LI
><LI
><P
>script_owneruid</P
><P
>UID w³a¶ciciela skryptu okre¶lonego w 'outfile'. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_owneruid = 0</SAMP
></P
></LI
><LI
><P
>script_ownergid</P
><P
>GID w³a¶ciciela skryptu okre¶lonego w 'outfile'. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_ownergid = 0</SAMP
></P
></LI
><LI
><P
>script_permission</P
><P
>Uprawnienia skryptu okre¶lonego w 'outfile'. Domy¶lnie: 700 (rwx------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_permission = 700</SAMP
></P
></LI
></UL
>
	</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-MAKEDHCPCONF"
>4.3.7. lms-makedhcpconf</A
></H3
><P
>Tworzenie pliku konfiguracyjnego serwera DHCP - dhcpd.conf. Konfiguracjê
	skryptu umieszcza siê w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[dhcp]</I
></SPAN
>:
	    <UL
><LI
><P
>config_file</P
><P
>Lokalizacja pliku wynikowego. Domy¶lnie: /etc/dhcpd.conf</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_file = /tmp/dhcpd.conf</SAMP
></P
></LI
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony konfig dla wszystkich grup.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>usergroups = grupa1 grupa2</SAMP
></P
></LI
><LI
><P
>default_lease_time</P
><P
>Domy¶lny czas dzier¿awy. Domy¶lnie: 86400.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>default_lease_time = 43200</SAMP
></P
></LI
><LI
><P
>max_lease_time</P
><P
>Maksymalny czas dzier¿awy. Domy¶lnie: 86400.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>max_lease_time = 43200</SAMP
></P
></LI
><LI
><P
>ignore_ddns</P
><P
>Nie generuj wpisu 'ddns-update-style none;' na pocz±tku pliku.
		    Przydatne przy starszych (2.2) wersjach demona dhcpd. Domy¶lnie: wy³±czone.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>ignore_ddns = 1</SAMP
></P
></LI
><LI
><P
>log_facility</P
><P
>Ustawienie trybu logowania daemona dhcp. Je¿eli puste to tryb domy¶lny.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>log_facility = 7</SAMP
></P
></LI
><LI
><P
>script_owneruid</P
><P
>UID w³a¶ciciela skryptu okre¶lonego w 'config_file'. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_owneruid = 0</SAMP
></P
></LI
><LI
><P
>script_ownergid</P
><P
>GID w³a¶ciciela skryptu okre¶lonego w 'config_file'. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_ownergid = 0</SAMP
></P
></LI
><LI
><P
>script_permission</P
><P
>Uprawnienia skryptu okre¶lonego w 'config_file'. Domy¶lnie: 600 (rwx------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_permission = 700</SAMP
></P
></LI
></UL
>
	</P
><P
>Mo¿esz podaæ czasy dzier¿awy dla konkretnych sieci poprzez stworzenie
	sekcji <SAMP
CLASS="PROMPT"
>[dhcp:nazwasieci]</SAMP
> np.:
<PRE
CLASS="SCREEN"
>[dhcp:public-custa] # nazwa sieci ma³ymi literami!
default_lease_time = 3600
max_lease_time     = 3600</PRE
>

Mo¿esz podaæ gateway, serwer dns, nazwê domeny i wins dla konkretnego
hosta poprzez stworzenie sekcji <SAMP
CLASS="PROMPT"
>[dhcp:adresip]</SAMP
> np.:
<PRE
CLASS="SCREEN"
>[dhcp:213.25.209.216]
domain  = anotherdomain.pl
gateway = 213.25.209.251
dns     = 213.25.209.8
wins    = 213.25.209.10</PRE
>
	</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-MAKEIPTABLES"
>4.3.8. lms-makeiptables, lms-makeipchains</A
></H3
><P
>Para skryptów s³u¿±cych do generowania plików zawieraj±cych
	    regu³y firewalla. Do utworzonego pliku mo¿esz do³±czyæ inne wcze¶niej
	    utworzone pliki, a w koñcu nadaæ mu odpowiednie uprawnienia. Skrypty nie
	    uruchamiaj± wygenerowanych plików.</P
><P
>Konfiguracjê dla tych skryptów mo¿esz ustaliæ w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
> w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[iptables]</I
></SPAN
>
	    (i odpowiednio <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[ipchains]</I
></SPAN
>). Oba skrypty posiadaj± te same
	    opcje: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku firewalla. Je¶li nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>iptables_binary (ipchains_binary)</P
><P
>Lokalizacja programu iptables (ipchains). Domy¶lnie: /usr/sbin/iptables (/usr/sbin/ipchains)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>script_file</P
><P
>Plik, do którego zapisujemy regu³y firwalla. Domy¶lnie: /etc/rc.d/rc.masq</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_file = /etc/rc.d/rc.firewall</SAMP
></P
></LI
><LI
><P
>pre_script</P
><P
>Plik wykonywany PO wyczyszczeniu regu³ek, ale PRZED ustawieniem nowych. 
		    Domy¶lnie: niezdefiniowany.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>pre_script = /etc/rc.d/rc.masq-pre</SAMP
></P
></LI
><LI
><P
>post_script</P
><P
>Plik wykonywany PO ustawieniu regu³ek. Domy¶lnie: niezdefiniowany.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>post_script = /etc/rc.d/rc.masq-post</SAMP
></P
></LI
><LI
><P
>forward_to</P
><P
>Lista sieci, dla których w³±czamy forwarding. Mo¿liwe warto¶ci: "" - pe³ny forward, 
		    "dowolny ci±g" - wy³±cz forward, "siec1 siec2" - lista sieci z w³±czonym forwardingiem.  
		    Domy¶lnie: pe³ny forward.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>forward_to = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>script_owneruid</P
><P
>UID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_owneruid = 0</SAMP
></P
></LI
><LI
><P
>script_ownergid</P
><P
>GID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_ownergid = 0</SAMP
></P
></LI
><LI
><P
>script_permission</P
><P
>Uprawnienia pliku skryptu. Domy¶lnie: 700 (rwx------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>script_permission = 700</SAMP
></P
></LI
><LI
><P
>snat_address</P
><P
>Adres SNAT. Je¶li nie ustawiono, dla hostów z adresami publicznymi bêdzie
		    u¿yte "-j MASQUERADE". Je¶li ustawiono zostanie u¿yte "-j SNAT --to xxx.xxx.xxx.xxx".
		    Dotyczy lms-makeiptables. Domy¶lnie: nie ustawiony.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>snat_address = 123.123.123.123</SAMP
></P
></LI
><LI
><P
>tcp_redirect_ports (udp_redirect_ports)</P
><P
>Konfiguracja przekierowañ w formie port_¼ród³owy:port_docelowy dla
		    przekierowañ na lokaln± maszynê dla po³±czeñ wychodz±cych. Dotyczy lms-makeipchains.
		    Domy¶lnie: nie ustawione.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>tcp_redirect_ports = 80:3128 25:25</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-ETHERDESC"
>4.3.9. lms-etherdesc</A
></H3
><P
>Skrypt s³u¿±cy do generowania pliku zawieraj±cego MAC adresy oraz
	    nazwy hostów pobierane z bazy lms'a. Adresy zapisywane s± w formacie 'stripped mac',
	    czyli bez ":". Tego typu plik wykorzystywany jest przez pakiet <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>iptraf</I
></SPAN
>.
	    </P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[ethers]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony konfig dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>etherdesc_owneruid</P
><P
>UID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>etherdesc_owneruid = 0</SAMP
></P
></LI
><LI
><P
>etherdesc_file</P
><P
>Lokalizacja pliku. Domy¶lnie: /var/lib/iptraf/ethernet.desc.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>etherdesc_file = /etc/ethernet.desc</SAMP
></P
></LI
><LI
><P
>etherdesc_ownergid</P
><P
>GID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>etherdesc_ownergid = 0</SAMP
></P
></LI
><LI
><P
>etherdesc_permission</P
><P
>Uprawnienia pliku skryptu. Domy¶lnie: 600 (rw-------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>etherdesc_permission = 600</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-SENDINVOICES"
>4.3.10. lms-sendinvoices</A
></H3
><P
>Skrypt s³u¿y do wysy³ania poczt± elektroniczn± faktur, jako za³±czników
	do wiadomo¶ci. Faktury generowane s± na podstawie szablonu dostêpnego w lms-ui,
	dlatego wymagane jest podanie u¿ytkownika i has³a do interfejsu www lms-ui.</P
><P
>W odró¿nieniu od pozosta³ych skrytpów ten wymaga dodatkowych modu³ów perla:
	Data::Dumper, LWP::UserAgent, MIME::Entity.</P
><P
>Konfiguracjê nale¿y umie¶ciæ w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[sendinvoices]</I
></SPAN
>:
	    <UL
><LI
><P
>lms_url</P
><P
>Adres do lms-ui. Domy¶lnie: http://localhost/lms/</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>lms_url = http://lms.mynet.pl</SAMP
></P
></LI
><LI
><P
>lms_user</P
><P
>Login administratora. Domy¶lnie: pusty</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>lms_user = admin</SAMP
></P
></LI
><LI
><P
>lms_password</P
><P
>Has³o do lms-ui. Domy¶lnie: puste</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>lms_password = moje_has³o</SAMP
></P
></LI
><LI
><P
>debug_email</P
><P
>Konto pocztowe do testów. Domy¶lnie: niezdefiniowane.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>debug_email = admin@mynet.pl</SAMP
></P
></LI
><LI
><P
>sender_name</P
><P
>Nadawca listu. Domy¶lnie: niezdefiniowany.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>sender_name = ASK MyNet</SAMP
></P
></LI
><LI
><P
>sender_email</P
><P
>Adres nadawcy listu. Domy¶lnie: niezdefiniowany.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>sender_email = admin@mynet.pl</SAMP
></P
></LI
><LI
><P
>tmp_dir</P
><P
>Lokalizacja katalogu tymczasowego. Je¶li nie podano katalog 
		    odczytywany jest ze zmiennej ¶rodowiskowej 'TMP' lub przyjmowany jest 
		    katalog '/tmp'.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>tmp_dir = /home/user/tmp</SAMP
></P
></LI
></UL
>
	</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-MAKEMACS"
>4.3.11. lms-makemacs</A
></H3
><P
>Skrypt s³u¿±cy do generowania pliku zawieraj±cego regu³y netfiltra filtruj±ce ruch
	    u¿ytkowników na bazie testu adresu ¼ród³owego MAC. Dla ka¿dego komputera generowana jest
	    jedna regu³a dla tablicy nat, zadanego ³añcucha, testuj±ca adres ¼ród³owy IP pakietu oraz adres
	    ¼ród³owy MAC ramki. Je¶li testy zakoñcz± siê pozytywnie nastêpuje powrót do ³añcucha nadrzêdnego
	    za pomoc± decyzji RETURN. Na koñcu listy regu³ dodawane s± 2 regu³y przekierowuj±ce ruch http
	    oraz webcache na podany w konfiguracji adres IP oraz port (z wykorzystaniem decyzji DNAT).
	    Przekierowanie mo¿e odbywaæ siê na wirtualny host www z zawiadomieniem u¿ytkownika
	    o zaleg³o¶ciach finansowych bez mo¿liwo¶ci wy³±czenia zawiadomienia. Na koñcu dodawana jest 
	    regu³a blokuj±ca jakikolwiek inny ruch.
	    </P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[macs]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>usergroups </P
><P
>Lista nazw grup u¿ytkowników (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup u¿ytkowników.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>usergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. Domy¶lnie: /sbin/iptables</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. Domy¶lnie: /etc/rc.d/rc.macs.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/conf.d/rc.macs</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. Domy¶lnie: 700 (rwx------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_permission = 700</SAMP
></P
></LI
><LI
><P
>chain</P
><P
>£añuch do którego bêd± dodawane generowane regu³y. Domy¶lnie: MACS.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>chain = TESTY_MACOW</SAMP
></P
></LI
><LI
><P
>redirect_address</P
><P
>Adres IP + port na który bêdzie przekierowywany niesklasyfikowany ruch http i webcache. Domy¶lnie: 127.0.0.1:80.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>redirect_address = 192.168.1.1:3000</SAMP
></P
></LI
><LI
><P
>lock_noaccess</P
><P
>Czy generowaæ regu³ki testuj±ce z decyzj± RETURN dla komputerów, które s± od³±czone. Domy¶lnie: 0 (regu³y s± generowane)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>lock_noaccess = 1</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-MAKEHOSTS"
>4.3.12. lms-makehosts</A
></H3
><P
>Skrypt s³u¿±cy do generowania pliku /etc/hosts zawieraj±cego odwzorowania nazw komputerów
	    na adresy IP.
	    </P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[hosts]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>usergroups </P
><P
>Lista nazw grup u¿ytkowników (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup u¿ytkowników.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>usergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. Domy¶lnie: /etc/hosts.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/hosts</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. Domy¶lnie: 644 (rw-r--r--).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_permission = 600</SAMP
></P
></LI
><LI
><P
>config_header</P
><P
>Pierwsza linia w pliku /etc/hosts. Domy¶lnie: 127.0.0.1 localhost localhost.localdomain.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_header = 192.168.1.1 serwer serwer.nasza-siec</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-MAKEWARNINGS"
>4.3.13. lms-makewarnings</A
></H3
><P
>Skrypt s³u¿±cy do generowania pliku zawieraj±cego regu³y netfiltra przekierowuj±ce ruch http i webcache
	    u¿ytkowników o saldzie mniejszym lub równym od zadanego na zadany adres IP i port (wykorzystywana
	    jest tablica nat, testy adresów ¼ród³owych IP oraz decyzja DNAT).
	    </P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[warnings]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>usergroups </P
><P
>Lista nazw grup u¿ytkowników (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup u¿ytkowników.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>usergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. Domy¶lnie: /sbin/iptables</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. Domy¶lnie: /etc/rc.d/rc.warnings.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/conf.d/rc.warnings</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. Domy¶lnie: 700 (rwx------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_permission = 700</SAMP
></P
></LI
><LI
><P
>chain</P
><P
>£añuch do którego bêd± dodawane generowane regu³y. Domy¶lnie: WARNINGS.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>chain = OSTRZEZENIA</SAMP
></P
></LI
><LI
><P
>redirect_address</P
><P
>Adres IP + port na który bêdzie przekierowywany ruch http i webcache pochodz±cy z hostów dla których ma byæ w³±czone ostrze¿enie o zaleg³o¶ciach finansowych. Domy¶lnie: 127.0.0.1:80.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>redirect_address = 192.168.1.1:3001</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Saldo u¿ytkownika przy którym dla wszystkich komputerów u¿ytkownika generowane s± regu³ki przekierowuj±ce ruch. Domy¶lnie: 0 </P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>limit = -85</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-MAKEMESSAGES"
>4.3.14. lms-makemessages</A
></H3
><P
>Skrypt s³u¿±cy do generowania pliku zawieraj±cego regu³y netfiltra przekierowuj±ce ruch http i webcache
	    u¿ytkowników dla których zosta³o w³±czone przekazywanie wiadomo¶ci administracyjnej (ostrze¿enia) na zadany adres IP i port (wykorzystywana
	    jest tablica nat, testy adresów ¼ród³owych IP oraz decyzja DNAT).
	    </P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[messages]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich sieci.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>usergroups </P
><P
>Lista nazw grup u¿ytkowników (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas generowania
		    pliku. Je¶li nie ustawiono, zostanie stworzony plik konfiguracyjny dla wszystkich grup u¿ytkowników.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>usergroups = osiedle1 osiedle2</SAMP
></P
></LI
><LI
><P
>iptables_binary</P
><P
>Lokalizacja programu iptables. Domy¶lnie: /sbin/iptables</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>iptables_binary = /usr/local/sbin/iptables</SAMP
></P
></LI
><LI
><P
>config_owneruid</P
><P
>UID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_owneruid = 0</SAMP
></P
></LI
><LI
><P
>config_file</P
><P
>Lokalizacja pliku. Domy¶lnie: /etc/rc.d/rc.messages.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_file = /etc/conf.d/rc.messages</SAMP
></P
></LI
><LI
><P
>config_ownergid</P
><P
>GID w³a¶ciciela pliku. Domy¶lnie: 0 (root).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_ownergid = 0</SAMP
></P
></LI
><LI
><P
>config_permission</P
><P
>Uprawnienia pliku skryptu. Domy¶lnie: 700 (rwx------).</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>config_permission = 700</SAMP
></P
></LI
><LI
><P
>chain</P
><P
>£añuch do którego bêd± dodawane generowane regu³y. Domy¶lnie: MESSAGES.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>chain = WIADOMOSCI</SAMP
></P
></LI
><LI
><P
>redirect_address</P
><P
>Adres IP + port na który bêdzie przekierowywany ruch http i webcache pochodz±cy z hostów dla których ma byæ w³±czona wiadomo¶æ administracyjna. Domy¶lnie: 127.0.0.1:80.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>redirect_address = 192.168.1.1:3002</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-FPING"
>4.3.15. lms-fping</A
></H3
><P
>Skrypt zapisuje do bazy informacje o aktywno¶ci komputerów. 
	    Do skanowania wykorzystywany jest szybki program fping (z opcjami -ar1). 
	    Najpierw tworzona jest lista hostów, a nastêpnie, po wywo³aniu fping'a, 
	    komputerom w³±czonym zostaje przypisana data i czas skanowania. Dziêki temu 
	    mamy w bazie informacje kiedy dany komputer by³ ostatnio w³±czony.</P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[fping]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>networks </P
><P
>Lista nazw sieci (oddzielonych spacjami), które maj± byæ uwzglêdnione podczas skanowania.
		    Je¶li nie ustawiono przeskanowane zostan± wszystkie komputery.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = public-custa public-custb</SAMP
></P
></LI
><LI
><P
>fping_binary</P
><P
>Lokalizacja programu fping. Domy¶lnie: /usr/sbin/fping</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>fping_binary = /usr/local/sbin/fping</SAMP
></P
></LI
><LI
><P
>temp_file</P
><P
>Lokalizacja pliku tymczasowego na listê hostów, który
		    po wykonaniu skryptu zostaje usuniêty. Domy¶lnie: /tmp/fping_hosts.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>temp_file = /tmp/hosts</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LMS-RTPARSER"
>4.3.16. lms-rtparser</A
></H3
><P
>Jest to tzw. backend dla systemu Helpdesk, czyli scrypt który wspó³pracuj±c
	    z serwerem pocztowym zapisuje do bazy danych wszystkie wiadomo¶ci skierowane na
	    adresy Helpdesk'a. Skrypt pobiera z wej¶cia wiadomo¶æ pocztow±, parsuje zawarto¶æ
	    i umieszcza zg³oszenie w kolejce, wysy³aj±c do zg³aszaj±cych
	    potwierdzenie przyjêcia wiadomo¶ci. W temacie potwierdzenia znajduje siê symbol
	    zg³oszenia. Podczas parsowania wiadomo¶ci nastêpuje, na 
	    podstawie tematu wiadomo¶ci, próba rozpoznania czy wiadomo¶æ nie jest odpowiedzi± na inn± wiadomo¶æ z ju¿
	    przypisanym numerem zg³oszenia. Od wiadomo¶ci zostaj± od³±czone za³±czniki
	    i umieszczone w katalogu zdefiniowanym w opcji <TT
CLASS="FILENAME"
>mail_dir</TT
>.</P
><P
>Oprócz modu³ów Perla standardowo wymaganych przez resztê skryptów, nale¿y 
	    zainstalowaæ tak¿e modu³y <TT
CLASS="FILENAME"
>MIME::Parser</TT
> i <TT
CLASS="FILENAME"
>MIME::Words</TT
> z 
	    pakietu MIME-Tools oraz <TT
CLASS="FILENAME"
>Net::SMTP</TT
>.</P
><P
>Skrypt mo¿na uruchamiaæ na wiele sposobów. Jednym z nich jest
	    stworzenie skryptu pow³oki, który odczytuj±c skrzynkê pocztow± wywo³a lms-rtparser 
	    dla ka¿dego maila. Wygodniejszym zastosowaniem jest jednak zintegrowanie
	    go z serwerem pocztowym. Poni¿ej przedstawiono sposób pod³±czenia go do
	    postfixa przy u¿yciu opcji header_checks.
<PRE
CLASS="SCREEN"
># plik main.cf:
header_checks = regexp:/etc/postfix/header_checks

# plik header_checks
/^To:.*adres@domena.*/ FILTER filter:dummy

# plik master.cf:
filter unix - n n - 10 pipe
      -flags=Rq user=nobody argv=/path/to/lms-rtparser</PRE
>
	    </P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Je¿eli chcesz aby wiadomo¶ci wprowadzane poprzez <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>lms-ui</I
></SPAN
>
	    by³y kierowane do parsera, zamiast bezpo¶rednio zapisywane do bazy, powiniene¶ w³±czyæ
	    opcjê konfiguracyjn± <TT
CLASS="FILENAME"
>helpdesk_backend_mode</TT
> w sekcji
	    <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[phpui]</I
></SPAN
>.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>Konfiguracjê tego skryptu zawiera sekcja <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[rt]</I
></SPAN
>
	    w pliku <TT
CLASS="FILENAME"
>lms.ini</TT
>: </P
><UL
><LI
><P
>default_queue</P
><P
>Numer ID kolejki, do której trafi± zg³oszenia. Je¶li nie
		    podano, Kolejka zostanie odszukana na podstawie adresu odbiorcy maila.
		    Opcja ta mo¿e zostaæ nadpisana przy pomocy parametru -q przy
		    uruchomieniu skryptu. Domy¶lnie: niezdefiniowana.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>default_queue = </SAMP
></P
></LI
><LI
><P
>mail_from</P
><P
>Nadawca potwierdzenia (adres). Je¶li nie zdefiniowano, zostanie u¿yty adres
		    kolejki do której zapisano zg³oszenie. Domy¶lnie: pusty.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mail_from = rt@net.pl</SAMP
></P
></LI
><LI
><P
>mail_from_name</P
><P
>Nadawca potwierdzenia (nazwa). Domy¶lnie: niezdefiniowana.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mail_from_name = 'BOK SuperLAN'</SAMP
></P
></LI
><LI
><P
>smtp_server</P
><P
>Serwer SMTP, przez który zostanie wys³ana wiadomo¶æ. Domy¶lnie: localhost.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>smtp_server = smtp.mydomain.pl</SAMP
></P
></LI
><LI
><P
>mail_dir</P
><P
>Katalog w którym zostan± zapisane za³±czniki. Katalog ten powinien byæ
		    dostêpny dla apache'a i u¿ytkownika uruchamiaj±cego lms-rtparser. Gdy nie ustawiono, 
		    za³±czniki zostan± utracone. Domy¶lnie: niezdefiniowany.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>mail_dir = /usr/local/lms/mail</SAMP
></P
></LI
><LI
><P
>tmp_dir</P
><P
>Katalog tymczasowy. Domy¶lnie zostanie u¿yty katalog 
		    zdefiniowany w zmiennej systemowej lub <TT
CLASS="FILENAME"
>/tmp</TT
>.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>tmp_dir = /home/user/tmp</SAMP
></P
></LI
><LI
><P
>auto_open</P
><P
>W³±czenie tej opcji spowoduje, ¿e w momencie odebrania
		    wiadomo¶ci dotycz±cej zg³oszenia zamkniêtego (lub martwego)
		    zg³oszenie to zostanie otwarte. Domy¶lnie: wy³±czone.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>auto_open = 1</SAMP
></P
></LI
></UL
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="MGC"
></A
>Rozdzia&#322; 5. Generator plików konfiguracyjnych (lms-mgc)</H1
><P
>LMS-MGC to "magiczny" generator plików konfiguracyjnych. Przy odrobinie wysi³ku mo¿na stworzyæ przy jego pomocy dowolnego rodzaju plik konfiguracyjny (np. generuj±cy odpowiednie strefy dla DNS)</P
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MGC-INSTALL"
>5.1. Instalacja</A
></H2
><P
>Lms-mgc posiada w³asny plik konfiguracyjny: <TT
CLASS="FILENAME"
>lms-mgc.ini</TT
>. Jego instalacja
	polega na przeniesieniu do katalogu <TT
CLASS="FILENAME"
>/usr/sbin</TT
>. Uruchomienie generatora
	mo¿na wykonaæ na dwa sposoby: wpisaæ do crona (np. co godzinê)</P
><PRE
CLASS="SCREEN"
>0 * * * *       /usr/sbin/lms-mgc 1 &gt; /dev/null</PRE
><P
>albo z poziomu LMS skorzystaæ z menu "Prze³adowanie". Druga metoda wymaga u¿ycia 
	<TT
CLASS="FILENAME"
>sudo</TT
>. Niestety, jedyne wyj¶cie by umo¿liwiæ uruchomienie lms-mgc, to
	dopisanie u¿ytkownika do sudo, a nastêpnie ustawienie w sekcji [phpui] <TT
CLASS="FILENAME"
>lms.ini</TT
>:</P
><P
><SAMP
CLASS="PROMPT"
>reload_type 	= exec</SAMP
></P
><P
><SAMP
CLASS="PROMPT"
>reload_execcmd 	= sudo /usr/sbin/lms-mgc</SAMP
></P
><P
>Lms-mgc posiada nastêpuj±ce opcje uruchomienia:
	<PRE
CLASS="SCREEN"
>-C, --config-file=/path/lms-mgc.ini alternatywny plik konfiguracyjny 
                                    (default: /etc/lms/lms-mgc.ini);
-i, --instances=name                nazwa (lub numer) instancji do uruchomienia, bez czytania 
                                    konfiguracji z lms-mgc.ini, np. -i "name1 name2"
-h, --help                          wy¶wietla pomoc;
-v, --version                       wy¶wietla numer wersji;
-q, --quiet                         tylko komunikaty o b³êdach;
-d, --debug                         informacje szczegó³owe dla ka¿dego IP;</PRE
>
	</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MGC-CONFIG"
>5.2. Konfiguracja</A
></H2
><P
>Konfiguracjê dla LMS-MGC przeprowadza siê w pliku <TT
CLASS="FILENAME"
>lms-mgc.ini</TT
></P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MGC-CONFIG-DB"
>5.2.1. Sekcja [database] - ustawienia bazy danych</A
></H3
><UL
><LI
><P
>type</P
><P
>Typ bazy danych. Aktualnie w 100% supportowany jest 'mysql', ale jak narazie nie widaæ wiêkszych problemów z 'postgres'. Domy¶lnie: mysql</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>type = mysql</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Host gdzie zainstalowana jest baza danych. Najczê¶ciej, localhost, ale mo¿na tutaj wstawiæ cokolwiek (ipek, domena, path to socketa w formacie 'localhost:/path/to/socket'). Domy¶lnie: localhost</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>host = localhost</SAMP
></P
></LI
><LI
><P
>user</P
><P
>U¿ytkownik do bazy danych. W wielu wypadkach (je¿eli postêpowa³e¶ zgodnie ze wskazówkami w doc/INSTALL) bêdzie to 'lms'. Je¿eli chcesz u¿ywaæ konta uprzywilejowanego, prawdopodobnie wpiszesz 'root' (MySQL na wiêkszo¶ci *nixów), 'mysql' (na PLD) b±d¼ 'postgres' (PostgreSQL). Domy¶lnie: root</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>user = mysql</SAMP
></P
></LI
><LI
><P
>password</P
><P
>Has³o do bazy danych. Domy¶lnie puste.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>password = tajne_haslo</SAMP
></P
></LI
><LI
><P
>database</P
><P
>Nazwa bazy danych, domy¶lnie lms.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>database = lms</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MGC-CONFIG-LMS"
>5.2.2. Sekcja [mgc] - lista instancji</A
></H3
><P
>W³a¶ciwa konfiguracja dotycz±ca generatorów poszczególnych plików konfiguracyjnych 
	jest umieszczana w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[mgc]</I
></SPAN
> i pochodnych. W samej sekcji 
	<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[mgc]</I
></SPAN
> mo¿emy u¿yæ nastêpuj±cego parametru:
   <UL
><LI
><P
>instances</P
><P
>Lista "instancji" oddzielona spacjami.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>instaces = dhcp firewall squid</SAMP
></P
></LI
></UL
>
   <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Zmienn± <TT
CLASS="FILENAME"
>instances</TT
> mo¿na tak¿e umie¶ciæ w
   sekcji dowolnej instancji. Patrz ni¿ej.</P
></TD
></TR
></TABLE
></DIV
>
   </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MGC-CONFIG-INSTANCES"
>5.2.3. Sekcja [mgc:xxx] - konfiguracja instancji</A
></H3
><P
>Ka¿da instancja ma swoj± nazwê i jej konfiguracjê tworzy siê umieszczaj±c 
	sekcjê o nazwie <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[mgc:nazwa]</I
></SPAN
>, czyli przyk³adowo: 
	<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[mgc:mydaemon]</I
></SPAN
></P
><P
>W samych instancjach mo¿emy u¿ywaæ nastêpuj±cych opcji konfiguracyjnych:</P
><UL
><LI
><P
>instances</P
><P
>Zmienna, w której mo¿esz podaæ listê innych instancji, aby nastêpnie
     wywo³ywaæ mgc poleceniem '<SAMP
CLASS="PROMPT"
>lms-mgc -i sekcja</SAMP
>' zamiast
     '<SAMP
CLASS="PROMPT"
>lms-mgc -i "sekcja1 sekcja2 sekcja3"</SAMP
>'. Je¶li zostanie 
     u¿yta, wszystkie pozosta³e zmienne tej sekcji zostan± zignorowane.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>instances = dns1 dns2 dns3</SAMP
></P
></LI
><LI
><P
>outfile</P
><P
>Definiuje plik do którego ma byæ zapisany wynik dzia³ania bie¿±cej instancji (je¿eli ta zmienna bêdzie nie ustawiona, instancja siê zakoñczy)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>outfile = /etc/somefile</SAMP
></P
></LI
><LI
><P
>append</P
><P
>Pozwala ustawiæ aby wynik dzia³ania instancji nie nadpisywa³ pliku wynikowego, lecz zosta³ dopisany na jego koñcu</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>append = 1</SAMP
></P
></LI
><LI
><P
>outfile_perm</P
><P
>Pozwala na ustawienie praw dostêpu do pliku wyj¶ciowego (domy¶lnie 600)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>outfile_perm = 700</SAMP
></P
></LI
><LI
><P
>outfile_owner</P
><P
>Pozwala na ustawienie w³a¶ciciela pliku wyj¶ciowego (domy¶lnie 0)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>outfile_owner = 0</SAMP
></P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>W³a¶ciciel musi byæ podany numerycznie!</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>outfile_group</P
><P
>Pozwala na ustawienie grupy pliku wyj¶ciowego (domy¶lnie 0)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>outfile_group = 0</SAMP
></P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Grupa musi byæ podana numerycznie!</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>header_file</P
><P
>Pozwala na umieszczenie w pliku wynikowym zawarto¶ci innego 
     pliku jako nag³ówek (domy¶lnie nie ustawione)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>header_file = /etc/lms/myservice_header</SAMP
></P
></LI
><LI
><P
>header</P
><P
>Pozwala na umieszczenie w pliku wynikowym zawarto¶ci zmiennej jako 
     nag³ówka (domy¶lnie puste)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>header = option1 = bla\noption2 = blabla</SAMP
></P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Znak \n zosta³ tu u¿yty jako separator linii. Koñcowe \n nie jest 
     wymagane.</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>networks</P
><P
>Pozwala ustaliæ które z naszych sieci bêd± uwzglêdniane w pliku konfiguracyjnym (domy¶lnie wszystkie)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>networks = cust1-publ cust2-publ cust3-priv</SAMP
></P
></LI
></UL
><P
>Teraz mgc pobiera kolejne sieci i wykonuje w kó³ko nastêpuj±ce czynno¶ci:</P
><UL
><LI
><P
>network_header</P
><P
>Generuje nag³ówek dla ka¿dej sieci (domy¶lnie puste):</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>network_header = network %ADDR/%MASK { # Config section for %NAME</SAMP
></P
></LI
><LI
><P
>dst_networks</P
><P
>Pozwala ustawiæ sieci docelowe, czyli takie dla których bêdzie przetwarzany parametr: dst_network_header (domy¶lnie wszystkie):</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>dst_networks = main coalloc</SAMP
></P
></LI
><LI
><P
>dst_network_header</P
><P
>Pozwala ustawiæ nag³ówek dla sieci docelowych</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>dst_network_header = \tallow to %DADDR/%DMASK;</SAMP
></P
></LI
><LI
><P
>network_body</P
><P
>Parametr jest przetwarzany po wys³aniu nag³ówków dla sieci, a przed rozpoczêciem analizy adresów IP</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>network_body = \tnodes {</SAMP
></P
></LI
></UL
><P
>Teraz MGC rozpocznie przetwarzanie regu³ek dla kolejnych adresów IP. Robi to w dosyæ specyficzny sposób. 
   Tzn. oblicza kolejny adres IP i sprawdza czy zdefiniowano regu³ê dla hosta i wykonuje pierwsz±.
   Sprawdzanie jest wykonywane w nastepuj±cej kolejno¶ci:</P
><UL
><LI
><P
>ignore</P
><P
>Pozwala na ustawienie listy adresów w postaci adres/prefix lub adres/maska oddzielanej spacjami dla której ma byæ ignorowane generowanie</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>ignore = 192.168.0.100/32</SAMP
></P
></LI
><LI
><P
>node(IP)</P
><P
>Przy pomocy tej opcji mo¿na zdefiniowaæ regu³ê dla wybranego komputera. W nawiasie podaje siê jego adres IP. 
     Ka¿da sekcja instancji mo¿e zawieraæ dowoln± ilo¶æ takich opcji.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>node(192.168.0.20) = ??</SAMP
></P
></LI
><LI
><P
>allnodes</P
><P
>Pozwala na ustawienie regu³ki przetwarzanej dla ka¿dego kolejnego adresu IP.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>allnodes = ??</SAMP
></P
></LI
><LI
><P
>allexistnodes</P
><P
>Pozwala na ustawienie regu³ki przetwarzanej dla ka¿dego kolejnego adresu IP który jest u¿ywany.</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>allexistnodes = ??</SAMP
></P
></LI
><LI
><P
>grantednode_priv</P
><P
>Jest przetwarzana gdy dany adres komputer z danym adresem IP istnieje, ale w lms-ui ma status "pod³±czony" (regu³ka przetwarzana dla adresów prywatnych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>grantednode_priv = \t\tnode %NAME (%IP/%MAC) unique %ID;</SAMP
></P
></LI
><LI
><P
>grantednode_publ</P
><P
>Jest przetwarzana gdy dany adres komputer z danym adresem IP istnieje, ale w lms-ui ma status "pod³±czony" (regu³ka przetwarzana dla adresów publicznych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>grantednode_publ = \t\tnode %NAME (%IP/%MAC) unique %ID;</SAMP
></P
></LI
><LI
><P
>deniednode_priv</P
><P
>Jest przetwarzana gdy dany adres komputer z danym adresem IP istnieje, ale w lms-ui ma status "od³±czony" (regu³ka przetwarzana dla adresów prywatnych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>deniednode_priv = node %NAME (%IP/%MAC) unique %ID deny;</SAMP
></P
></LI
><LI
><P
>deniednode_publ</P
><P
>Jest przetwarzana gdy dany adres komputer z danym adresem IP istnieje, ale w lms-ui ma status "od³±czony" (regu³ka przetwarzana dla adresów publicznych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>deniednode_publ = node %NAME (%IP/%MAC) unique %ID deny;</SAMP
></P
></LI
><LI
><P
>dhcpnode_priv</P
><P
>Jest przetwarzana gdy dany adres IP zawiera siê w klasie DHCP (regu³ka przetwarzana dla adresów prywatnych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>dhcpnode_priv = node unknown (%IP) reject;</SAMP
></P
></LI
><LI
><P
>dhcpnode_publ</P
><P
>Jest przetwarzana gdy dany adres IP zawiera siê w klasie DHCP (regu³ka przetwarzana dla adresów publicznych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>dhcpnode_publ = node unknown (%IP) reject;</SAMP
></P
></LI
><LI
><P
>freeip_priv</P
><P
>Jest przetwarzana gdy dany adres IP nie jest przypisany do ¿adnego komputera (regu³ka przetwarzana dla adresów prywatnych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>freeip_priv = node unknown (%IP) lock_as_unused;</SAMP
></P
></LI
><LI
><P
>freeip_publ</P
><P
>Jest przetwarzana gdy dany adres IP nie jest przypisany do ¿adnego komputera (regu³ka przetwarzana dla adresów publicznych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>freeip_publ = node unknown (%IP) lock_as_unused;</SAMP
></P
></LI
><LI
><P
>default_priv</P
><P
>Regu³ka domy¶lna. Jest przetwarzana gdy adres nie zostanie przetworzony przez ¿adn± regu³kê grantednode lub deniednode (regu³ka przetwarzana dla adresów prywatnych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>default_priv = node unknown (%IP) lock_as_intruder;</SAMP
></P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>lms-mgc sam rozpoznaje który adres nale¿y do klasy publicznej, a który do prywatnej.</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>default_publ</P
><P
>Regu³ka domy¶lna. Jest przetwarzana gdy adres nie zostanie przetworzony przez ¿adn± regu³kê grantednode lub deniednode (regu³ka przetwarzana dla adresów publicznych)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>default_publ = node unknown (%IP) lock_as_intruder;</SAMP
></P
></LI
></UL
><P
>W koñcu nastêpuje wygenerowanie koñcowej czê¶ci pliku i wykonanie
    polecenia systemowego.</P
><UL
><LI
><P
>network_footer</P
><P
>Pozwala na ustawienie stopki dla w³a¶nie przetwarzanej sieci</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>network_footer = ??</SAMP
></P
></LI
><LI
><P
>footer_file</P
><P
>Pozwala na umieszczenie w pliku wynikowym zawarto¶ci innego pliku jako stopka (domy¶lnie nie ustawione)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>footer_file = /etc/lms/myservice_footer</SAMP
></P
></LI
><LI
><P
>footer</P
><P
>Pozwala na umieszczenie w pliku wynikowym zawarto¶ci zmiennej jako stopki (domy¶lnie puste)</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>footer = # End.</SAMP
></P
></LI
><LI
><P
>post_exec</P
><P
>Komenda do wywo³ania po wygenerowaniu pliku konfiguracyjnego</P
><P
>Przyk³ad:	<SAMP
CLASS="PROMPT"
>post_exec = killall -HUP mydaemon</SAMP
></P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="MGC-CONFIG-VARS"
>5.2.4. Zmienne konfiguracyjne</A
></H3
><P
>W opcjach konfiguracyjnych mo¿na u¿ywaæ nastêpuj±cych zmiennych, 
    które zostan± podmienione na odpowiednie dane z bazy:</P
><P
>Zmienne dla komputerów:
   <UL
><LI
><P
>%IP - adres IP komputera</P
></LI
><LI
><P
>%ID - ID komputera w bazie</P
></LI
><LI
><P
>%MAC - adres MAC karty sieciowej</P
></LI
><LI
><P
>%SMAC - adres MAC pisany ma³ymi literami z usuniêtymi dwukropkami</P
></LI
><LI
><P
>%OWNER - w³a¶ciciel komputera</P
></LI
><LI
><P
>%NAME - nazwa komputera du¿ymi znakami</P
></LI
><LI
><P
>%name - nazwa komputera ma³ymi znakami</P
></LI
><LI
><P
>%INFO - opis komputera</P
></LI
><LI
><P
>%UPRATE - gwarantowany transfer dla danych wychodz±cych</P
></LI
><LI
><P
>%DOWNRATE - gwarantowany transfer dla danych przychodz±cych</P
></LI
><LI
><P
>%UPCEIL - maksymalny transfer dla danych wychodz±cych</P
></LI
><LI
><P
>%DOWNCEIL - maksymalny transfer dla danych przychodz±cych</P
></LI
><LI
><P
>%CLIMIT - limit równoczesnych po³±czeñ</P
></LI
><LI
><P
>%PLIMIT - limit pakietów</P
></LI
><LI
><P
>%1 %2 %3 %4 - kolejne oktety (od lewej) adresu IP</P
></LI
><LI
><P
>%NID - ID sieci, do której nale¿y komputer</P
></LI
><LI
><P
>%NNAME - nazwa sieci du¿ymi znakami</P
></LI
><LI
><P
>%nname - nazwa sieci ma³ymi znakami</P
></LI
><LI
><P
>%NADDR - adres sieci</P
></LI
><LI
><P
>%NIFACE - interfejs sieci</P
></LI
><LI
><P
>%NMASK - maska sieci</P
></LI
><LI
><P
>%NGATE - adres bramy</P
></LI
><LI
><P
>%NDNS - adres serwera DNS</P
></LI
><LI
><P
>%NDNS2 - adres drugiego serwera DNS</P
></LI
><LI
><P
>%NDOMAIN - domena sieci</P
></LI
><LI
><P
>%NWINS - adres serwera WINS dla tej sieci</P
></LI
><LI
><P
>%NDHCPS - pierwszy adres DHCP sieci</P
></LI
><LI
><P
>%NDHCPE - ostatni adres DHCP sieci</P
></LI
></UL
>
    </P
><P
>Zmienne dla sieci (w opcjach dotycz±cych tylko sieci):
   <UL
><LI
><P
>%ID - ID sieci w bazie</P
></LI
><LI
><P
>%NAME - nazwa sieci du¿ymi znakami</P
></LI
><LI
><P
>%name - nazwa sieci ma³ymi znakami</P
></LI
><LI
><P
>%ADDR - adres sieci</P
></LI
><LI
><P
>%IFACE - interfejs</P
></LI
><LI
><P
>%MASK - maska</P
></LI
><LI
><P
>%GATE - brama sieci</P
></LI
><LI
><P
>%DNS - serwer DNS tej sieci</P
></LI
><LI
><P
>%DNS2 - drugi serwer DNS tej sieci</P
></LI
><LI
><P
>%DOMAIN - domena tej sieci</P
></LI
><LI
><P
>%WINS - adres serwera WINS dla tej sieci</P
></LI
><LI
><P
>%DHCPS - pierwszy adres DHCP tej sieci</P
></LI
><LI
><P
>%DHCPE - ostatni adres DHCP tej sieci</P
></LI
></UL
>
    <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>W opcji konfiguracyjnej <SAMP
CLASS="PROMPT"
>dst_network_header</SAMP
> mo¿na
    ponadto u¿yæ powy¿szych zmiennych ale poprzedzonych liter± D (np. %DADDR, %dname)
    jako parametry sieci docelowych.</P
></TD
></TR
></TABLE
></DIV
>
   </P
><P
>Zmienne które mo¿na stosowaæ we wszystkich opcjach:
   <UL
><LI
><P
>%DATE - data w formacie YYYYMMDD;</P
></LI
><LI
><P
>%TIME - czas w formacie HHMM;</P
></LI
><LI
><P
>%TIMES - czas w formacie HHMMSS;</P
></LI
><LI
><P
>%UTIME - czas w formacie unix timestamp;</P
></LI
></UL
>
   </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MGC-EXAMPLE"
>5.3. Przyk³ad zastosowania lms-mgc</A
></H2
><P
>Konfiguracja i zasada dzia³ania lms-mgc mo¿e siê wydawaæ do¶æ zawi³a, dlatego
	pos³u¿ymy siê przyk³adem. Poni¿ej przedstawiono sposób generowania i uruchamiania firewalla
	ipchains (bardzo prostego).</P
><DIV
CLASS="EXAMPLE"
><A
NAME="INSTANCE-EXAMPLE"
></A
><P
><B
>Przyk&#322;ad 5-1. Lms-mgc: Przyk³ad instancji</B
></P
><P
>Zacznij od utworzenia nowej sekcji mgc w <TT
CLASS="FILENAME"
>lms-mgc.ini</TT
>, 
	nazywaj±c j± 'ipchains' i stwórz w tej sekcji prost± maskaradê per adres IP z lanu:
	<PRE
CLASS="SCREEN"
>[mgc:ipchains]
outfile           = /etc/rc.d/rc.masq
outfile_perm      = 700
header            = #!/bin/sh\n/sbin/ipchains -F\n/sbin/ipchains -X\n/sbin/ipchains -P forward DENY
grantednode_priv  = /sbin/ipchains -A forward -s %IP -j MASQ
post_exec         = /etc/rc.d/rc.masq</PRE
>
	Dopiszmy tak¿e do sekcji g³ównej mgc informacjê ¿eby mgc uruchamia³ t± sekcjê:
	<PRE
CLASS="SCREEN"
>[mgc]
instances         = ipchains</PRE
>
	</P
><P
>Teraz próba odpalenia lms-mgc powinna zaowocowaæ wygenerowaniem
	<TT
CLASS="FILENAME"
>/etc/rc.d/rc.masq</TT
>, oraz jego odpaleniem.</P
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="DAEMON"
></A
>Rozdzia&#322; 6. A.L.E.C's LMS Daemon</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="DAEMON-INTRO"
>6.1. Informacje podstawowe</A
></H2
><P
>Napisany w jêzyku C program ma u³atwiaæ zarz±dzanie us³ugami. Sam demon odpowiada
    	za uruchamianie odpowiednich modu³ów na ¿±danie u¿ytkownika. Modu³y
    	natomiast, s³u¿± do tworzenia plików konfiguracyjnych na podstawie 
    	danych z bazy LMS'a oraz restartowania odpowiednich us³ug na serwerze.
    	</P
><P
>Dlaczego taka nazwa? Wiêkszo¶æ kodu demona napisa³ jeden z developerów - Aleksander 
	'A.L.E.C' Machniak, niemniej nale¿y tak¿e podkre¶liæ udzia³ Marcina 'Lexx' Króla. Program zawiera
	fragmenty kodu autorstwa Mateusza 'mteg' Golicza oraz korzysta z biblioteki
	iniparser Nicolasa Devillarda. Je¶li Ty masz ochotê napisaæ jaki¶ modu³ lub poprawiæ 
	funkcjonalno¶æ demona jak najbardziej do tego zachêcam.
	</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-REQUIREMENTS"
>6.1.1. Wymagania</A
></H3
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>A.L.E.C's LMS Daemon</I
></SPAN
> potrzebuje:
      			<UL
><LI
><P
>instalacji interfejsu u¿ytkownika <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
></P
></LI
><LI
><P
><TT
CLASS="FILENAME"
>libmysqlclient</TT
> (tj. pe³nej instalacji MySQL'a lub odpowiedniego 
				pakietu) lub <TT
CLASS="FILENAME"
>libpq</TT
> w przypadku bazy PostgreSQL</P
></LI
><LI
><P
><TT
CLASS="FILENAME"
>libdl</TT
> (to w ka¿dej dzisiejszej dystrybucji jest)</P
></LI
><LI
><P
>kompilatora jêzyka C </P
></LI
></UL
>
      			</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-INSTALL"
>6.1.2. Instalacja</A
></H3
><P
>Przed kompilacj± nale¿y przy pomocy skryptu <TT
CLASS="FILENAME"
>./configure</TT
>
			ustaliæ opcje przedstawione na poni¿szym listingu (w nawiasach podano
			warto¶ci domy¶lne opcji):
<PRE
CLASS="SCREEN"
>  --help                pomoc
  --enable-debug0       logowanie zapytañ SQL (wy³±czone)
  --enable-debug1       logowanie zdarzeñ (wy³±czone)
  --with-sqlite		gdy korzystasz z bazy SQLite (wy³±czone)
  --with-pgsql          gdy korzystasz z bazy PostgreSQL (wy³±czone)
  --with-mysql          gdy korzystasz z bazy MySQL (w³±czone)
  --prefix=DIR          katalog instalacyjny demona (/usr/local/bin)
  --libdir=DIR          lokalizacja bibliotek bazy danych (/usr/lib)
  --incdir=DIR          lokalizacja plików nag³ówkowych bazy danych (/usr/include)</PRE
>
			Zatem wymagane jest okre¶lenie bazy z jakiej bêdziemy korzystaæ (-with-mysql 
			lub -with-pgsql) oraz po³o¿enia bibliotek dostarczanych wraz z baz± (--incdir, --libdir).
<PRE
CLASS="SCREEN"
># ./configure --with-pgsql --libdir=/usr/local/pgsql/lib --incdir=/usr/local/pgsql/include</PRE
>
    			Nastêpnie kompilacja i instalacja (umieszczenie demona w katalogu
			okre¶lonym zmienn± --prefix):
<PRE
CLASS="SCREEN"
># make &#38;&#38; make install</PRE
>
			Na koniec skompilowane modu³y (pliki z rozszerzeniem <TT
CLASS="FILENAME"
>.so</TT
>),
			znajduj±ce siê w katalogu <TT
CLASS="FILENAME"
>modules/nazwa_modu³u</TT
> przenie¶ 
			do dowolnego katalogu. Ich lokalizacjê bêdziesz okre¶la³ w pliku konfiguracyjnym.
			</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-CONFIG"
>6.1.3. Konfiguracja</A
></H3
><P
>Przyk³adowy konfig demona i modu³ów zawarto w pliku <TT
CLASS="FILENAME"
>lms.ini.sample</TT
>.
			Poni¿szy listing przedstawia podstawowe opcje dla demona (konfiguracjê modu³ów omówiono w 
			osobnych rozdzia³ach ich dotycz±cych):
<PRE
CLASS="SCREEN"
>[database]
host            = localhost     # nazwa lub ip hosta, domy¶lnie: localhost
user            = lms           # nazwa u¿ytkownika, domy¶lnie: lms
password        = mypasswd      # has³o do bazy, domy¶lnie: puste
database        = lms           # nazwa bazy, domy¶lnie: lms
port            = 0             # numer portu, domy¶lnie: 0

[lmsd]
sleeptime       = 30            # okre¶la odstêp czasu (w sekundach) jak czêsto ma
                                # byæ sprawdzane ¿±danie reloadu, domy¶lnie: 30
instances       = hosts oident firewall       # lista instancji modu³ów
command         = 'echo "³±czê siê z baz±"'   # polecenie wykonywane przed ka¿dym po³±czeniem z baz±	</PRE
>
			<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Lista instancji sk³ada siê z nazw instancji oddzielonych 
			spacj±. Instancja to nazwa sekcji w pliku konfiguracyjnym.</P
></TD
></TR
></TABLE
></DIV
>
			</P
><P
>W sekcji dotycz±cej instancji, oprócz parametrów konfiguracji
			modu³ów, umieszcza siê opcje podstawowe, jak na poni¿szym listingu:
<PRE
CLASS="SCREEN"
>[nazwa_instancji]
module = /¶cie¿ka/nazwa_modu³u.so
info = "Opcjonalny opis modu³u"</PRE
>		
			</P
><P
>Zmiana opcji 'instances' oraz dowolnej opcji w sekcjach
			instancji, w odró¿nieniu od pozosta³ych opcji globalnych,
			nie wymaga restartu demona.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-RUN"
>6.1.4. Uruchomienie</A
></H3
><P
>Program mo¿esz uruchamiaæ jako demona pracuj±cego w tle (opcja '-b'). Wtedy 
			prze³adowanie konfiguracji i us³ug jest dokonywane na ¿±danie, przy u¿yciu menu 
			'Prze³adowanie' w <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
>. Opcja 'sleeptime' (-s) okre¶la okres miêdzy
			odczytami bazy. Gdy demon wykryje ¿±danie wykonania reloadu, wywo³a 
			modu³y okre¶lone opcj± 'instances' z <TT
CLASS="FILENAME"
>lms.ini</TT
>.
			Na przyk³ad:
<PRE
CLASS="SCREEN"
># almsd -b</PRE
>			
			</P
><P
>Innym sposobem uruchomienia jest jednorazowy reload w wykorzystaniem
			crona. Z tego sposobu nale¿y korzystaæ uruchamiaj±c modu³y takie jak 'payments'
			'notify', 'traffic', czy 'pinger'. W tym wypadku mo¿esz okre¶liæ listê 
			instancji do wykonania za pomoc± opcji '-i'.
			Przyk³adowy wpis do crontab'a wygl±da nastêpuj±co:
<PRE
CLASS="SCREEN"
>  1 0 * * *    /usr/local/bin/almsd -qi "payments notify"</PRE
>
			</P
><P
>Poni¿szy listing przedstawia dostêpne opcje linii poleceñ programu:
<PRE
CLASS="SCREEN"
>  -c	¶cie¿ka do pliku konfiguracyjnego (domy¶lnie: /etc/lms/lms.ini)
  -i	lista instancji (oddzielonych spacj±) do prze³adowania
  -b	uruchomienie w tle
  -s	czas w sek. miêdzy odczytami tabeli 'reload' (domy¶lnie: 30)
  -q 	wykonaj reload i zakoñcz
  -h 	wy¶wietla opcje linii poleceñ</PRE
>
			</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DAEMON-MODULES"
>6.2. Modu³y</A
></H2
><P
>Sam demon potrafi tylko uruchamiaæ modu³y i to one odwalaj± ca³± robotê. 
	Wiêkszo¶æ modu³ów jest przeznaczona do okre¶lonego zastosowania, jedynie 'hostfile' 
	mo¿na u¿ywaæ do ró¿nych konfigów (us³ug), np. ró¿nych typów firewalli. Przyk³ady 
	konfiguracji demona i modu³ów zawiera plik <TT
CLASS="FILENAME"
>daemon/lms.ini.sample</TT
>.
	Parametry konfiguracyjne modu³ów umieszcza siê w sekcjach instancji je wywo³uj±cych.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-MODULESLIST"
>6.2.1. Lista dostêpnych modu³ów</A
></H3
><DIV
CLASS="TABLE"
><A
NAME="MODULES-LIST"
></A
><P
><B
>Tabela 6-1. Lista modu³ów demona almsd</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="200"
ALIGN="CENTER"><COL
WIDTH="300"
ALIGN="CENTER"><THEAD
><TR
><TH
>Nazwa</TH
><TH
>Opis</TH
></TR
></THEAD
><TBODY
><TR
><TD
><A
HREF="#DAEMON-SYSTEM"
>system</A
></TD
><TD
>Wywo³ywanie poleceñ pow³oki</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-DHCP"
>dhcp</A
></TD
><TD
>Konfiguracja serwera dhcpd</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-CUTOFF"
>cutoff</A
></TD
><TD
>Od³±czanie u¿ytkowników z zaleg³o¶ciami w op³atach</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-DNS"
>dns</A
></TD
><TD
>Konfiguracja serwera dns</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-ETHERS"
>ethers</A
></TD
><TD
>Tworzenie pliku /etc/ethers</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-HOSTFILE"
>hostfile</A
></TD
><TD
>Modu³ uniwersalny (np. tworzenie regu³ iptables)</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-NOTIFY"
>notify</A
></TD
><TD
>Powiadamianie u¿ytkowników o zaleg³o¶ciach w op³atach poczt± elektroniczn±</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-GGNOTIFY"
>ggnotify</A
></TD
><TD
>Powiadamianie u¿ytkowników o zaleg³o¶ciach w op³atach przez gadu-gadu</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-PAYMENTS"
>payments</A
></TD
><TD
>Naliczanie op³at abonamentowych</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-OIDENT"
>oident</A
></TD
><TD
>Konfiguracja oident</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-TC"
>tc</A
></TD
><TD
>Tworzenie regu³ HTB</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-TRAFFIC"
>traffic</A
></TD
><TD
>Statystyki wykorzystania ³±cza</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-PINGER"
>pinger</A
></TD
><TD
>Badanie aktywno¶ci u¿ytkowników</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-SYSTEM"
>6.2.2. System</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="SYSTEM-DESC"
>6.2.2.1. Opis</A
></H4
><P
>Jedyne co robi ten modu³ to wykonanie zadanego polecenia (listy poleceñ)
		    pow³oki. Mo¿e siê przydaæ gdy chcesz podczas prze³adowania konfiguracji 
		    wykonaæ jak±¶ komendê lub uruchomiæ zewnêtrzny skrypt, na przyk³ad jeden 
		    z tych, które mo¿esz znale¼æ w katalogu <TT
CLASS="FILENAME"
>/bin</TT
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="SYSTEM-CONFIG"
>6.2.2.2. Konfiguracja</A
></H4
><P
>W zwi±zku z powy¿szym mo¿esz zdefiniowaæ jedynie tre¶æ polecenia.
		    Pow³oka powinna sobie tak¿e poradziæ z list± poleceñ oddzielonych ¶rednikami:</P
><UL
><LI
><P
>command</P
><P
>Polecenie pow³oki. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'echo "tu modu³ system"'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-PAYMENTS"
>6.2.3. Payments</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="PAYMENTS-DESC"
>6.2.3.1. Opis</A
></H4
><P
>Modu³ nalicza op³aty abonamentowe u¿ytkowników oraz op³aty sta³e. Nale¿y go uruchamiaæ 
		    codziennie. Op³aty naliczane na podstawie przypisanych u¿ytkownikowi
		    taryf zapisywane s± do bazy wraz z komentarzem okre¶lonym zmienn± 'comment'.
		    Po naliczeniu op³at tworzone s± faktury. Komentarz do op³aty sta³ej to zlepek
		    sk³adaj±cy siê z jej nazwy oraz wierzyciela. Na koñcu usuwane s± z bazy nieaktualne
		    obci±¿enia u¿ytkowników.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="PAYMENTS-CONFIG"
>6.2.3.2. Konfiguracja</A
></H4
><P
>Dla tego modu³u s± dostêpne nastêpuj±ce zmienne kofiguracyjne:</P
><UL
><LI
><P
>comment</P
><P
>Komentarz do operacji. '%period' zostanie zamienione na daty od-do 
			    nale¿nego abonamentu, np. '10.10.2003 - 09.11.2003', a '%tariff' na nazwê
			    odpowiedniej taryfy. Domy¶lnie: 'Abonament wg taryfy: '%tariff' za okres: %period'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>comment = 'Abonament miesiêczny za okres %period' </SAMP
></P
></LI
><LI
><P
>up_payments</P
><P
>"Naliczanie z góry", czyli czy okres w komentarzu ma byæ liczony do 
			    przodu, czy do ty³u w stosunku do daty naliczenia op³aty. Domy¶lnie: yes.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>up_payments = no</SAMP
></P
></LI
><LI
><P
>expiry_days</P
><P
>Okre¶la liczbê dni od daty wyga¶niêcia przypisanych u¿ytkownikowi zobowi±zañ, 
			    po której dane tego zobowi±zania zostan± usuniête z bazy. Przy ustawieniu na '0' dane
			    zostan± usuniête natychmiast po dacie, do której obowi±zywa³o zobowi±zanie. Domy¶lnie: 30.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>expiry_days = 365</SAMP
></P
></LI
><LI
><P
>deadline</P
><P
>Termin p³atno¶ci podany w dniach. Domy¶lnie: 14.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>deadline = 21</SAMP
></P
></LI
><LI
><P
>paytype</P
><P
>Rozdzaj p³atno¶ci. Domy¶lnie: 'PRZELEW'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>paytype = 'GOTÓWKA'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-NOTIFY"
>6.2.4. Notify</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="NOTIFY-DESC"
>6.2.4.1. Opis</A
></H4
><P
>Modu³ 'notify' s³u¿y do informowania u¿ytkowników o zaleg³o¶ciach
		    w op³atach za pomoc± poczty elektronicznej. Aktualne saldo u¿ytkownika
		    porównywane jest ze zmienn± 'limit', je¶li jest ni¿sze - wiadomo¶æ
		    zostaje wys³ana. Tre¶æ wiadomo¶ci pobierana jest z przygotowanego szablonu, 
		    w którym mo¿na stosowaæ nastêpuj±ce zmienne:
		    <UL
><LI
><P
>%saldo - aktualne saldo u¿ytkownika</P
></LI
><LI
><P
>%name - imiê u¿ytkownika</P
></LI
><LI
><P
>%lastname - nazwisko/nazwa u¿ytkownika</P
></LI
><LI
><P
>%last_10_in_a_table - wyci±g ostatnich 10 operacji na kocie u¿ytkownika</P
></LI
></UL
></P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="NOTIFY-CONFIG"
>6.2.4.2. Konfiguracja</A
></H4
><P
>Poni¿ej przedstawiono dostêpne opcje konfiguracyjne modu³u 'notify':</P
><UL
><LI
><P
>template</P
><P
>Lokalizacja pliku z szablonem wiadomo¶ci. Domy¶lnie: pusty</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>template = modules/notify/sample/mailtemplate</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Domy¶lnie: /tmp/mail</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/mail.txt</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wysy³aj±ce e-maila. '%address' zostanie zast±pione
			    adresem e-mail u¿ytkownika. Domy¶lnie: 'mail %address -s "Inf. o zaleg³o¶ciach w op³atach" &lt; /tmp/mail'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'mail %address -s "musisz zap³aciæ, bo jak nie..." &lt; /tmp/mail.txt'</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Wiadomo¶æ o zaleg³o¶ciach zostaje wys³ana je¶li saldo u¿ytkownika 
			    spadnie poni¿ej kwoty okre¶lonej zmienn± limit. Domy¶lnie: 0</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>debug_mail</P
><P
>Okre¶la adres na który zostan± wys³ane wszystkie wiadomo¶ci, przydatne
			    podczas testów. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>debug_mail = localhost@moja.net</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-GGNOTIFY"
>6.2.5. Ggnotify</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="GGNOTIFY-DESC"
>6.2.5.1. Opis</A
></H4
><P
>Odpowiednik modu³u 'notify' s³u¿±cy do wysy³ania wiadomo¶ci gadu-gadu.
		    Aktualne saldo u¿ytkownika porównywane jest ze zmienn± 'limit', je¶li jest ni¿sze 
		    - wiadomo¶æ zostaje wys³ana. Tre¶æ wiadomo¶ci pobierana jest z przygotowanego szablonu, 
		    w którym mo¿na stosowaæ zmienne takie jak dla modu³u 'notify' (mo¿e to byæ te¿ ten sam 
		    szablon).</P
><P
>Modu³ wymaga zainstalowanej biblioteki <TT
CLASS="FILENAME"
>libgadu</TT
> oraz ¼róde³
		    programu <TT
CLASS="FILENAME"
>ekg</TT
>. Odpowiednie ¶cie¿ki do nich nale¿y ustawiæ
		    w <TT
CLASS="FILENAME"
>modules/ggnotify/Makefile</TT
> przed kompilacj± modu³u.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="GGNOTIFY-CONFIG"
>6.2.5.2. Konfiguracja</A
></H4
><P
>Podobnie jak w 'notify' masz do dyspozycji nastêpuj±ce zmienne:</P
><UL
><LI
><P
>template</P
><P
>Lokalizacja pliku z szablonem wiadomo¶ci. Domy¶lnie: pusty.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>template = modules/ggnotify/sample/mailtemplate</SAMP
></P
></LI
><LI
><P
>uin</P
><P
>Identyfikator gadu-gadu u¿ytkownika wysy³aj±cego wiadomo¶ci. 
			    Domy¶lnie: pusty.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>uin = 1234567</SAMP
></P
></LI
><LI
><P
>password</P
><P
>Has³o dla konta okre¶lonego zmienn± 'uin'. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>password = "moje_trudne__has³o"</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Wiadomo¶æ o zaleg³o¶ciach zostaje wys³ana je¶li saldo u¿ytkownika 
			    spadnie poni¿ej kwoty okre¶lonej zmienn± limit. Domy¶lnie: 0</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>debug_uin</P
><P
>Je¶li ustawione, na to konto zostan± wys³ane wszystkie wiadomo¶ci.
			    Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>debug_uin = 7654321</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-CUTOFF"
>6.2.6. Cutoff</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="CUTOFF-DESC"
>6.2.6.1. Opis</A
></H4
><P
>Cutoff zmienia status komputerów na 'od³±czony' i/lub w³±cza ostrze¿enia
		    u¿ytkownikom, którzy maj± na koncie zaleg³o¶ci wiêksze ni¿ okre¶lony limit. Ten modu³ 
		    nie zajmuje siê fizycznym blokowaniem dostêpu do sieci.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="CUTOFF-CONFIG"
>6.2.6.2. Konfiguracja</A
></H4
><P
>Dla modu³u 'cutoff' mamy nastêpuj±ce opcje:</P
><UL
><LI
><P
>limit</P
><P
>Od³±czenie nastêpuje je¶li saldo u¿ytkownika spadnie poni¿ej
			    kwoty okre¶lonej t± zmienn±. Domy¶lnie: 0.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Okre¶la komendê systemow±, która zostanie wywo³ana je¿eli co najmniej
			    jeden u¿ytkownik zostanie od³±czony lub zostanie w³±czone ostrze¿enie. 
			    Domy¶lnie: nieustawiona.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'almsd -qi firewall'</SAMP
></P
></LI
><LI
><P
>warning</P
><P
>W³±cza ostrze¿enie dla od³±czanego u¿ytkowanika i przypisuje mu 
			    okre¶lon± w tej opcji tre¶æ. Je¿eli pusta, ostrze¿enie nie bêdzie w³±czane.
			    Data w ostrze¿eniu ukryta jest pod zmienn± '%time'.
			    Domy¶lnie: 'Automatyczna blokada spowodowana przekroczeniem terminu wp³aty (dd.mm.yyyy)".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>warning = ""</SAMP
></P
></LI
><LI
><P
>warnings_only</P
><P
>Ta opcja pozwala zdecydowaæ, czy chcemy u¿yæ naszego 
			    modu³u wy³±cznie do w³±czania ostrze¿eñ. Domy¶lnie: wy³±czona.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>warnings_only = true</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-DHCP"
>6.2.7. Dhcp</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="DHCP-DESC"
>6.2.7.1. Opis</A
></H4
><P
>Modu³ zarz±dzaj±cy serwerem DHCP, tworzy plik konfiguracyjny oraz
		    restartuje us³ugê. Zmienna 'command' umo¿liwia równie¿ wykonywanie innych 
		    czynno¶ci (programów).</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="DHCP-CONFIG"
>6.2.7.2. Konfiguracja</A
></H4
><P
>Wiêkszo¶æ parametrów konfiguracyjnych odpowiada fragmentom 
		    pliku konfiguracyjnego dhcpd, które w typowych zastosowaniach
		    nie wymagaj± zmiany:</P
><UL
><LI
><P
>file</P
><P
>Okre¶la lokalizacjê pliku konfiguracyjnego serwera dhcp. 
			    Domy¶lnie: /tmp/dhcpd.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/dhcpd.conf</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie wykonywane po utworzeniu pliku konfiguracyjnego. 
			    Domy¶lnie: pusta.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = 'killall -HUP dhcpd'</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek pliku. Domy¶lnie: "shared-network LMS {".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "shared-network LMS {"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka pliku. Domy¶lnie: "}".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = "\n}"</SAMP
></P
></LI
><LI
><P
>subnet_start</P
><P
>Nag³ówek podsieci. '%a' - nazwa, '%m' - maska. Domy¶lnie: "subnet %a netmask %m {\ndefault-lease-time 86400;\nmax-lease-time 86400;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_start = "subnet %a netmask %m {default-lease-time 3600;"</SAMP
></P
></LI
><LI
><P
>subnet_end</P
><P
>Stopka podsieci. Domy¶lnie: "}".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_end = '\t}'</SAMP
></P
></LI
><LI
><P
>subnet_gateway</P
><P
>Brama podsieci. '%i' zostanie zamienione na adres ip. Domy¶lnie: 'option routers %i;'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_gateway = "option routers %i"</SAMP
></P
></LI
><LI
><P
>subnet_dns</P
><P
>DNS'y podsieci. '%i - adresy dns'ów. Domy¶lnie: "option domain-name-servers %i;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_dns = "option domain-name-servers 192.168.0.1"</SAMP
></P
></LI
><LI
><P
>subnet_domain</P
><P
>Nazwa domenowa podsieci. '%n' - nazwa. Domy¶lnie: "option domain-name %n;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_domain = "option domain-name test.%n;"</SAMP
></P
></LI
><LI
><P
>subnet_wins</P
><P
>Serwery wins. '%i' - adres ip serwera. Domy¶lnie: "option netbios-name-servers %i;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_wins = ""</SAMP
></P
></LI
><LI
><P
>subnet_range</P
><P
>Zakres adresów podsieci. '%s' - adres pocz±tkowy, '%e' - koniec zakresu. Domy¶lnie: "range %s %e;".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>subnet_range = "range %s %e;"</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Parametry hostów, gdzie '%n' - nazwa hosta, '%m' - MAC, '%i' - adres ip. 
			    Domy¶lnie: "\thost %n {\n\t\thardware ethernet %m; fixed-address %i; \n\t}".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host = "host %n {hardware ethernet %m; fixed-address %i;}"</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-HOSTFILE"
>6.2.8. Hostfile</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="HOSTFILE-DESC"
>6.2.8.1. Opis</A
></H4
><P
>Modu³ 'hostfile' jest do¶æ uniwersalnym narzêdziem. Poniewa¿ 
		    wykonuje pêtlê po wszystkich komputerach w bazie rozró¿niaj±c ich
		    status (od³±czony/pod³±czony), sieæ do której s± pod³aczone oraz
		    grupy do których nale¿± ich w³a¶ciciele, dlatego mo¿liwe jest tworzenie np. regu³
		    dowolnego firewalla, czy te¿ pliku /etc/hosts. Dane zapisuje do pliku 
		    i nastêpnie wykonuje okre¶lone polecenie pow³oki.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="HOSTFILE-CONFIG"
>6.2.8.2. Konfiguracja</A
></H4
><P
>W opcjach 'grantedhost' i 'deniedhost' mo¿na stosowaæ specjalne zmienne,
		    które podczas zapisu do pliku zostan± zast±pione '%i' - adresem ip, '%m' - mac
		    adresem, '%n' - nazw± komputera, '%info' - opisem komputera, '%domain' - domen±, 
		    '%net' - nazw± sieci, '%gw' - adresem bramy w sieci do której nale¿y dany komputer.
		    Poni¿ej opcje udostêpniane przez ten modu³</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Domy¶lnie: /tmp/hostfile</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/rc.d/rc.firewall</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wyk. po utworzeniu pliku 'file'. Domy¶lnie: puste</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = '/bin/sh /etc/rc.d/rc.firewall'</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek pliku tymczasowego. Domy¶lnie: "/usr/sbin/iptables -F FORWARD\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "IPT=/usr/sbin/iptables \n$IPT -F FORWARD\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka pliku tymczasowego. Domy¶lnie: "/usr/sbin/iptables -A FORWARD -J REJECT\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = "$IPT -A FORWARD -J REJECT\n"</SAMP
></P
></LI
><LI
><P
>grantedhost</P
><P
>Tekst dla hosta pod³±czonego. Domy¶lnie: "/usr/sbin/iptables -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>grantedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n"</SAMP
></P
></LI
><LI
><P
>deniedhost</P
><P
>Tekst dla hosta od³±czonego. Domy¶lnie: "/usr/sbin/iptables -A FORWARD -s %i -m mac --mac-source %m -j REJECT\n"</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>deniedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j REJECT\n"</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
><LI
><P
>skip_dev_ips</P
><P
>Je¶li ustawiona na tak (yes, true) pominiête zostan± adresy urz±dzeñ sieciowych. Domy¶lnie: tak</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>skip_dev_ips = no</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-TRAFFIC"
>6.2.9. Traffic</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="TRAFFIC-DESC"
>6.2.9.1. Opis</A
></H4
><P
>'Traffic' to odpowiednik perlowego lms-traffic, zapisuj±cy do bazy statystyki
		    wykorzystania ³±cza z pliku utworzonego przez u¿ytkownika. Plik taki powinien mieæ 
		    format: ip_hosta upload download . Wiêcej informacji (w tym jak utworzyæ taki plik)
		    mo¿na znale¼æ w rozdziale dotycz±cym lms-traffic.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="TRAFFIC-CONFIG"
>6.2.9.2. Konfiguracja</A
></H4
><P
>Jedyny dostêpny parametr jest jednocze¶nie obowi±zkowy:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku ze statystykami firewalla. Domy¶lnie: /var/log/traffic.log</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/log</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-TC"
>6.2.10. Tc (HTB)</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="TC-DESC"
>6.2.10.1. Opis</A
></H4
><P
>Modu³ generuj±cy skrypt zawieraj±cy polecenia iptables i tc s³u¿±ce
		    do ograniczania pasma i limitowania po³±czeñ u¿ytkownikom. Regu³ki dla 
		    komputerów mo¿na dowolnie zdefiniowaæ i wykorzystaæ nie tylko do "traffic 
		    control". Zasada dzia³ania skryptu przedstawia siê nastêpuj±co: Najpierw z bazy
		    pobierane s± dane dla wszystkich u¿ytkowników. Obliczane s± sumy ograniczeñ
		    (uprate, downrate, upceil, downceil, limity po³±czeñ) dla ka¿dego u¿ytkownika
		    Nastêpnie wykonywana jest pêtla ze sprawdzeniem przynale¿no¶ci do grupy u¿ytkowników
		    i sieci (je¶li okre¶lono). Je¶li warto¶ci ograniczeñ s± ró¿ne od zera nastêpuje
		    zapis regu³ do pliku z podmian± zmiennych. W regu³kach mo¿na stosowaæ nastêpuj±ce
		    zmienne: %name - nazwa hosta, %i - adres IP, %m - MAC, %uprate, %downrate, %upceil, 
		    %downceil, %plimit, %climit oraz %x - licznik o warto¶ci pocz±tkowej 100 
		    zwiêkszany o jeden dla ka¿dego komputera.</P
><P
>Domy¶lna polityka tworzenia klas htb zak³ada utworzenie jednej klasy dla
		    wszystkich komputerów u¿ytkownika. Mo¿e to byæ zmienione za pomoc± opcji
		    'one_class_per_host'.</P
><P
>Konfiguracja domy¶lna zak³ada, ¿e twój system jest przystosowany
		    do zastosowania htb oraz iptables z modu³ami limit, connlimit, mark i ipp2p.
		    Mo¿esz sam spatchowaæ j±dro lub skorzystaæ ze ¼róde³ dostêpnych na stronie
		    <A
HREF="http://www.inet.one.pl"
TARGET="_top"
>www.inet.one.pl</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="TC-CONFIG"
>6.2.10.2. Konfiguracja</A
></H4
><P
>Masz do dyspozycji standardowe parametry takie jak usergroups, file,
		    command, networks i dodatkowo opcje definiuj±ce tre¶æ regu³ek tc i firewalla.
		    Domy¶lna konfiguracja przeznaczona jest dla ³±cz 512/128 kbit i 100mbit.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Warto¶ci opcji konfiguracyjnych w <TT
CLASS="FILENAME"
>lms.ini</TT
>
		    nale¿y podawaæ w jednej linii. W przypadku tego modu³u mo¿e to byæ niezbyt wygodne,
		    dlatego mo¿esz stworzyæ plik z zawarto¶ci± ca³ego nag³ówka (opcja <TT
CLASS="FILENAME"
>		    begin</TT
>), a nastêpnie u¿yæ opcji <TT
CLASS="FILENAME"
>command</TT
> do
		    jego sklejenia z reszt± skryptu wygenerowan± przez modu³.</P
></TD
></TR
></TABLE
></DIV
></P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Domy¶lnie: /etc/rc.d/rc.htb.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /tmp/rc.htb</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wykonywane po utworzeniu pliku. Domy¶lnie: "sh /etc/rc.d/rc.htb start".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = "chmod 700 /tmp/rc.htb; /tmp/rc.htb start"</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek skryptu. Domy¶lnie:
<PRE
CLASS="SCREEN"
>"#!/bin/sh
IPT=/usr/sbin/iptables
TC=/sbin/tc
LAN=eth0
WAN=eth1
BURST="burst 30k"

stop ()
{
$IPT -t mangle -D FORWARD -i $WAN -j LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -D FORWARD -o $WAN -j LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -F LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -X LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -F OUTPUT
$IPT -t filter -F FORWARD
$TC qdisc del dev $LAN root 2&#62; /dev/null
$TC qdisc del dev $WAN root 2&#62; /dev/null
}

start ()
{
stop
$IPT -t mangle -N LIMITS
$IPT -t mangle -I FORWARD -i $WAN -j LIMITS
$IPT -t mangle -I FORWARD -o $WAN -j LIMITS
# incomming traffic
$IPT -t mangle -A OUTPUT -j MARK --set-mark 1
$TC qdisc add dev $LAN root handle 1:0 htb default 3 r2q 1
$TC class add dev $LAN parent 1:0 classid 1:1 htb rate 99000kbit ceil 99000kbit quantum 1500
$TC class add dev $LAN parent 1:1 classid 1:2 htb rate   500kbit ceil   500kbit
$TC class add dev $LAN parent 1:1 classid 1:3 htb rate 98500kbit ceil 98500kbit prio 9 quantum 1500
$TC qdisc add dev $LAN parent 1:3 esfq perturb 10 hash dst
# priorities for ICMP, TOS 0x10 and ports 22 and 53
$TC class add dev $LAN parent 1:2 classid 1:20 htb rate 50kbit ceil 500kbit $BURST prio 1 quantum 1500
$TC qdisc add dev $LAN parent 1:20 esfq perturb 10 hash dst
$TC filter add dev $LAN parent 1:0 protocol ip prio 2 u32 match ip sport 22 0xffff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 2 u32 match ip sport 53 0xffff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 1 u32 match ip tos 0x10 0xff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 1 u32 match ip protocol 1 0xff flowid 1:20
# server -&#62; LAN
$TC filter add dev $LAN parent 1:0 protocol ip prio 4 handle 1 fw flowid 1:3

# outgoing traffic
$TC qdisc add dev $WAN root handle 2:0 htb default 11 r2q 1
$TC class add dev $WAN parent 2:0 classid 2:1 htb rate 120kbit ceil 120kbit
# priorities for ACK, ICMP, TOS 0x10, ports 22 and 53
$TC class add dev $WAN parent 2:1 classid 2:10 htb rate 60kbit ceil 120kbit prio 1 quantum 1500
$TC qdisc add dev $WAN parent 2:10 esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip protocol 6 0xff \
match u8 0x05 0x0f at 0 match u16 0x0000 0xffc0 at 1 match u8 0x10 0xff at 33 flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip dport 22 0xffff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip dport 53 0xffff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip tos 0x10 0xff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip protocol 1 0xff flowid 2:10
# server -&#62; Internet
$TC class add dev $WAN parent 2:1 classid 2:11 htb rate 30kbit ceil 120kbit prio 2 quantum 1500
$TC qdisc add dev $WAN parent 2:11 esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 3 handle 1 fw flowid 2:11
$TC filter add dev $WAN parent 2:0 protocol ip prio 9 u32 match ip dst 0/0 flowid 2:11</PRE
></P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "#!/bin/bash\n$TC=/usr/local/sbin/tc\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka skryptu. Domy¶lnie:
<PRE
CLASS="SCREEN"
>}

case "$1" in
    'start')
	start
    ;;
    'stop')
	stop
    ;;
    'status')
	echo "WAN Interface"
	echo "============="
	$TC class show dev $WAN | grep root
	$TC class show dev $WAN | grep -v root | sort | nl
	echo "LAN Interface"
	echo "============="
	$TC class show dev $LAN | grep root
	$TC class show dev $LAN | grep -v root | sort | nl
    ;;
    *)
	echo -e "\nUsage: rc.htb start|stop|status"
    ;;
esac</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>one_class_per_host</P
><P
>Okre¶la politykê tworzenia klas htb. W ustawieniu domy¶lnym
			    wszystkie komputery u¿ytkownika zostan± wrzucone do jednej klasy.
			    Ustawienie tej opcji na 'true' spowoduje, ¿e regu³y okre¶lone w 
			    host_htb_up i host_htb_down zostan± wygenerowane dla wszystkich
			    komputerów u¿ytkownika (z inn± warto¶ci± '%x'). Regu³y z host_mark_down,
			    host_mark_up, host_plimit i host_climit generowane s± dla ka¿dego
			    komputera niezale¿nie od ustawieñ tej zmiennej. Domy¶lnie: false</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>one_class_per_host = 1</SAMP
></P
></LI
><LI
><P
>host_mark_down</P
><P
>Regu³a markuj±ca dla ka¿dego komutera. Domy¶lnie:
<PRE
CLASS="SCREEN"
># %n
$IPT -t mangle -A LIMITS -d %i -j MARK --set-mark %x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_mark_down = ""</SAMP
></P
></LI
><LI
><P
>host_mark_up</P
><P
>Regu³a markuj±ca dla ka¿dego komutera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$IPT -t mangle -A LIMITS -s %i -j MARK --set-mark %x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_mark_up = ""</SAMP
></P
></LI
><LI
><P
>host_htb_down</P
><P
>Zestaw regu³ dla ka¿dego komutera, wykonywanych
			    gdy uprate i downrate s± ró¿ne od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$TC class add dev $LAN parent 1:2 classid 1:%x htb rate %downratekbit ceil %downceilkbit $BURST prio 2 quantum 1500
$TC qdisc add dev $LAN parent 1:%x esfq perturb 10 hash dst
$TC filter add dev $LAN parent 1:0 protocol ip prio 5 handle %x fw flowid 1:%x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_htb_down = ""</SAMP
></P
></LI
><LI
><P
>host_htb_up</P
><P
>Zestaw regu³ dla ka¿dego komutera, wykonywanych
			    gdy uprate i downrate s± ró¿ne od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$TC class add dev $WAN parent 2:1 classid 2:%x htb rate %upratekbit ceil %upceilkbit $BURST prio 2 quantum 1500
$TC qdisc add dev $WAN parent 2:%x esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 5 handle %x fw flowid 2:%x</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_htb_up = ""</SAMP
></P
></LI
><LI
><P
>host_climit</P
><P
>Regu³ka z ograniczeniem ilo¶ci równoczesnych po³±czeñ tcp. Wykonywana
			    gdy climit w bazie jest ró¿ny od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$IPT -t filter -I FORWARD -p tcp -s %i -m connlimit --connlimit-above %climit -m ipp2p --ipp2p -j REJECT</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_climit = "$IPT -t filter -I FORWARD -p tcp -s %i -m connlimit --connlimit-above -j REJECT"</SAMP
></P
></LI
><LI
><P
>host_plimit</P
><P
>Regu³ka z ograniczeniem ilo¶ci pakietów w jednostce czasu (tutaj sekunda). Wykonywana
			    gdy plimit w bazie jest ró¿ny od zera. Domy¶lnie:
<PRE
CLASS="SCREEN"
>$IPT -t filter -I FORWARD -p tcp -d %i -m limit --limit %plimit/s -m ipp2p --ipp2p -j ACCEPT
$IPT -t filter -I FORWARD -p tcp -s %i -m limit --limit %plimit/s -m ipp2p --ipp2p -j ACCEPT</PRE
>
			    </P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host_plimit = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-DNS"
>6.2.11. Dns</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="DNS-DESC"
>6.2.11.1. Opis</A
></H4
><P
>Modu³ do konfiguracji stref serwera 'named' jest jednym z bardziej skomplikowanych.
		    Tworzy dla ka¿dej sieci pliki stref oraz odpowiednie wpisy w named.conf w oparciu
		    o szablony tych plików. Przyk³adowe szablony znajduj± siê w katalogu
		    <TT
CLASS="FILENAME"
>/modules/dns/sample</TT
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="DNS-CONFIG"
>6.2.11.2. Konfiguracja</A
></H4
><P
></P
><UL
><LI
><P
>forward-patterns</P
><P
>Katalog z szablonami stref. Domy¶lnie: forward.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>forward-patterns = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>reverse-patterns</P
><P
>Katalog z szablonami stref odwrotnych. Domy¶lnie: reverse.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>reverse-patterns = /dns/patterns/revers</SAMP
></P
></LI
><LI
><P
>generic-forward</P
><P
>Szablon domy¶lny. Zostanie wykorzystany je¶li w katalogu okre¶lonym
			    'forward-patterns' nie bêdzie pliku odpowiadaj±cego nazwie domenowej sieci.
			    Domy¶lnie: modules/dns/sample/forward/generic.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>generic-forward = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>generic-reverse</P
><P
>Szablon domy¶lny. Zostanie wykorzystany je¶li w katalogu okre¶lonym
			    'reverse-patterns' nie bêdzie pliku odpowiadaj±cego numerowi IP sieci.
			    Domy¶lnie: modules/dns/sample/reverse/generic.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>generic-reverse = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>forward-zones</P
><P
>Katalog na pliki wynikowe stref.
			    Domy¶lnie: modules/dns/sample/out/forward.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>forward-zones = /dns/forward</SAMP
></P
></LI
><LI
><P
>reverse-zones</P
><P
>Katalog na pliki wynikowe stref odwrotnych.
			    Domy¶lnie: modules/dns/sample/out/reverse.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>reverse-zones = /dns/reverse</SAMP
></P
></LI
><LI
><P
>host-reverse</P
><P
>Linia w pliku strefy odw. odpowiadaj±ca ka¿demu komputerowi w dane sieci.
			    Domy¶lnie: "%n IN A %i\n".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host-reverse = "\t %n IN A %i\n"</SAMP
></P
></LI
><LI
><P
>host-forward</P
><P
>Linia w pliku strefy odpowiadaj±ca ka¿demu komputerowi w danej sieci.
			    Domy¶lnie: "%c IN PTR %n.%d.\n".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host-forward = "\t %c IN PTR %n.%d.\n"</SAMP
></P
></LI
><LI
><P
>conf-pattern</P
><P
>Lokalizacja szablonu g³ównego pliku konfiguracyjnego serwera.
			    Domy¶lnie: modules/dns/sample/named.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-pattern = /dns/patterns/named.conf</SAMP
></P
></LI
><LI
><P
>conf-output</P
><P
>Lokalizacja g³ównego pliku konfiguracyjnego serwera.
			    Domy¶lnie: /tmp/named.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-output = /etc/named.conf</SAMP
></P
></LI
><LI
><P
>conf-forward-entry</P
><P
>Wpis dla ka¿dej strefy w g³ównym pliku konfiguracyjnym.
			    Domy¶lnie: 'zone "%n" {\ntype master;\n file "forward/%n"; \nnotify yes; \n}; \n'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-forward-entry = 'zone "%n" { \n\ttype master; \n\tfile "forward/%n"; \n\tnotify yes; \n}; \n'</SAMP
></P
></LI
><LI
><P
>conf-reverse-entry</P
><P
>Wpis dla ka¿dej strefy odw. w g³ównym pliku konfiguracyjnym.
			    Domy¶lnie: 'zone "%c.in-addr.arpa" { \ntype master; \nfile "reverse/%i"; \nnotify yes; \n}; \n'.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>conf-revers-entry = 'zone "%c.in-addr.arpa" { \n\ttype master; \n\tfile "reverse/%i"; \n\tnotify yes; \n}; \n'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie wykonywane po utworzeniu plików konf. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-ETHERS"
>6.2.12. Ethers</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="ETHERS-DESC"
>6.2.12.1. Opis</A
></H4
><P
>Modu³ tworz±cy konfiguracjê tablicy ARP systemu. Ustawiaj±c opcjê
		    'dummy_macs' mo¿na sprawiæ, aby komputerom od³±czonym zosta³ przypisany 
		    mac-adres 00:00:00:00:00:00.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="ETHERS-CONFIG"
>6.2.12.2. Konfiguracja</A
></H4
><P
>Tutaj s± tylko standardowe opcje:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku wynikowego. Domy¶lnie: /tmp/ethers.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/ethers</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wykonywane po wygenerowaniu konfiga. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = "arp -f /etc/ethers"</SAMP
></P
></LI
><LI
><P
>dummy_macs</P
><P
>Je¶li ustawimy na 'yes', to komputerom od³±czonym zostanie
			    przypisany mac-adres '00:00:00:00:00:00'. Domy¶lnie: "no".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>dummy_macs = yes</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
			    Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
			    Domy¶lnie: pusta (wszystkie grupy).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-OIDENT"
>6.2.13. Oident</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="OIDENT-DESC"
>6.2.13.1. Opis</A
></H4
><P
>Modu³ do konfiguracji oidentd. W zasadzie mo¿na to zrobiæ modu³em
		    'hostfile', ale tutaj masz ju¿ gotowe ustawienia domy¶lne.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="OIDENT-CONFIG"
>6.2.13.2. Konfiguracja</A
></H4
><P
>A oto parametry modu³u 'oident'</P
><UL
><LI
><P
>begin</P
><P
>Tekst wstawiany na pocz±tku pliku. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>begin = "#Generowany automatycznie\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Tekst wstawiany na koñcu pliku. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Linia tekstu dla ka¿dego komputera. Domy¶lnie: "%i\t%n\tUNIX".</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>host = "%i %n WINDOWS"</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Tekst wstawiany na pocz±tku pliku. Domy¶lnie: /tmp/oidentd.conf.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>file = /etc/identd.conf</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci do uwzglêdnienia. Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = 'lan1 lan2'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie do wykonania po utworzeniu pliku. Domy¶lnie: puste.</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>command = "killall -HUP midentd"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-PINGER"
>6.2.14. Pinger</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="PINGER-DESC"
>6.2.14.1. Opis</A
></H4
><P
>Modu³ pinger to odpowiednik perlowego skryptu lms-fping. Ró¿nice s± jednak
		    zasadnicze. Nie potrzebuje zewnêtrznego programu i dzia³a przy wykorzystaniu
		    protoko³u ARP. Powodem tego jest mniej wiêcej dwukrotnie szybsze wykonanie
		    skanowania sieci. Nie ma tak¿e problemów z komputerami maj±cymi wy³±czone 
		    odpowiadanie na pingi. Po skanowaniu, wszystkim w³±czonym komputerom jest
		    ustawiany w bazie danych czas skanowania, wykorzystywany do obrazowania
		    aktywno¶ci komputerów np. na mapie sieci.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="PINGER-CONFIG"
>6.2.14.2. Konfiguracja</A
></H4
><P
>Pinger udostêpnia tylko jedn± opcjê konfiguracyjn±:</P
><UL
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ skanowane. Domy¶lnie: pusta (wszystkie sieci).</P
><P
>Przyk³ad: <SAMP
CLASS="PROMPT"
>networks = 'lan1 lan2'</SAMP
></P
></LI
></UL
></DIV
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="DEVEL"
></A
>Rozdzia&#322; 7. Dla dociekliwych</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="DEVEL-CATALOGS"
>7.1. Drzewo katalogów</A
></H2
><DIV
CLASS="TABLE"
><A
NAME="CATALOG-TREE"
></A
><P
><B
>Tabela 7-1. Drzewo katalogów LMS</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="200"
ALIGN="CENTER"><COL
WIDTH="300"
ALIGN="CENTER"><THEAD
><TR
><TH
>Nazwa</TH
><TH
>Opis</TH
></TR
></THEAD
><TBODY
><TR
><TD
>backups</TD
><TD
>Kopie zapasowe bazy danych</TD
></TR
><TR
><TD
>bin</TD
><TD
>Skrypty wykonywalne lms-...</TD
></TR
><TR
><TD
>contrib</TD
><TD
>Dodatki stworzone przez u¿ytkowników LMS</TD
></TR
><TR
><TD
>daemon</TD
><TD
>A.L.E.C's LMS Daemon</TD
></TR
><TR
><TD
>devel</TD
><TD
>Skrypty przydatne dla developerów</TD
></TR
><TR
><TD
>doc</TD
><TD
>Dokumentacja</TD
></TR
><TR
><TD
>img</TD
><TD
>Obrazki do Interfejsu U¿ytkownika</TD
></TR
><TR
><TD
>lib</TD
><TD
>LMS'owy zbiór bibliotek PHP oraz Smarty</TD
></TR
><TR
><TD
>modules</TD
><TD
>Modu³y Interfejsu U¿ytkownika</TD
></TR
><TR
><TD
>sample</TD
><TD
>Przyk³adowe skrypty i inne dodatki</TD
></TR
><TR
><TD
>templates</TD
><TD
>Temlejty Smarty dla Interfejsu U¿ytkownika</TD
></TR
><TR
><TD
>templates_c</TD
><TD
>Pliki tymczasowe</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DEVEL-DB"
>7.2. Struktura bazy danych</A
></H2
><P
>Poni¿ej przedstawiono ogóln± strukturê bazy danych LMS. Bardziej szczegó³owe
		informacje o typach danych, ograniczeniach nak³adanych na pola oraz warto¶ci domy¶lne
		zawarte s± w plikach <A
HREF="../lms.mysql"
TARGET="_top"
><TT
CLASS="FILENAME"
>lms.mysql</TT
></A
>,
		<A
HREF="../lms.pgsql"
TARGET="_top"
><TT
CLASS="FILENAME"
>lms.pgsql</TT
></A
> i 
		<A
HREF="../lms.sqlite"
TARGET="_top"
><TT
CLASS="FILENAME"
>lms.sqlite</TT
></A
> w katalogu
		<TT
CLASS="FILENAME"
>/doc</TT
>.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ADMINS"
>7.2.1. Administratorzy ('admins')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>login - login</TD
></TR
><TR
><TD
>name - nazwa (nazwisko i imiê)</TD
></TR
><TR
><TD
>email - adres admina</TD
></TR
><TR
><TD
>rights - prawa dostêpu</TD
></TR
><TR
><TD
>passwd - has³o logowania</TD
></TR
><TR
><TD
>lastlogindate - data ostatniego logowania</TD
></TR
><TR
><TD
>lastloginip - adres IP, z którego nast±pi³o ostatnie logowanie</TD
></TR
><TR
><TD
>failedlogindate - data ostatniej nieudanej próby logowania</TD
></TR
><TR
><TD
>failedloginip - adres IP, z którego próbowano siê zalogowaæ</TD
></TR
><TR
><TD
>deleted - czy usuniêty (0/1)</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="USERS"
>7.2.2. U¿ytkownicy ('users')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>lastname - nazwa/nazwisko</TD
></TR
><TR
><TD
>name - imiê</TD
></TR
><TR
><TD
>status - status u¿ytkownika (3-pod³±czony, 2-oczekuj±cy, 1-zainteresowany)</TD
></TR
><TR
><TD
>email - adres poczty internetowej</TD
></TR
><TR
><TD
>phone1 - telefon</TD
></TR
><TR
><TD
>phone2 - telefon</TD
></TR
><TR
><TD
>phone3 - telefon</TD
></TR
><TR
><TD
>gguin - identyfikator gadu-gadu</TD
></TR
><TR
><TD
>pin - numer pin (uwierzytelnianie)</TD
></TR
><TR
><TD
>address - adres (ulica, nr domu, nr lokalu)</TD
></TR
><TR
><TD
>zip - kod pocztowy</TD
></TR
><TR
><TD
>city - nazwa miasta</TD
></TR
><TR
><TD
>nip - numer identyfikacji podatkowej NIP</TD
></TR
><TR
><TD
>pesel - numer PESEL</TD
></TR
><TR
><TD
>info - dodatkowe informacje</TD
></TR
><TR
><TD
>serviceaddr - adres do dorêczeñ (np. na faktury)</TD
></TR
><TR
><TD
>creationdate - czas utworzenia wpisu</TD
></TR
><TR
><TD
>moddate - czas modyfikacji</TD
></TR
><TR
><TD
>creatorid - identyfikator administratora tworz±cego wpis</TD
></TR
><TR
><TD
>modid - identyfikator administratora dokonuj±cego zmian danych</TD
></TR
><TR
><TD
>deleted - usuniêty z bazy (0/1)</TD
></TR
><TR
><TD
>message - komunikat do wy¶wietlenia przy w³aczonych ostrze¿eniach</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="USERGROUPS"
>7.2.3. Grupy u¿ytkowników ('usergroups')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa</TD
></TR
><TR
><TD
>description - opis</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="USERASSIGNMENTS"
>7.2.4. Grupy u¿ytkowników - c.d. ('userassignments')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>usergroupid - identyfikator grupy</TD
></TR
><TR
><TD
>userid - identyfikator u¿ytkownika</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="NETWORKS"
>7.2.5. Sieci ('networks')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa sieci</TD
></TR
><TR
><TD
>address - adres IP</TD
></TR
><TR
><TD
>mask - maska</TD
></TR
><TR
><TD
>interface - interfejs (np. eth1)</TD
></TR
><TR
><TD
>gateway - adres IP bramy</TD
></TR
><TR
><TD
>dns - adres IP serwera nazw</TD
></TR
><TR
><TD
>dns2 - adres IP zapasowego serwera nazw</TD
></TR
><TR
><TD
>domain - domena</TD
></TR
><TR
><TD
>wins - adres serwera WINS</TD
></TR
><TR
><TD
>dhcpstart - pocz±tek zakresu DHCP</TD
></TR
><TR
><TD
>dhcpend - koniec zakresu DHCP</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="NODES"
>7.2.6. Komputery i adresy IP urz±dzeñ sieciowych ('nodes')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa</TD
></TR
><TR
><TD
>mac - adres MAC</TD
></TR
><TR
><TD
>ipaddr - adres IP</TD
></TR
><TR
><TD
>ownerid - identyfikator w³a¶ciciela ('0' - dla adresu urz±dzenia)</TD
></TR
><TR
><TD
>creationdate - znacznik czasu utworzenia wpisu</TD
></TR
><TR
><TD
>moddate - znacznik czasu ostatniej modyfikacji</TD
></TR
><TR
><TD
>creatorid - identyfikator administratora tworz±cego wpis</TD
></TR
><TR
><TD
>modid - identyfikator administratora </TD
></TR
><TR
><TD
>netdev - identyfikator urz±dzenia sieciowego do którego jest pod³±czony komputer</TD
></TR
><TR
><TD
>linktype - typ po³±czenia sieciowego (0-kabel, 1-radio)</TD
></TR
><TR
><TD
>access - pod³±czony/od³±czony (1/0)</TD
></TR
><TR
><TD
>warning - ostrzegaj/nie ostrzegaj (1/0)</TD
></TR
><TR
><TD
>lastonline - znacznik czasu ostatniej obecno¶ci w sieci</TD
></TR
><TR
><TD
>info - informacje dodatkowe</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="NETDEVICES"
>7.2.7. Sprzêt sieciowy ('netdevices')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa</TD
></TR
><TR
><TD
>location - lokalizacja</TD
></TR
><TR
><TD
>description - opis</TD
></TR
><TR
><TD
>producer - producent</TD
></TR
><TR
><TD
>model - model</TD
></TR
><TR
><TD
>serialnumber - numer seryjny</TD
></TR
><TR
><TD
>ports - ilo¶æ portów</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="NETLINKS"
>7.2.8. Po³±czenia sieciowe ('netlinks')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>src - jeden koniec</TD
></TR
><TR
><TD
>dst- drugi koniec</TD
></TR
><TR
><TD
>type - typ po³±czenia (0-kabel, 1-radio)</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="CASH"
>7.2.9. Operacje finansowe ('cash')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>time - znacznik czasu zaksiêgowania operacji</TD
></TR
><TR
><TD
>adminid - identyfikator administratora dokonuj±cego operacji</TD
></TR
><TR
><TD
>type - typ operacji (przychód, rozchód, wp³ata, obci±¿enie)</TD
></TR
><TR
><TD
>value - warto¶æ w z³otych</TD
></TR
><TR
><TD
>taxvalue - procent podatku</TD
></TR
><TR
><TD
>userid - identyfikator u¿ytkownika ('0' - je¶li nie dotyczy)</TD
></TR
><TR
><TD
>invoiceid - identyfikator faktury obejmuj±cej dan± operacjê</TD
></TR
><TR
><TD
>comment - opis operacji</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="TARIFFS"
>7.2.10. Taryfy ('tariffs')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa</TD
></TR
><TR
><TD
>value - kwota</TD
></TR
><TR
><TD
>taxvalue - wysoko¶æ podatku w procentach</TD
></TR
><TR
><TD
>pkwiu - numer PKWiU</TD
></TR
><TR
><TD
>uprate - gwarantowany upload</TD
></TR
><TR
><TD
>upceil - maksymalny upload</TD
></TR
><TR
><TD
>downrate - gwarantowany download</TD
></TR
><TR
><TD
>downceil - maksymalny download</TD
></TR
><TR
><TD
>climit - limit po³±czeñ</TD
></TR
><TR
><TD
>plimit - limit pakietów</TD
></TR
><TR
><TD
>description - opis</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="PAYMENTS"
>7.2.11. Op³aty sta³e ('payments')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa</TD
></TR
><TR
><TD
>value - kwota</TD
></TR
><TR
><TD
>creditor - nazwa wierzyciela</TD
></TR
><TR
><TD
>period - typ okresu naliczania: co tydzieñ/co miesi±c/co kwarta³/co rok (0/1/2/3)</TD
></TR
><TR
><TD
>at - dzieñ naliczenia</TD
></TR
><TR
><TD
>description - opis</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="ASSIGNMENTS"
>7.2.12. Powi±zania ('assignments')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>tariffid - identyfikator taryfy</TD
></TR
><TR
><TD
>userid - identyfikator u¿ytkownika</TD
></TR
><TR
><TD
>period - typ okresu </TD
></TR
><TR
><TD
>at - dzieñ naliczania</TD
></TR
><TR
><TD
>datefrom - data obowi±zywania zobowi±zania</TD
></TR
><TR
><TD
>dateto - data obowi±zywania zobowi±zania</TD
></TR
><TR
><TD
>invoice - okre¶la czy ma byæ wystawiana faktura (1 - tak, 0 - nie)</TD
></TR
><TR
><TD
>suspended - zawieszenie p³atno¶ci (1 - tak, 0 - nie)</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INVOICES"
>7.2.13. Faktury ('invoices')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>number - numer w roku</TD
></TR
><TR
><TD
>cdate - data wystawienia</TD
></TR
><TR
><TD
>paytime - termin p³atno¶ci (ilo¶æ dni)</TD
></TR
><TR
><TD
>paytype - rodzaj p³atno¶ci (przelew/gotówka/etc.)</TD
></TR
><TR
><TD
>customerid - identyfikator u¿ytkownika-nabywcy</TD
></TR
><TR
><TD
>name - nazwa (nazwisko i imiê) nabywcy</TD
></TR
><TR
><TD
>address - adres nabywcy</TD
></TR
><TR
><TD
>nip - nip nabywcy</TD
></TR
><TR
><TD
>pesel - PESEL nabywcy</TD
></TR
><TR
><TD
>zip - kod pocztowy nabywcy</TD
></TR
><TR
><TD
>phone - telefon nabywcy</TD
></TR
><TR
><TD
>city - miasto nabywcy</TD
></TR
><TR
><TD
>finished - pole okre¶laj±ce zamkniêcie faktury (0/1)</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INVOICECONTENTS"
>7.2.14. Faktury - cd. ('invoicecontents')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>invoiceid - identyfikator faktury</TD
></TR
><TR
><TD
>value - kwota pozycji</TD
></TR
><TR
><TD
>taxvalue - wysoko¶æ podatku w procentach</TD
></TR
><TR
><TD
>pkwiu - numer PKWiU</TD
></TR
><TR
><TD
>content - u¿yta jednostka (najczê¶ciej 'szt.')</TD
></TR
><TR
><TD
>count - ilo¶æ</TD
></TR
><TR
><TD
>description - opis</TD
></TR
><TR
><TD
>tariffid - identyfikator taryfy</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="PASSWD"
>7.2.15. Konta ('passwd')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator rekordu</TD
></TR
><TR
><TD
>ownerid - identyfikator u¿ytkownika (0 - konto "systemowe")</TD
></TR
><TR
><TD
>login - nazwa konta</TD
></TR
><TR
><TD
>password - has³o zaszyfrowane funkcj± crypt()</TD
></TR
><TR
><TD
>lastlogin - data ostatniego logowania</TD
></TR
><TR
><TD
>uid - identyfikator systemowy konta</TD
></TR
><TR
><TD
>home - katalog domowy (/home/[login])</TD
></TR
><TR
><TD
>type - typ konta (suma: 1-shell, 2-poczta, 4-www, 8-ftp)</TD
></TR
><TR
><TD
>expdate - data wa¿no¶ci konta</TD
></TR
><TR
><TD
>domain - nazwa domeny (np. dla kont www i pocztowych)</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="TIMESTAMPS"
>7.2.16. Historia ('timestamps')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>time - czas ostatniej modyfikacji</TD
></TR
><TR
><TD
>tablename - nazwa tabeli</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="STATS"
>7.2.17. Statystyki wykorzystania ³±cza ('stats')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>nodeid - numer komputera</TD
></TR
><TR
><TD
>dt - znacznik czasu</TD
></TR
><TR
><TD
>upload - ilo¶æ danych wys³anych, w bajtach</TD
></TR
><TR
><TD
>download - ilo¶æ danych odebranych, w bajtach</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="RTQUEUES"
>7.2.18. Helpdesk - kolejki ('rtqueues')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>name - nazwa</TD
></TR
><TR
><TD
>email - adres konta pocztowego</TD
></TR
><TR
><TD
>description - opis dodatkowy</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="RTTICKETS"
>7.2.19. Helpdesk - zg³oszenia ('rttickets')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>queueid - identyfikator kolejki</TD
></TR
><TR
><TD
>requestor - dane zg³aszaj±cego (w tym e-mail)</TD
></TR
><TR
><TD
>userid - identyfikator u¿ytkownika</TD
></TR
><TR
><TD
>subject - temat zg³oszenia</TD
></TR
><TR
><TD
>state - status (0-nowy, 1-otwarty, 2-rozwi±zany, 3-martwy)</TD
></TR
><TR
><TD
>owner - identyfikator w³a¶ciciela-administratora</TD
></TR
><TR
><TD
>createtime - data zg³oszenia</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="RTMESSAGES"
>7.2.20. Helpdesk - wiadomo¶ci ('rtmessages')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>ticketid - identyfikator zg³oszenia</TD
></TR
><TR
><TD
>adminid - identyfikator administratora nadawcy</TD
></TR
><TR
><TD
>userid - identyfikator u¿ytkownika nadawcy</TD
></TR
><TR
><TD
>mailfrom - e-mail nadawcy</TD
></TR
><TR
><TD
>subject - temat wiadomo¶ci</TD
></TR
><TR
><TD
>messageid - pocztowy identyfikator wiadomo¶ci</TD
></TR
><TR
><TD
>inreplyto - identyfikator poprzedniej wiadomo¶ci</TD
></TR
><TR
><TD
>replyto - nag³ówek wiadomo¶ci</TD
></TR
><TR
><TD
>headers - wszystkie nag³ówki pocztowe wiadomo¶ci</TD
></TR
><TR
><TD
>body - tre¶æ wiadomo¶ci</TD
></TR
><TR
><TD
>createtime - data utworzenia/wys³ania/odebrania </TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="RTATTACHMENTS"
>7.2.21. Helpdesk - za³±czniki ('rtattachments')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>messageid - identyfikator wiadomo¶ci</TD
></TR
><TR
><TD
>filename - nazwa pliku</TD
></TR
><TR
><TD
>contenttype - typ pliku</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="RTRIGHTS"
>7.2.22. Helpdesk - uprawnienia ('rtrights')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>id - identyfikator</TD
></TR
><TR
><TD
>queueid - identyfikator kolejki</TD
></TR
><TR
><TD
>adminid - identyfikator administratora</TD
></TR
><TR
><TD
>rights - (1-odczyt, 2-zapis)</TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DBINFO"
>7.2.23. Informacje o bazie danych ('dbinfo')</A
></H3
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>keytype - typ</TD
></TR
><TR
><TD
>keyvalue - warto¶æ</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DEVEL-INI"
>7.3. Format pliku konfiguracyjnego</A
></H2
><P
>W pliku konfiguracyjnym LMS'a (standardowo <TT
CLASS="FILENAME"
>/etc/lms/lms.ini</TT
>)
		mo¿na ustawiaæ parametry <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
>, daemona <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
>
		oraz skryptów perlowych (<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS_MGC</I
></SPAN
>). Przy czym format
		warto¶ci parametrów dla skryptów perlowych podlega wiêkszym restrykcjom.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="COMMENTS"
>7.3.1. Komentarze</A
></H3
><P
>Programy parsuj±ce plik konfiguracyjny pomijaj± wszystkie linie
			zaczynaj±ce siê znakiem '#' lub ';'. Komentarze poprzedzone jednym z tych
			znaków mo¿na tak¿e wstawiaæ w tej samej linii co sekcje i opcje.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="PARAMS"
>7.3.2. Sekcje, klucze, warto¶ci</A
></H3
><P
>Opcje konfiguracyjne pogrupowane s± w sekcje. Nazwê sekcji, sk³adaj±c±
			siê z liter i/lub cyfr nale¿y zamkn±æ w nawiasy kwadratowe. Ich nazwy
			powinny byæ unikalne.</P
><P
>Sekcje i parametry umieszcza siê w osobnych liniach. Parametry
			sk³adaj± siê z klucza i warto¶ci. Klucz to nazwa parametru konfiguracyjnego
			sk³adaj±ca siê z liter i/lub cyfr. W tej samej linii co klucz, po znaku
			równo¶ci, umieszcza siê warto¶æ parametru. Je¶li warto¶æ zawiera znaki specjalne
			nale¿y j± obj±æ w apostrofy lub cudzys³ów.</P
><DIV
CLASS="EXAMPLE"
><A
NAME="CONFIG-FORMAT"
></A
><P
><B
>Przyk&#322;ad 7-1. Format opcji konfiguracyjnych</B
></P
><PRE
CLASS="SCREEN"
>[sekcja]
klucz = warto¶æ 
zmienna1 = "jaki¶ tekst"
para_metr = 'zmienna "para_metr" w apostrofach'

[sekcja_1]				#tu mo¿na komentowaæ
klucz = "tekst ze znakami \t i ;"	; tu te¿ mo¿na komentowaæ
; a to jest komentarz na ca³± liniê
key = "A.L.E.C's LMS Daemon is the best"
# opcja = wy³±czona</PRE
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="PERL"
>7.3.3. Zmienne dla skryptów perlowych</A
></H3
><P
>Konfiguracja skryptów perlowych, z uwagi na zastosowanie
			modu³u Config::IniFiles, ma pewne ograniczenia. Komentarze mog±
			byæ wstawiane tylko i wy³±cznie w nowej linii. Warto¶ci
			zmiennych nie obejmuje siê w apostrofy lub cudzys³ów, a s±
			one czytane od znaku równo¶ci do koñca wiersza. Dlatego w³a¶nie 
			nie mo¿na umieszczaæ komentarzy w jednej linii z parametrami.
			</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DEVEL-GENFAKE"
>7.4. Generowanie danych losowych</A
></H2
><P
>Dla osób chc±cych szybko sprawdziæ jak dzia³a LMS przygotowali¶my
		modu³ 'genfake', s³u¿±cy do tworzenia bazy zawieraj±cej przyk³adowe dane. </P
><P
>Aby wygenerowaæ dane nale¿y, po zalogowaniu siê w LMS'ie wywo³aæ adres <TT
CLASS="FILENAME"
>		http://twoj.serwer.net/lms/?m=genfake</TT
>, okre¶liæ ilu
		u¿ytkowników ma zostaæ stworzonych i nacisn±æ ENTER. To wszystko. Ewentualne b³êdy
		bazy danych, spowodowane ograniczeniami unikalno¶ci niektórych danych, mo¿na zignorowaæ.
		<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Notatka"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Dla prawid³owego wygenerowania zale¿no¶ci, modu³ 'genfake'
		nale¿y uruchamiaæ na pustej, nowoutworzonej bazie.</P
></TD
></TR
></TABLE
></DIV
>
		<DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/warning.gif"
HSPACE="5"
ALT="Ostrze&#380;enie"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Wszystkie dane (oprócz danych administratorów) zostan±
		usuniête z bazy.</P
></TD
></TR
></TABLE
></DIV
>
		</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DEVEL-RIGHTS"
>7.5. Poziomy dostêpu</A
></H2
><P
>W  sumie  tutaj  to  wyt³umaczê  bardziej  dla developerów, gdy¿ osoby
		korzystaj±ce z LMS raczej nie bêd± zainteresowane.</P
><P
>Oryginalnie poziomy dostêpu mia³y byæ definiowane poprzez ró¿ne litery.
		By³o to  za³o¿enie  z  czasów LMS-0.4, lecz nigdy nie wykorzystane. Z
		racji  tego,  ¿e  wesz³o  to  do 1.0, d³ugo siê g³owi³em jak wykorzystaæ
		64-znakowego  stringa. Otó¿ w kolumnie rights jest po prostu 64-znakowa
		(256-bitowa)  liczba  heksadecymalna.  Ka¿dy jej znak mo¿e opisaæ
		maksymalnie  cztery bity kombinacji (4*64 = 256 - st±d ilo¶æ mo¿liwych
		poziomów).  Tak  wiêc  w³±czenie  jakiego¶  poziomu  dostêpu  powoduje
		ustawienie  w  tej  liczbie  odpowiedniego  bitu.  I tak je¿eli "pe³en
		dostêp"  ma pozycjê 0 w lib/accesstable.php, zostanie ustawiony bit 0,
		czyli  bêdzie  to liczba 1. Wiêc poziomy mog± mieæ numery od 0 do 255.
		Nie jest to finalne ograniczenie. Stosuj±c wiêcej liter i znaków mo¿na
		rozszerzyæ ilo¶æ mo¿liwych kombinacji do przynajmniej 6 bitów na znak,
		co da nam 384 kombinacje.
		</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DEVEL-LIMITS"
>7.6. Ograniczenia</A
></H2
><P
>Ka¿dy system ma ograniczenia. Pewne wynikaj± z u¿ytego silnika SQL (DBMS)
		inne za¶ z za³o¿eñ [prawie] ¶wiadomie podjêtych przez developerów. Nasz system
		takowe posiada:</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DEVEL-LIMITS-LMS"
>7.6.1. Wynikaj±ce z naszego projektu</A
></H3
><P
>Ilo¶æ pieniêdzy (tabela 'cash'). Pieni±¿ki (od lms-1.1) przechowujemy jako
			32 bitow± liczbê ca³kowit± i w zwi±zku z tym za 8 lat bêdziecie nas nie lubiæ
			posiadaj±c oko³o 5000 u¿ytkowników.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DEVEL-LIMITS-DB"
>7.6.2. Wynikaj±ce z u¿ywanego DBMS</A
></H3
><UL
><LI
><P
>MySQL</P
><UL
><LI
><P
>Rozmiar bazy danych:</P
><P
>Jak mówi dokumentacja do MySQL'a (rozdzia³: Table size, paragraf "How Big Can
			MySQL Tables Be?"), MySQL wersja 3.22 by³ ograniczony do 4 GB na tabelkê.
			W wersji za¶ 3.23 zosta³o to podniesione do 8 milionów terabajtów (czyli
			2^63 bajtów). Jednak warto zauwa¿yæ ¿e ró¿ne systemy operacyjne maj±
			limity nak³adane przez systemy plików, najczê¶ciej jest to 2 lub 4 GB.</P
></LI
><LI
><P
>Ilo¶æ rekordów:</P
><P
>Prawdziwe informacje na temat limitów uzyskamy dopiero po wydaniu polecenia:
			(w interpreterze poleceñ mysql)</P
><PRE
CLASS="SCREEN"
>mysql&gt; show table status;

...| Avg_row_length | Data_length | Max_data_length | Index_length |
...|             44 |       24136 |      4294967295 |        19456 |</PRE
><P
>Zauwa¿ymy ¿e miejsca wystarczy na oko³o 175 000 razy tyle ile mamy
			aktualnie wpisów w tabelce. (czyt.: mo¿esz spaæ spokojnie, chyba ¿e
			planujesz posiadanie ponad 100000 u¿ytkowników :-)</P
></LI
></UL
></LI
><LI
><P
>PostgreSQL</P
><UL
><LI
><P
>Rozmiar bazy danych:</P
><P
>PostgreSQL zapisuje dane w porcjach po 8 kB. Liczba tych bloków jest
			ograniczona do 32-bitowej liczby ca³kowitej ze znakiem, daj±c maksymaln±
			wielko¶æ tabeli wynosz±c± 16 terabajtów. Z uwagi na ograniczenia systemów
			operacyjnych dane przechowywane s± w wielu plikach o wielko¶ci 1 GB ka¿dy.</P
></LI
><LI
><P
>Ilo¶æ rekordów:</P
><P
>PostgreSQL nie narzuca ograniczenia na liczbê wierszy w dowolnej tabeli.
			Jednak funkcja COUNT zwraca 32-bitow± liczbê ca³kowit±, a zatem dla tabel
			zawieraj±cych ponad dwa miliardy wierszy wynik tej funkcji bêdzie
			nieprawid³owy. (Informacja dot. PostgreSQL 7.1)</P
></LI
></UL
></LI
><LI
><P
>SQLite</P
><UL
><LI
><P
>Rozmiar bazy danych:</P
><P
>Od wersji 2.7.4 SQLite mo¿e obs³ugiwaæ bazy o rozmiarze do 2 terabajtów. 
			Dodatkowym ograniczeniem jest objêto¶æ danych zapisanych w jednym rekordzie.
			Wielko¶æ ta, ograniczona do 1 MB mo¿e zostaæ zwiêkszona do 16 MB podczas 
			kompilacji.</P
></LI
><LI
><P
>Ilo¶æ rekordów:</P
><P
>Maksymalna ilo¶æ rekordów dla tej bazy to 2^32, ale nikt nie testowa³ nigdy takiej 
			ilo¶ci.</P
></LI
></UL
></LI
></UL
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="CONTRIB"
></A
>Rozdzia&#322; 8. Dodatki</H1
><P
>W niniejszym rozdziale zostan± opisane dodatkowe modu³y i rozwi±zania
	zwiêkszaj±ce funkcjonalno¶æ LMS'a znajduj±ce siê w katalogu 
	<TT
CLASS="FILENAME"
>contrib</TT
>. Czê¶æ z nich nale¿y dostosowaæ do w³asnych 
	potrzeb, a niektóre integruj± siê z interfejsem <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
>.</P
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="CONTRIB-CUSTOMER"
>8.1. Moje konto</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="CUSTOMER-INTRO"
>8.1.1. Wstêp</A
></H3
><P
>W katalogu <TT
CLASS="FILENAME"
>contrib/customer</TT
> znajduje siê
		przyk³ad rozwi±zania, dziêki któremu ka¿dy u¿ytkownik twojej sieci
		mo¿e sprawdziæ w³asny bilans finansowy.</P
><P
>Skrypt sprawdza spod jakiego adresu jest ¿±danie i wy¶wietla
		bilans i informacje o u¿ytkowniku, który jest w³a¶cicielem komputera
		o tym adresie.</P
><P
>Dla u¿ytkowników korzystaj±cych z proxy, nie korzystaj±cych
		z sieci tylko w domu, albo którzy nie chc± aby dzieci/ma³¿onkowie/pracownicy 
		mieli wgl±d w dane fiansowe dotycz±ce ich dostêpu do sieci/innych 
		us³ug przeznaczone jest "Moje konto 2".</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="CUSTOMER-INSTALL"
>8.1.2. Instalacja</A
></H3
><P
>Pliki nale¿y skopiowaæ w dowolne miejsce i wystawiæ
		pod adresem dostêpnym dla ka¿dego u¿ytkownika, a nastêpnie
		ustawiæ poprawn± ¶cie¿kê do <TT
CLASS="FILENAME"
>lms.ini</TT
> w pliku 
		<TT
CLASS="FILENAME"
>index.php</TT
>.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="CONTRIB-CUSTOMER2"
>8.2. Moje konto 2</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="CUSTOMER2-INTRO"
>8.2.1. Wstêp</A
></H3
><P
>W katalogu <TT
CLASS="FILENAME"
>contrib/customer_otherip</TT
> znajduje siê
		odpowiednik <TT
CLASS="FILENAME"
>contrib/customer</TT
>, który nie rozpoznaje
		u¿ytkownika po adresie IP, ale wymaga logowania. Uwierzytelnianie odbywa siê na 
		podstawie numeru PIN oraz telefonu u¿ytkownika, ale mo¿liwe jest tak¿e
		wykorzystanie ID lub numeru umowy (dodatkowe pole w bazie) - patrz 
		pliki balanceview.php i authentication.inc).</P
><P
>Skrypt wy¶wietla bilans i informacje o u¿ytkowniku, a tak¿e w po³±czeniu
		z <TT
CLASS="FILENAME"
>contrib/formularz_przelewu_wplaty</TT
> umo¿liwia u¿ytkownikowi
		wydrukowanie druku wp³aty na kwotê zaleg³o¶ci.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="CUSTOMER2-INSTALL"
>8.2.2. Instalacja</A
></H3
><P
>Instalacja sprowadza siê do ustawienia opcji <TT
CLASS="FILENAME"
>sys_dir</TT
>
		w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[directories]</I
></SPAN
> pliku lms.ini oraz zlinkowania 
		katalogu <TT
CLASS="FILENAME"
>img</TT
> z lms'owymi ikonkami.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="CONTRIB-SQLPANEL"
>8.3. Panel SQL</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="SQLPANEL-INTRO"
>8.3.1. Wstêp</A
></H3
><P
>W katalogu <TT
CLASS="FILENAME"
>contrib/sqlpanel</TT
> znajdziesz
		modu³, dziêki któremu bêdziesz mia³ mo¿liwo¶æ bezpo¶redniego dostêpu 
		do bazy danych poprzez zadawanie zapytañ SQL. Wyniki wy¶wietlane s±
		w formie tabeli. Ponadto podawany jest czas wykonania zapytania. 
		Mo¿liwe jest tak¿e drukowanie wyników zapytania.</P
><P
>Ilo¶æ wy¶wietlanych wierszy na jednej stronie ograniczana jest
		domy¶lnie do 50. Mo¿na to zmieniæ przy pomocy zmiennej '<SAMP
CLASS="PROMPT"
>sqlpanel_pagelimit</SAMP
>'
		w sekcji <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[phpui]</I
></SPAN
> pliku konfiguracyjnego <TT
CLASS="FILENAME"
>lms.ini</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="SQLPANEL-INSTALL"
>8.3.2. Instalacja</A
></H3
><P
>Instalacja polega na skopiowaniu plików w odpowiednie miejsca
		w drzewie katalogów lms'a. Plik <TT
CLASS="FILENAME"
>sql.php</TT
> skopiuj
		do katalogu <TT
CLASS="FILENAME"
>modules</TT
>, a pliki <TT
CLASS="FILENAME"
>sql.html, sqlprint.html, 
		adminheader.html</TT
> do katalogu <TT
CLASS="FILENAME"
>templates</TT
>.
		Po tej czynno¶ci dostêp do modu³u bêdzie mo¿liwy z menu 
		<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Administratorzy-&#62;SQL.</I
></SPAN
></P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="CONTRIB-SQUID-WARN"
>8.4. Ostrze¿enia + squid</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="SQUID-WARN-INTRO"
>8.4.1. Wstêp</A
></H3
><P
>Ten ma³y zestaw narzêdzi pozwala za pomoc± squida 
		w dosyæ elegancki sposób wy¶wietlaæ wiadomo¶ci administracyjne.
		Oczywi¶cie aby to dzia³a³o w 100%, wszyscy u¿ytkownicy musz± 
		korzystaæ ze squida.</P
><P
>Kluczowym elementem jest redirector. Odpowiada on za to, 
		aby w momencie ustawienia dla danego komputera flagi warn, 
		przekierowywa³ wszystkie ¿±dania wysy³ane do serwera proxy na nasz, 
		ustalony wcze¶niej adres. Przekierowaniu nie ulegaj± adresy zawieraj±ce 
		adres naszej winetki, tak aby umo¿liwiæ za³adowanie siê obrazków.
		Po przekierowaniu u¿ytkownik ma mo¿liwo¶æ oznaczenia wiadomo¶ci jako 
		przeczytanej, po czym skrypt automatycznie kieruje przegl±darkê na 
		pierwotnie wywo³ywany URL. Wiêcej informacji znajdziesz w pliku
		<TT
CLASS="FILENAME"
>README</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="SQUID-WARN-INSTALL"
>8.4.2. Instalacja</A
></H3
><P
>Zaczynamy od konfiguracji squida (<TT
CLASS="FILENAME"
>squid.conf</TT
>):
<PRE
CLASS="SCREEN"
>redirector_bypass on
redirect_program /sciezka/do/lms-squid-warnings</PRE
>
		które informuj± squida aby dla ka¿dego adresu u¿ywa³ naszego 
		redirectora. Nastêpnie nale¿y skonfigurowaæ redirectora. Otwieramy 
		w naszym ulubionym edytorze plik lms-squid-warnings i praktycznie
		wszystko co mo¿na w nim ustawiæ to:
<PRE
CLASS="SCREEN"
>my $configfile = '/etc/lms/lms.ini';</PRE
>
		Czyli po³o¿enie pliku konfiguracyjnego. Reszta konfiguracji 
		ustawiana jest w <TT
CLASS="FILENAME"
>lms.ini</TT
>, gdzie dopisujemy sekcjê 
		<TT
CLASS="FILENAME"
>[squid-warnings]</TT
> i definiujemy adres winetki:
<PRE
CLASS="SCREEN"
>[squid-warnings]
redirect        = http://nasz.serwer.pl/winetka/</PRE
>
		Do katalogu gdzie ma byæ widoczna winetka kopiujemy pliki
		<TT
CLASS="FILENAME"
>index.php, message.html</TT
> i zawarto¶æ katalogu 
		<TT
CLASS="FILENAME"
>img</TT
>.</P
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="FAQ"
></A
>Rozdzia&#322; 9. FAQ</H1
><DIV
CLASS="QANDASET"
><DL
><DT
>9.1. <A
HREF="#Q1"
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Co zrobiæ gdy nie generuje siê mapa sieci?</B
></SPAN
></A
></DT
><DT
>9.2. <A
HREF="#Q2"
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Jak dodaæ dwa komputery z tym samym adresem IP?</B
></SPAN
></A
></DT
><DT
>9.3. <A
HREF="#Q3"
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Jak dodaæ dwa komputery z tym samym adresem MAC?</B
></SPAN
></A
></DT
><DT
>9.4. <A
HREF="#Q4"
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Co oznacza b³±d <SAMP
CLASS="PROMPT"
>Can't locate Config/IniFiles.pm in @INC ...</SAMP
>?</B
></SPAN
></A
></DT
><DT
>9.5. <A
HREF="#Q5"
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Zrobiem parê poprawek. Jak mogê dodaæ je do LMSa?</B
></SPAN
></A
></DT
><DT
>9.6. <A
HREF="#Q6"
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Która wersja LMSa jest najnowsza?</B
></SPAN
></A
></DT
></DL
><DIV
CLASS="QANDAENTRY"
><DIV
CLASS="QUESTION"
><P
><A
NAME="Q1"
></A
><B
>9.1. </B
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Co zrobiæ gdy nie generuje siê mapa sieci?</B
></SPAN
></P
></DIV
><DIV
CLASS="ANSWER"
><P
><B
> </B
>Pierwsze co nale¿y sprawdziæ, to logi serwera www. 
		Najczê¶ciej pomaga zwiêkszenie parametru <SAMP
CLASS="PROMPT"
>memory_limit</SAMP
>
		w <TT
CLASS="FILENAME"
>php.ini</TT
>.</P
></DIV
></DIV
><DIV
CLASS="QANDAENTRY"
><DIV
CLASS="QUESTION"
><P
><A
NAME="Q2"
></A
><B
>9.2. </B
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Jak dodaæ dwa komputery z tym samym adresem IP?</B
></SPAN
></P
></DIV
><DIV
CLASS="ANSWER"
><P
><B
> </B
>Nie ma takiej mo¿liwo¶ci. Co wiêcej, autorzy nie przewiduj±
		takiej funkcjonalno¶ci w najbli¿szej przysz³o¶ci. Jednak masz jeszcze
		szansê skorzystaæ z patch'a <SAMP
CLASS="PROMPT"
>multiip</SAMP
> znajduj±cego
		siê w <SAMP
CLASS="PROMPT"
>contrib</SAMP
>.</P
></DIV
></DIV
><DIV
CLASS="QANDAENTRY"
><DIV
CLASS="QUESTION"
><P
><A
NAME="Q3"
></A
><B
>9.3. </B
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Jak dodaæ dwa komputery z tym samym adresem MAC?</B
></SPAN
></P
></DIV
><DIV
CLASS="ANSWER"
><P
><B
> </B
>A dokumentacjê przejrza³e¶? Do tego s³u¿y opcja <SAMP
CLASS="PROMPT"
>		allow_mac_sharing = 1</SAMP
>.</P
></DIV
></DIV
><DIV
CLASS="QANDAENTRY"
><DIV
CLASS="QUESTION"
><P
><A
NAME="Q4"
></A
><B
>9.4. </B
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Co oznacza b³±d <SAMP
CLASS="PROMPT"
>Can't locate Config/IniFiles.pm in @INC ...</SAMP
>?</B
></SPAN
></P
></DIV
><DIV
CLASS="ANSWER"
><P
><B
> </B
>Prawdopodobnie nie masz zainstalowanych wymaganych modu³ow 
		Perla, w tym wypadku chodzi o <TT
CLASS="FILENAME"
>Config::IniFiles</TT
>.
		Najwygodniejszym sposobem instalacji modu³ów jest skorzystanie z CPANu
		w nastêpuj±cy sposób: 
		<SAMP
CLASS="PROMPT"
>perl -MCPAN -e 'install Config::IniFiles'</SAMP
>.</P
></DIV
></DIV
><DIV
CLASS="QANDAENTRY"
><DIV
CLASS="QUESTION"
><P
><A
NAME="Q5"
></A
><B
>9.5. </B
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Zrobiem parê poprawek. Jak mogê dodaæ je do LMSa?</B
></SPAN
></P
></DIV
><DIV
CLASS="ANSWER"
><P
><B
> </B
>Poprawki najlepiej zg³aszaæ na listê mailingow±. Do wiadomo¶ci,
		z krótkim opisem poprawki, nale¿y do³±czyæ diff'a (najlepiej do aktualnej
		wersji cvs'owej), którego mo¿na wykonaæ w nastêpuj±cy sposób:
<PRE
CLASS="SCREEN"
>$ cd lms
$ cvs -z7 diff -u &#62; /tmp/moja_latka.patch</PRE
>
		Je¿eli jeste¶ zainteresowany do³±czeniem do grona developerów
		i otrzymaniem praw zapisu do CVSu zg³o¶ tak± chêæ na listê. Wcze¶niej
		jednak powiniene¶ siê daæ poznaæ na li¶cie jako odpowiedzialna 
		i kompetentna osoba np. przysy³aj±c popraweki.</P
></DIV
></DIV
><DIV
CLASS="QANDAENTRY"
><DIV
CLASS="QUESTION"
><P
><A
NAME="Q6"
></A
><B
>9.6. </B
><SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>Która wersja LMSa jest najnowsza?</B
></SPAN
></P
></DIV
><DIV
CLASS="ANSWER"
><P
><B
> </B
>Wersje LMSa s± numerowane analogicznie do j±dra Linuksa. 
		I tak w LMS-x.y.z mamy: x - g³ówny numer wersji, y - jak parzysty
		to wersja stabilna, jak nieparzysty to rozwojowa (niestabilna), 
		z - mniej istotny numer podwersji. W zwi±zku z tym, je¶li uka¿e siê 
		wersja stabilna np. 1.4.0, to w tej ga³êzi (1.4) nie bêdzie ju¿ dodawana
		nowa funkcjonalno¶æ, bêd± usuwane tylko ewentualne b³êdy. Jednocze¶nie
		powstaje wersja rozwojowa 1.5.x, która przez dodanie nowych rzeczy,
		mo¿e byæ niestabilna/nie dzia³aj±ca prawid³owo.</P
><P
>Archiwum wszystkich wersji LMS znajduje siê pod adresem
		<A
HREF="http://lms.rulez.pl/download/"
TARGET="_top"
>lms.rulez.pl/download</A
></P
></DIV
></DIV
></DIV
></DIV
></DIV
></BODY
></HTML
>
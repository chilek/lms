<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>LMS - LAN Management System 1.5-cvs</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="../images/style.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=ISO-8859-1"></HEAD
><BODY
CLASS="BOOK"
BGCOLOR="#EBE4D6"
TEXT="#000000"
><DIV
CLASS="BOOK"
><A
NAME="AEN1"
></A
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>LMS - LAN Management System 1.5-cvs</A
></H1
><DIV
CLASS="MEDIAOBJECT"
><P
><IMG
SRC="../images/logo-small.png"></P
></DIV
><H3
CLASS="CORPAUTHOR"
> LMS Developers</H3
><P
CLASS="COPYRIGHT"
>Copyright &copy; 2001-2005  LMS Developers</P
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
>1. <A
HREF="#INTRO"
>Intro</A
></DT
><DD
><DL
><DT
>1.1. <A
HREF="#ABOUT-LMS"
>About LMS</A
></DT
><DT
>1.2. <A
HREF="#AUTHORS"
>Authors</A
></DT
><DT
>1.3. <A
HREF="#LEGALNOTICE"
>Legal Notice</A
></DT
><DT
>1.4. <A
HREF="#MOREINFO"
>Other Information</A
></DT
></DL
></DD
><DT
>2. <A
HREF="#INSTALL"
>Installation and configuration</A
></DT
><DD
><DL
><DT
>2.1. <A
HREF="#INSTALL-INTRO"
>Intro</A
></DT
><DT
>2.2. <A
HREF="#INSTALL-REQUIREMENTS"
>Requirements</A
></DT
><DT
>2.3. <A
HREF="#INSTALL-INSTALL"
>LMS Installation</A
></DT
><DT
>2.4. <A
HREF="#INSTALL-DB"
>Database Server Installation</A
></DT
><DT
>2.5. <A
HREF="#INSTALL-CONFIG"
>Basic Configuration</A
></DT
><DT
>2.6. <A
HREF="#INSTALL-RIGHTS"
>Access rights</A
></DT
><DT
>2.7. <A
HREF="#INSTALL-UPGRADE"
>Upgrade</A
></DT
><DT
>2.8. <A
HREF="#INSTALL-INVOICES"
>Invoices</A
></DT
></DL
></DD
><DT
>3. <A
HREF="#DAEMON"
>A.L.E.C's LMS Daemon</A
></DT
><DD
><DL
><DT
>3.1. <A
HREF="#DAEMON-INTRO"
>Basics</A
></DT
><DT
>3.2. <A
HREF="#DAEMON-MODULES"
>Modules</A
></DT
></DL
></DD
></DL
></DIV
><DIV
CLASS="LOT"
><DL
CLASS="LOT"
><DT
><B
>List of Tables</B
></DT
><DT
>3-1. <A
HREF="#AEN794"
>List of almsd daemon modules</A
></DT
></DL
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="INTRO"
></A
>Chapter 1. Intro</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="ABOUT-LMS"
>1.1. About LMS</A
></H2
><P
>"LMS" (LAN Management System) is a package of applications in PHP, Perl and C
          for managing LANs with MySQL, PostgreSQL or SQLite databases support. The main goal is 
          to get the best service of customers at high provider's level. The main features in LMS 
          are:</P
><UL
><LI
><P
>database of customers (name, surname, address, phone numbers, commentary and other),</P
></LI
><LI
><P
>database of computers (IP, MAC),</P
></LI
><LI
><P
>easy-ridden financial system and funds of network,</P
></LI
><LI
><P
>financial balances and invoices</P
></LI
><LI
><P
>sending e-mail warnings to users,</P
></LI
><LI
><P
>automatic billing,</P
></LI
><LI
><P
>generating of (almost) any kind of config file (i.e.
               ipchains/iptables based firewall script, dhcp daemon configuration,
               zone file for bind, static arp entries, oident, htb and more...)</P
></LI
><LI
><P
>visualization of internet link usage stats,</P
></LI
><LI
><P
>request tracker system (Helpdesk),</P
></LI
><LI
><P
>timetable (organizer).</P
></LI
></UL
><P
>All stuff was invented for administration of <A
HREF="http://www.netx.waw.pl/"
TARGET="_top"
>ASK NetX</A
> 
          and there is still developed and tested.</P
><P
>LMS will not replace your administrator's skills. If you can't make
          so simple activity like installation or configuration, probably you'll cannot
          adjust LMS for your system. So, you must have knowledge about administration of 
          UNIX systems.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="AUTHORS"
>1.2. Authors</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="LMS"
>1.2.1. LMS Developers</A
></H3
><UL
><LI
><P
>PHP Code:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://www.baseciq.org"
TARGET="_top"
>Lukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
>Michal 'DziQs' Zapalski</TD
></TR
><TR
><TD
><A
HREF="http://debian.black.pl"
TARGET="_top"
>Radoslaw 'Warden' Antoniuk</A
></TD
></TR
><TR
><TD
>Krzysztof 'hunter' Drewicz</TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Krol</A
></TD
></TR
><TR
><TD
><A
HREF="http://alec.pl"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>C Code:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://alec.pl"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Krol</A
></TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>Perl Code:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>Lukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
>Michal 'DziQs' Zapalski</TD
></TR
><TR
><TD
>Maciej 'agaran' Pijanka</TD
></TR
><TR
><TD
>Krzysztof 'hunter' Drewicz</TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>Design:
              <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>Lukasz 'Baseciq' Mozer</A
></TD
></TR
></TBODY
></TABLE
>
              </P
></LI
><LI
><P
>HTML, JavaScript, CSS:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>Lukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
><A
HREF="http://plug.atn.pl/~bober/"
TARGET="_top"
>Pawel 'Bob_R' Czerski</A
></TD
></TR
><TR
><TD
><A
HREF="http://gamechannel.int.pl"
TARGET="_top"
>Pawel 'sickone' Kisiela</A
></TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>Images:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://pierzak.melanz.org"
TARGET="_top"
>Piotr 'Pierzak' M.</A
></TD
></TR
><TR
><TD
><A
HREF="http://byko.pawlacz.net"
TARGET="_top"
>Grzegorz 'byko' Cichowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.kflis.net"
TARGET="_top"
>Kuba 'kflis' Flis</A
></TD
></TR
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>Lukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
><A
HREF="http://jimmac.musichall.cz"
TARGET="_top"
>Jakub 'Jimmac' Steiner</A
></TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>MySQL Support:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://s.atn.pl"
TARGET="_top"
>Kuba 'shasta' Jankowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://debian.black.pl"
TARGET="_top"
>Radoslaw 'Warden' Antoniuk</A
></TD
></TR
><TR
><TD
>Przemys³aw Babinski</TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>PostgreSQL &#38; SQLite Support:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://alec.pl"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>WWW Page &#38; Documentation:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://alec.pl"
TARGET="_top"
>Aleksander 'A.L.E.C' Machniak</A
></TD
></TR
><TR
><TD
><A
HREF="http://s.atn.pl"
TARGET="_top"
>Kuba 'shasta' Jankowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.rednet.krakow.pl/~jabbas/"
TARGET="_top"
>Grzegorz 'JaBBaS' Dziegielewski</A
></TD
></TR
><TR
><TD
><A
HREF="http://wwww.baseciq.org"
TARGET="_top"
>Lukasz 'Baseciq' Mozer</A
></TD
></TR
><TR
><TD
><A
HREF="http://www.lexx.w.pl"
TARGET="_top"
>Marcin 'Lexx' Krol</A
></TD
></TR
></TBODY
></TABLE
>
               </P
></LI
><LI
><P
>Betatesting:
               <TABLE
BORDER="0"
><TBODY
><TR
><TD
><A
HREF="http://byko.pawlacz.net"
TARGET="_top"
>Grzegorz 'byko' Cichowski</A
></TD
></TR
><TR
><TD
><A
HREF="http://debian.black.pl"
TARGET="_top"
>Radoslaw 'Warden' Antoniuk</A
></TD
></TR
><TR
><TD
>Tomasz 'dzwonek' Dzwonkowski</TD
></TR
><TR
><TD
>Sebastian 'Victus' Frasunkiewicz</TD
></TR
><TR
><TD
><A
HREF="http://www.kflis.net"
TARGET="_top"
>Kuba 'kflis' Flis</A
></TD
></TR
><TR
><TD
>Krystian 'UFOczek' Kochanowski</TD
></TR
><TR
><TD
><A
HREF="http://www.rednet.krakow.pl/~jabbas/"
TARGET="_top"
>Grzegorz 'JaBBaS' Dziegielewski</A
></TD
></TR
><TR
><TD
>Andrzej 'chsh' Gradziel</TD
></TR
></TBODY
></TABLE
>
               </P
></LI
></UL
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="OTHERS"
>1.2.2. Others</A
></H3
><P
>LMS uses elements of other software: 
          <A
HREF="http://phpwizard.net/projects/phpMyAdmin/"
TARGET="_top"
>phpMyAdmin</A
>,
          <A
HREF="phpsysinfo.sourceforge.net"
TARGET="_top"
>phpsysinfo</A
>, 
          <A
HREF="florian-amrhein.de/newsportal/index-anglish.php3"
TARGET="_top"
>NewsPortal</A
>, 
          <A
HREF="www.bosrup.com/web/overlib/"
TARGET="_top"
>overLIB</A
>, 
          <A
HREF="www.nirvani.net/software"
TARGET="_top"
>Multipart Mime Email Generator Library</A
>, 
          <A
HREF="www.ros.co.nz/pdf/"
TARGET="_top"
>ezpdf</A
>, 
          <A
HREF="www.softcomplex.com/products/tigra_calendar/"
TARGET="_top"
>Tigra Calendar</A
>,
          Piotr Kleban's polish procedures of number-to-words conversion and
          code examples from <A
HREF="http://www.php.net/manual/"
TARGET="_top"
>          PHP manual</A
>.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="LEGALNOTICE"
>1.3. Legal Notice</A
></H2
><P
>This program is free software; you can redistribute it and/or modify it 
         under the terms of the GNU General Public License as published by the 
         Free Software Foundation; either version 2 of the License, or (at you option) 
         any later version.</P
><P
>This program is distributed in the hope that it will be useful, but 
         WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
         or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License 
         for more details.</P
><P
>You should have received a copy of the GNU General Public License along 
         with this program; if not, write to the Free Software Foundation, Inc., 
         59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</P
><P
>Text of License is <A
HREF="../../COPYING"
TARGET="_top"
>here</A
>.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="MOREINFO"
>1.4. Other Information</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="CONTACT"
>1.4.1. Contact</A
></H3
><P
>Preferably via a mailing list, which you can subscribe sending
               empty e-mail with subject "subscribe lms-en" on address <A
HREF="mailto: ecartis@lists.rulez.pl"
TARGET="_top"
>ecartis@lists.rulez.pl</A
>,
               e-mails are sent on address lms-en@lists.rulez.pl.
               </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="BUGS"
>1.4.2. Ideas and Bugs Advertising</A
></H3
><P
>In order to effectively report bugs or new ideas, best is to subscribe mailing list
               where somebody from authors or users will have a chance to answer
               on questions that are worrying you. Also, available is BTS, where can be
               bugs advertised (needed registration). Reports from BTS going also to mailing list
               so best to subscribe, report bug on BTS, send link on list
               and wait for events evolution. Address of BTS is <A
HREF="http://bts.rulez.pl"
TARGET="_top"
>               http://bts.rulez.pl</A
>.
               </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="LATEST"
>1.4.3. Newest version</A
></H3
><P
>Allways, newest version of LMS can be downloaded from CVS repository
               CVS with help of www interface <A
HREF="http://cvs.rulez.pl/viewcvs.cgi/lms/lms.tar.gz?tarball=1"
TARGET="_top"
>here</A
>,
               or classic (anonymous access, empty password):</P
><PRE
CLASS="SCREEN"
>cvs -d :pserver:cvs@cvs.rulez.pl:/home/cvsroot login
cvs -d :pserver:cvs@cvs.rulez.pl:/home/cvsroot co lms
cvs -d :pserver:cvs@cvs.rulez.pl:/home/cvsroot logout</PRE
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="HISTORY"
>1.4.4. Changelog</A
></H3
><P
>Informations about changes, which was made in all
               versions of LMS are included in file <A
HREF="../../ChangeLog"
TARGET="_top"
>               ChangeLog</A
>.</P
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="INSTALL"
></A
>Chapter 2. Installation and configuration</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="INSTALL-INTRO"
>2.1. Intro</A
></H2
><P
>LMS consist a few modules, body of LMS is <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> 
     (user interface). It is in integrity written in PHP and for work require database 
     (in fact every module require database). Exactly in <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> we perform all 
     actions, the rest of modules is only for automate work of LMS.</P
><P
>LMS is also set of PERL scripts, and exactly these scripts requires 
     to have that language interpreter. If you will want use these scripts, 
     you must have PERL. Among others, scripts allow on monthly counting of subscription fees, 
     or sending of admonitions. It is also <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
>, witch is script too, but
     so much universal that can generate practically any config file and restart 
     service on your server.</P
><P
>At the end it is also <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>A.L.E.C's LMS Daemon</I
></SPAN
>, written in C language, which 
     is assigned (in fact his plugins) for configuration files generation and services restarting. 
     It can be used as replacement or addition of perl scripts.
     It responds for what has been changed in <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> was made also 
     in real.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-REQUIREMENTS"
>2.2. Requirements</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-WWW"
>2.2.1. WWW Server</A
></H3
><P
>Because <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> is written in PHP, necessary is WWW server with interpreter of 
            that language. Perefered server is Apache (<A
HREF="http://www.apache.org"
TARGET="_top"
>www.apache.org</A
>).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-PHP"
>2.2.2. PHP Interpreter</A
></H3
><P
>Interpreter should be in version 4.2.x or higher, but on 4.1.x also
           works fine (but because developers uses 4.2.3 or higher, can't guarante correct work
           with older versions. PHP can be downloaded from page
          <A
HREF="http://www.php.net"
TARGET="_top"
>www.php.net</A
>.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-DB"
>2.2.3. Database Server</A
></H3
><P
>LMS will not work correctly with MySQL versions older than 3.23.xx 
           </P
><P
>LMS also works with PostgreSQL in version 7.3.x or higher.</P
><P
>Cooperation with SQLite database is possible too, but we are tested only version 2.8.11.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-SMARTY"
>2.2.4. Smarty Library</A
></H3
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> require Smarty library(<A
HREF="http://smarty.php.net"
TARGET="_top"
>http://smarty.php.net</A
>)
           in version 2.5.0 or higher (don't use 2.6.4 version).</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-PERL"
>2.2.5. Perl</A
></H3
><P
>If for <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
> will suffice above stuff, for working 
          <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
> and the rest of scripts you will need 
          also Perl and modules for him:
       <UL
><LI
><P
>perl and his basic modules (POSIX, GetOpt::Long);</P
></LI
><LI
><P
>Net::SMTP;</P
></LI
><LI
><P
>Config::IniFiles;</P
></LI
><LI
><P
>DBI;</P
></LI
><LI
><P
>DBD-mysql (if you will use mysql);</P
></LI
><LI
><P
>DBD-pg (if you will use postgres);</P
></LI
><LI
><P
>DBD-SQLite (if you will use SQLite);</P
></LI
></UL
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-REQ-C"
>2.2.6. C Compiler</A
></H3
><P
>If you'll run<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>A.L.E.C's LMS Daemon</I
></SPAN
> is needed
       working C compiler, because daemon is providing only in the form of source code.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-INSTALL"
>2.3. LMS Installation</A
></H2
><P
>LMS in the form of tar.gz archive can be downloaded from project 
          home page (<A
HREF="http://www.lms.rulez.pl"
TARGET="_top"
>www.lms.rulez.pl</A
>),
          afterd that should be extracted and placed in chosen directory (i.e. <TT
CLASS="FILENAME"
>/var/www/lms
          </TT
>) available for server www:
<PRE
CLASS="SCREEN"
>$ cd /var/www
$ wget http://lms.rulez.pl/download/stable/lms-x.x.x.tar.gz
$ tar zxf lms-x.x.x.tar.gz</PRE
>
          </P
><P
>Two kind of LMS packets are available - including Smarty library
          (<TT
CLASS="FILENAME"
>lms-x.x.x+libs.tar.gz</TT
>) and without that library.
          If you haven't got package with libraries, you must get and placed them
          in directory <TT
CLASS="FILENAME"
>lib</TT
>.
<PRE
CLASS="SCREEN"
>$ cd /var/www/lms/lib
$ wget http://smarty.php.net/distributions/Smarty-2.6.0.tar.gz
$ tar zxf Smarty-2.6.0.tar.gz
$ mv Smarty-2.6.0/libs Smarty</PRE
>
          </P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Placement of all directories can be set in section
          <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[directories]</I
></SPAN
> in file <TT
CLASS="FILENAME"
>lms.ini</TT
>.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>Files with configuration (<TT
CLASS="FILENAME"
>sample/lms.ini</TT
> and <TT
CLASS="FILENAME"
>          sample/lms-mgc.ini</TT
>) place in directory <TT
CLASS="FILENAME"
>/etc/lms</TT
>.
          </P
><P
>Exec scripts from directory <TT
CLASS="FILENAME"
>bin</TT
> 
          is preferably to move to directory <TT
CLASS="FILENAME"
>/usr/sbin</TT
>.
          </P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/warning.gif"
HSPACE="5"
ALT="Warning"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Server www must have reading rights on file <TT
CLASS="FILENAME"
>lms.ini</TT
>
          and writing rights on directory <TT
CLASS="FILENAME"
>backup</TT
>. 
          It makes potential drop of system security level.</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-DB"
>2.4. Database Server Installation</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="INSTALL-MYSQL"
>2.4.1. MySQL</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-INTRO"
>2.4.1.1. Intro</A
></H4
><P
>That very popular database is available with majority of Linux distributions. 
               If however you must install it independently, begin from sources downloading 
               from <A
HREF="http://www.mysql.com"
TARGET="_top"
>www.mysql.com</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-SERVER"
>2.4.1.2. MySQL Server Installation</A
></H4
><P
>After extracting, go to directory with MySQL and type sequence
               of commands:
               <PRE
CLASS="SCREEN"
>$ ./configure --prefix=/usr/local/mysql
$ make
$ make install
$ /usr/local/mysql/bin/mysql_install_db
$ chown mysql -R /usr/local/mysql/var
$ /usr/local/mysql/bin/safe_mysqld &#38;
$ /usr/local/mysql/bin/mysqladmin -u root password nowe_has³o</PRE
>
          </P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-DBCREATE"
>2.4.1.3. Create Database</A
></H4
><P
>It is necesserily if you run LMS at the FIRST time. If you are
               upgrading LMS from older version, appropriate notes what to do with database
               stands in ChangeLog file. So, go to directory, in which you've got LMS and
               run mysql's shell:
<PRE
CLASS="SCREEN"
>mysql -u[here enter user with full access rights to database] -p
Enter password:[just enter password:)]
mysql&#62; create database lms;
mysql&#62; grant usage on lms.* to lms@localhost;
mysql&#62; grant select,insert,update,delete,create,alter on lms.* to lms@localhost identified by 'haslo';
mysql&#62; flush privileges;
mysql&#62; use lms;
mysql&#62; source doc/lms.mysql;</PRE
>
          </P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-MYSQL-LMS"
>2.4.1.4. LMS Configuration (lms.ini)</A
></H4
><P
>Because MySQL is default database for LMS, configuration is limited for
               setting in section [database] of file /etc/lms/lms.ini password and user's name:
               <PRE
CLASS="SCREEN"
>user     = lms
password = your_password</PRE
>
              </P
><P
>After that, if LMS can establish connection to database server,
               it is possible get to the system without problems. If in database is no 
               such administrator account, only thing what you'll see
               be form of administrator addition. When you enter correct admin personal
               details, LMS will move you to login page, where at once you can
               use newly created account.
               </P
><P
>Let's stop here, add some stuff to cron, for peace of mind:
               <PRE
CLASS="SCREEN"
>12 4 3,10,17,21,28 * * /usr/bin/mysqldump -u lms --password=your-super-secret-password \
              --add-drop-table --add-locks lms &#62; backups/lms-auto-"$(date +%s)".sql</PRE
>
               </P
><P
>That will create at 4:12 morning, every 3, 10, 17, 21 and 28 day
               of month automagic mysql database backup.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-PGSQL"
>2.4.2. PostgreSQL</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-INTRO"
>2.4.2.1. Intro</A
></H4
><P
>LMS is tested on PostgreSQL 7.3.4 and higher, but because
               special properties of that base are not used, there will be
               no problem with later versions. If you have not instaled PostgreSQL
               server, best solution will be selfhand compilation from
               sources available on <A
HREF="http://www.postgresql.org"
TARGET="_top"
>               www.postgresql.org</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-SERVER"
>2.4.2.2. Installation</A
></H4
><P
>That is a short version of installation procedure, more info
               can be find in postgres documentation. After download and extraction
               go to main directory and run following commands:
               <PRE
CLASS="SCREEN"
>$ ./configure --enable-locale
$ gmake
$ su
$ gmake install
$ adduser postgres
$ mkdir /usr/local/pgsql/data
$ chown postgres /usr/local/pgsql/data
$ su - postgres
$ /usr/local/pgsql/bin/initdb -D /usr/local/pgsql/data
$ /usr/local/pgsql/bin/postmaster -D /usr/local/pgsql/data &#62;logfile 2&#62;&#38;1 &#38;</PRE
>
               </P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-DBCREATE"
>2.4.2.3. Database Creation</A
></H4
><P
>While server is running you can enter finto creation
               of database with name 'lms', which owner will be user with
               login 'lms'.
               <PRE
CLASS="SCREEN"
>$ /usr/local/pgsql/bin/createuser -d -A -P lms
$ /usr/local/pgsql/bin/createdb -E LATIN2 -U lms lms
$ /usr/local/pgsql/bin/psql -d lms -U lms -f /lms/doc/lms.pgsql</PRE
>
          </P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-PGSQL-LMS"
>2.4.2.4. LMS Configuration (lms.ini)</A
></H4
><P
>For LMS default database server is MySQL, so in section
               [database] of file /etc/lms/lms.ini you must set following options:
                  <PRE
CLASS="SCREEN"
>type     = postgres
user     = lms
password = password_entered_while_user_lms_account_creation</PRE
>
              </P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Password's demand depends on configuration of postgres users autentication
                      in <TT
CLASS="FILENAME"
>/usr/local/pgsql/data/pg_hba.conf</TT
>. 
                      By default password is not required.</P
></TD
></TR
></TABLE
></DIV
></P
><P
>After that, if LMS connects to database, you
               can without problems enter to the system. If in database will be not
               administrator's account, only thing what you'll see will be
               form of administrator's account  addition. When you enter correct data
               LMS will move you to login page, when you can use
               newly created account.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-SQLITE"
>2.4.3. SQLite</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-INTRO"
>2.4.3.1. Intro</A
></H4
><P
>This one-file database is commend for speed. Authors define
               that it is 2-3 times faster than MySQL. Furthermore, with properly 
               configuration it's possible to load whole database in to the RAM 
               menory, during this the efficiency highly increases.
               Below is short description of installation.
               Sources can be downloaded from: <A
HREF="http://www.sqlite.org"
TARGET="_top"
>               www.sqlite.org</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-SERVER"
>2.4.3.2. Installation</A
></H4
><P
>Here You can see how to install the SQLite libraries and
               adding this service to PHP database (in PHP 5.0 ver. have SQLite
               built in).
               After unpacking sources go to SQLite directory and type in
               Commands step by step (for example):
               <PRE
CLASS="SCREEN"
>$ ./configure
$ make
$ make install
$ ldconfig
$ pear download http://pecl.php.net/get/SQLite-1.0.2.tgz
$ pear install SQLite-1.0.2.tgz</PRE
>
               Next in php.ini set:
               <PRE
CLASS="SCREEN"
>extension=sqlite.so</PRE
>
               There is option to compile-in SQLite into PHP : <SAMP
CLASS="PROMPT"
>--with-sqlite</SAMP
>.
               </P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-DBCREATE"
>2.4.3.3. Database Creation</A
></H4
><P
>It's necessarily when You running LMS FIRST TIME!
               Go to Yours LMS directory and run SQlite shell:
               <PRE
CLASS="SCREEN"
>$ sqlite -init doc/lms.sqlite /usr/local/lms/lms.db
sqlite&#62; .exit
$ chown 99.98 /usr/local/lms/lms</PRE
>
               </P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="INSTALL-SQLITE-LMS"
>2.4.3.4. LMS Configuration (lms.ini)</A
></H4
><P
>One of the SQLite limits is no authenticity of users, 
               that's why configuration request only setting type and path to
               the database file. In section <TT
CLASS="FILENAME"
>[database]</TT
>
               pliku <TT
CLASS="FILENAME"
>/etc/lms/lms.ini</TT
> set:
               <PRE
CLASS="SCREEN"
>type     = sqlite
database = /usr/local/lms/lms.db</PRE
>
              </P
><P
>Now we can get in to the system. But if in Database is no 
               user account, we will see add user account form.
               </P
></DIV
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-CONFIG"
>2.5. Basic Configuration</A
></H2
><P
>Main configuration file of LMS is <TT
CLASS="FILENAME"
>lms.ini</TT
>,
         which must be placed in directory <TT
CLASS="FILENAME"
>/etc/lms</TT
> or in root
         directory of LMS. It contains configuration options of <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
>
         and all script with exception of <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-MGC</I
></SPAN
>.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Remember to remove semicolons from begining of line
         with seted parameter.</P
></TD
></TR
></TABLE
></DIV
></P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-CONFIG-DB"
>2.5.1. Section [database] - Database Settings</A
></H3
><P
>         <UL
><LI
><P
>type</P
><P
>Database type. Actually in 100% supported is 'mysql', but for the time being
        isn't seen problems with 'postgres' and 'sqlite'. Default: mysql</P
><P
>Example: <SAMP
CLASS="PROMPT"
>type = mysql</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Host where database is installed. Most often, localhost, but can 
        here set anything (IP, domain, path to socket in format 'localhost:/path/to/socket'). 
        Default: localhost</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>host = localhost</SAMP
></P
></LI
><LI
><P
>user</P
><P
>Name of database user account. In many cases (if you've go by documentation) 
        that will be 'lms'. When you'll want to use privileged account, 
        probably you'll enter 'root' (MySQL on most of *nixes), 'mysql' (on PLD) or
        'postgres' (PostgreSQL). Default: mysql</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>user = lms</SAMP
></P
></LI
><LI
><P
>password</P
><P
>Database password. Default: empty.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>password = password</SAMP
></P
></LI
><LI
><P
>database</P
><P
>Name of database (for SQLite path to database file). Default: lms.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>database = lms</SAMP
></P
></LI
><LI
><P
>server_encoding</P
><P
>Database encoding. Use if your database encoding is not unicode.
	Postgres is taking up conversion by himself, but in case of
	mysql for conversion is used php/iconv in LMS db-drivers.
	Default: unicode.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>server_encoding = latin2</SAMP
></P
></LI
></UL
>
     </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-CONFIG-DIR"
>2.5.2. Section [directories] - Directories Settings</A
></H3
><P
>        
     <UL
><LI
><P
>sys_dir</P
><P
>System directory. It is a place where is entire content of LMS's UI, that means index.php, graphics, 
        templates and the rest. By default index.php seek in filesystem 
        using getcwd(), but better is to say him where hi is:</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>sys_dir = /var/www/htdocs/lms/</SAMP
></P
></LI
><LI
><P
>modules_dir</P
><P
>Directory with "modules" of LMS. That is content of /modules directory. By default 
        it is subdirectory <TT
CLASS="FILENAME"
>modules</TT
> in sys_dir.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>modules_dir = /usr/share/lms/modules/</SAMP
></P
></LI
><LI
><P
>lib_dir</P
><P
>Directory with "libraries" of LMS. That is content of /lib directory. By default 
        it is subdirectory <TT
CLASS="FILENAME"
>lib</TT
> in sys_dir.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>lib_dir = /usr/share/lms/lib/</SAMP
></P
></LI
><LI
><P
>backup_dir</P
><P
>Directory for database backup files - place where LMS write database snapshots. 
        By default it is subdirectory <TT
CLASS="FILENAME"
>backups</TT
> in sys_dir.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>backup_dir = /var/backup/lms/</SAMP
></P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/warning.gif"
HSPACE="5"
ALT="Warning"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>If directory with backups will be accessible from WWW level, 
        then anybody will can to access them without authorization.</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>smarty_dir</P
><P
>Directory with Smarty library - By default, subdirectory <TT
CLASS="FILENAME"
>Smarty</TT
> in lib_dir.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>smarty_dir = /usr/lib/php/Smarty</SAMP
></P
></LI
><LI
><P
>smarty_compile_dir</P
><P
>Smarty's compilation directory. Place where Smarty compile templates. By default  
        it is subdirectory <TT
CLASS="FILENAME"
>templates_c</TT
> in sys_dir.</P
><P
>Example:      <SAMP
CLASS="PROMPT"
>smarty_compile_dir = /var/smarty/compile/lms</SAMP
></P
></LI
><LI
><P
>smarty_templates_dir</P
><P
>Directory with Smarty's templates. By default it is subdirectory <TT
CLASS="FILENAME"
>templates</TT
>
        in sys_dir.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>smarty_templates_dir = /usr/share/lms/templates</SAMP
></P
></LI
></UL
>
     </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-CONFIG-UI"
>2.5.3. Section [phpui] - Interface Setting</A
></H3
><UL
><LI
><P
>allow_from  (optional)</P
><P
>Lis of networks and IP addresses, which have access to LMS. If empty, every IP address has 
             access to LMS. When you write here list of addresses or address classes,
             LMS dismiss every unwanted user with HTTP 403 error.</P
><P
>Example:          <SAMP
CLASS="PROMPT"
>allow_from = 192.168.0.0/16, 213.25.209.224/27, 213.241.77.29</SAMP
></P
></LI
><LI
><P
>lang</P
><P
>User interface language symbol. When is not set, language will be based on
         html browser settings. Default: en.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>lang = pl</SAMP
></P
></LI
><LI
><P
>timeout</P
><P
>Timeout of www session. After that time (in seconds) user will be log out if 
         not take some action. Default: 600.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>timeout = 900</SAMP
></P
><P
><DIV
CLASS="WARNING"
><TABLE
CLASS="WARNING"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/warning.gif"
HSPACE="5"
ALT="Warning"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>There is not possible to set no timeout. If you set this value
         on zero, you'll can't use LMS!</P
></TD
></TR
></TABLE
></DIV
></P
></LI
><LI
><P
>customerlist_pagelimit</P
><P
>Limit of displayed positions on one page on customers list. Default: no limit.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>customerlist_pagelimit = 10</SAMP
></P
></LI
><LI
><P
>nodelist_pagelimit</P
><P
>Limit of displayed records on page on nodes list. Default: no limit.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>nodelist_pagelimit = 10</SAMP
></P
></LI
><LI
><P
>balancelist_pagelimit</P
><P
>Limit of displayed records on page on user's balance. Default: 100.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>balancelist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>invoicelist_pagelimit</P
><P
>Limit of displayed records on page on invoices list. Default: 100</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>invoicelist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>ticketlist_pagelimit</P
><P
>Limit of displayed records on page on tickets (requests) list. Default: 100</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>ticketlist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>networkhosts_pagelimit</P
><P
>Limit of displayed nodes on one page in Network Information. Default: 256</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>networkhosts_pagelimit = 1024</SAMP
></P
></LI
><LI
><P
>accountlist_pagelimit</P
><P
>Limit of displayed records on page on accounts list. Default: 100</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>accountlist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>domainlist_pagelimit</P
><P
>Limit of displayed records on page on domains list. Default: 100</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>domainlist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>aliaslist_pagelimit</P
><P
>Limit of displayed records on page on aliases list. Default: 100</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>aliaslist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>configlist_pagelimit</P
><P
>Limit of displayed records on page on UI config options list. Default: 100</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>configlist_pagelimit = 50</SAMP
></P
></LI
><LI
><P
>reload_type</P
><P
>Reload type. Allowed values:</P
><P
>exec - calling of some command (most often with sudo, some script or something
         else, configurable below)</P
><P
>sql  - doing SQL writes (also can be set concrete query)</P
><P
>Default: sql.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>reload_type = exec</SAMP
></P
></LI
><LI
><P
>reload_execcmd</P
><P
>Command to run during reload, if reload_type is set to 'exec'. By default
         <TT
CLASS="FILENAME"
>/bin/true</TT
>. That string is send to command system(), so I propose consideration 
         what you do and how :) Altogether, semicolons should be parsed by bash, but
         LMS splits that string and execute commands singly.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>reload_execcmd = "sudo /usr/bin/reload_lms.sh"</SAMP
></P
></LI
><LI
><P
>reload_sqlquery</P
><P
>SQL query executed while reload, if <SAMP
CLASS="PROMPT"
>reload_type = sql</SAMP
>.  
         By default, query inserts into table 'timestamps' value '_force'. In query can be used
         '%TIME%' as replacement to current unix timestamp. WARNING! Semicolon is handled by
         a queries separator, that means you can enter couple of SQL queries separate them by
         semicolon sign.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>reload_sqlquery = "INSERT INTO reload VALUES ('1','%TIME%')"</SAMP
></P
></LI
><LI
><P
>force_ssl</P
><P
>SSL Enforcing. Setting this option to 1 will make that LMS will enforce SSL connection 
         doing redirect to 'https://'.$_SERVER[HTTP_HOST].$_SERVER[REQUEST_URI] at every access
         without SSL. Default: 0 (off).</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>force_ssl = 1</SAMP
></P
></LI
><LI
><P
>allow_mac_sharing</P
><P
>Permission for addition of nodes with duplicated MAC address (not checking
         that some computer have that MAC yet). Default: 0 (off)</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>allow_mac_sharing = 1</SAMP
></P
></LI
><LI
><P
>smarty_debug</P
><P
>Enable Smarty's debug console. Usefull for tracking values passed from PHP 
         to Smarty. Default: 0 (off).</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>smarty_debug = 1</SAMP
></P
></LI
><LI
><P
>lang_debug</P
><P
>Enable LMS language console. Usefull for tracking missing translation strings.
         Default: 0 (off).</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>lang_debug = 1</SAMP
></P
></LI
><LI
><P
>debug_email</P
><P
>E-mail address for debugging - at this address will goes messages sended from madule 'Mailing', 
         instead of proper users.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>debug_email = root@localhost</SAMP
></P
></LI
><LI
><P
>default_zip, default_city, default_address</P
><P
>Default zip code, city, street, used while inserting of new user.
         Useful when we have many users on the same street.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>default_zip = 39-300</SAMP
></P
></LI
><LI
><P
>use_current_payday</P
><P
>Qualify to use current day of month for payment day
         instead of most often used day. Default: 0 (off).</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>use_current_payday = 1</SAMP
></P
></LI
><LI
><P
>lastonline_limit</P
><P
>Specify time (in seconds), after which node will be treated
         as inactive. It should match with frequency of running script inspecting
         nodes activity (i.e. lms-fping). Default: 600.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>lastonline_limit = 300</SAMP
></P
></LI
><LI
><P
>timetable_days_forward</P
><P
>Specify number of days (including current day) on timetable.
         Default: 7.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>timetable_days_forward = 2</SAMP
></P
></LI
><LI
><P
>arpd_servers</P
><P
>List of arpd servers for reading of MAC addresses from remote networks.
         That list should include items IP[:port] separated with spaces.
         Default: empty.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>arpd_servers = 192.168.1.1 192.168.2.1</SAMP
></P
></LI
><LI
><P
>helpdesk_backend_mode</P
><P
>When enabled, all messages in helpdesk system (except sended to requestor)
         will be send to mail server at address of right queue.
         On server should be running script lms-rtparser, which will write
         messages to database. Default: disabled.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>helpdesk_backend_mode = On</SAMP
></P
></LI
><LI
><P
>helpdesk_sender_name</P
><P
>Name of message sender or predefined values: 'queue' - ticket's queue name,
	 'user' - name of logged user (sender). Default: empty.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>helpdesk_sender_name = Helpdesk</SAMP
></P
></LI
><LI
><P
>contract_template</P
><P
>Specify customer contract template. Can include comma separated 
         list of contract templates. Default: contract.html.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>contract_template = "../my_templates/contract.html"</SAMP
></P
><P
>Example:     <SAMP
CLASS="PROMPT"
>contract_template = "contract.html:Default Contract, file.html:Contract Plus"</SAMP
></P
></LI
><LI
><P
>to_words_short_format</P
><P
>Specify format of verbal amounts representation (on invoices). For value "1"
         verbal expand of 123,15 will be "one two thr 15/100". Default: 0.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>to_words_short_format = 1</SAMP
></P
></LI
><LI
><P
>nodepassword_length</P
><P
>Length of (auto-generated) node password. Max.32. Default: 16.</P
><P
>Example:     <SAMP
CLASS="PROMPT"
>nodepassword_length = 8</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-RIGHTS"
>2.6. Access rights</A
></H2
><DIV
CLASS="SECT2"
><H3
CLASS="SECT2"
><A
NAME="INSTALL-RIGHTS-IDEA"
>2.6.1. Idea</A
></H3
><P
>LMS may define up to 256 rules of access to the system. 
      Each can forbid or permit access to definite modules. 
      To each user we can freely assign combination of access rules.</P
><P
>By default following access rules list is defined:
       <UL
><LI
><P
>full access</P
></LI
><LI
><P
>read only (excluding Helpdesk)</P
></LI
><LI
><P
>nodes connection/disconnection</P
></LI
><LI
><P
>finances management</P
></LI
><LI
><P
>configuration reload</P
></LI
><LI
><P
>customers management</P
></LI
><LI
><P
>nodes management</P
></LI
><LI
><P
>stats access</P
></LI
><LI
><P
>mailing access</P
></LI
><LI
><P
>Helpdesk (RT) administration</P
></LI
><LI
><P
>Helpdesku (RT) operation</P
></LI
><LI
><P
>accounts management</P
></LI
><LI
><P
>UI configuration</P
></LI
><LI
><P
>networks and devices management</P
></LI
><LI
><P
>timetable management</P
></LI
><LI
><P
>users edition and addition forbidden</P
></LI
><LI
><P
>no access</P
></LI
></UL
>
      Some of them permit access to modules and two forbid. Modules that user
      has always access is: welcome, copyrights,  logout, chpasswd 
      (chpasswd can change only own password), access to others is defined by rules.</P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>If we do not define to user any access rule, then LMS implicitly define 
      rule 0 for him - full access.</P
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-RIGHTS-HOW"
>2.6.2. How does it work?</A
></H3
><P
> Decision if user have right to access to module or not, looks like this:          
          <TABLE
BORDER="0"
><TBODY
><TR
><TD
>-  First of all: checking list of modules that user always have access.</TD
></TR
><TR
><TD
>-  Next:  checking if module mach to rules in each levels that user
          have access.</TD
></TR
><TR
><TD
>-  Finally: Decision if user have authorizations to access to modules. If module 
          mach to any level that forbid access then access will be forbiden even if user have 
          level that permit access to module. (for example. Someone have full access and no access 
          to adding computer module then he would not be able to appeal to this module). 
          If module  maches to level that permit access to module. Then LMS permit farther work. 
          But if module does not match on any level then also will be printed no-access-msg.</TD
></TR
></TBODY
></TABLE
>
          </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-UPGRADE"
>2.7. Upgrade</A
></H2
><P
>LMS upgrade process in two stages. First make directory of new version 
      (overwriting old files with new ones is not recommended) then we have to make 
      some changes in database.</P
><P
>For easy migration of data in catalog<TT
CLASS="FILENAME"
>/doc</TT
>
      we prepared file:<TT
CLASS="FILENAME"
>UPGRADE-1.0-1.5.mysql</TT
> and 
      <TT
CLASS="FILENAME"
>UPGRADE-1.0-1.5.pgsql</TT
> for upgrade from 1.0 to 1.5 version. 
      Also <TT
CLASS="FILENAME"
>UPGRADE-1.2-1.5.mysql</TT
> and <TT
CLASS="FILENAME"
>UPGRADE-1.2-1.5.pgsql
      </TT
> For migration from version 1.3 (and 1.3.0) to current  version. In those 
      files you can find short description how to upgrade in dependence of used database. 
      In versions 1.3.0 and higher upgrade of database structure is automatically 
      executed while first logon.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>In 1.0.x and higher versions ADOdb library Is not required, 
      you can remove applicable directory from <TT
CLASS="FILENAME"
>lib/</TT
> directory.</P
></TD
></TR
></TABLE
></DIV
></P
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="INSTALL-INVOICES"
>2.8. Invoices</A
></H2
><P
>In LMS is possible automatic and manual invoices settlement. Manual invoices
		creation is is possible in 'New Invoice' module from 'Finances' menu. Automatic settlement 
		need to enable that option while liabilities ascribing to customers. In that case
		invoices are created while accounting by <TT
CLASS="FILENAME"
>lms-payments</TT
> script or 
		daemon <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>almsd</I
></SPAN
>.</P
><P
>For proper working and printouts you will need to set custom options 
		in section <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[invoices]</I
></SPAN
> of <TT
CLASS="FILENAME"
>lms.ini</TT
>:
		<UL
><LI
><P
>number_template</P
><P
>Invoice number pattern. Accessible variables: '%N' - successive number in year/month,
			'%M' - settlement month number, '%Y' - settlement year number (four digits). Default: %N/LMS/%Y</P
><P
>Example: <SAMP
CLASS="PROMPT"
>number_template = %N/%Y</SAMP
></P
></LI
><LI
><P
>monthly_numbering</P
><P
>Enable this option when you need to reset invoice numbering on start of every month.
			Default: disabled</P
><P
>Example: <SAMP
CLASS="PROMPT"
>monthly_numbering = 1</SAMP
></P
></LI
><LI
><P
>header</P
><P
>Seller. Can use string "\n" for lines separation. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>header = "SuperNet ISP\nNew Street 15\n12-000 City\n"</SAMP
></P
></LI
><LI
><P
>footer</P
><P
>Invoice footer - e.g. seller description. Footer will be placed at bottom of a invoice, small font. Like in header option use "\n" to separate lines. Default: empty</P
><P
>Example: <SAMP
CLASS="PROMPT"
>footer = "Internet Service Provider K-27, phone 555-23-23, etc."</SAMP
></P
></LI
><LI
><P
>default_author</P
><P
>Invoice settler. Default: empty</P
><P
>Example: <SAMP
CLASS="PROMPT"
>default_author = "invoicing expert"</SAMP
></P
></LI
><LI
><P
>cplace</P
><P
>Invoice settlement place (city). Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>cplace = Warsaw</SAMP
></P
></LI
></UL
>
		Generated invoices can be viewed in double ways: by printer icon on balance sheet 
		or by 'Invoices List' in 'Finances' menu. In second case, is also possible to 
		filter invoices for printing.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-INVOICES-HTML"
>2.8.1. HTML</A
></H3
><P
>With default settings invoices are printed in html format
		with use of default template. In <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[invoices]</I
></SPAN
> section
		are also options:
		<UL
><LI
><P
>template_file</P
><P
>Invoice template, which should be placed in 
			<TT
CLASS="FILENAME"
>templates</TT
> directory. Default: invoice.html.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>template_file = invoice-mynet.html</SAMP
></P
></LI
><LI
><P
>content_type</P
><P
>Invoice content-type. If you enter here 'application/octet-stream'
			then browser will send file to save on disk, instead of displaying it.
			It's useful if you use your own template which generate e.g. rtf or xls file.
			Default: 'text/html'</P
><P
>Example: <SAMP
CLASS="PROMPT"
>content_type = application/octet-stream</SAMP
></P
></LI
><LI
><P
>attachment_name</P
><P
>File name for saving finished invoice printout. WARNING: Setting attachment_name 
			with default content_type will (in case of MSIE) print invoice + prompt for save on 
			disk + bonus browser crash (6.0SP1 on WInXP).
			Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>attachment_name = invoice.xls</SAMP
></P
></LI
></UL
>
		Generated HTML invoice consist originals and copies, which are separated
		by CSS page-break markups. So every modern browser that support CSS 
		should print many-page invoices shallow. This function was tested on
		Microsoft Internet Explorer 6.0, Opera 7.02 and Mozilla 1.3.</P
><P
>			<DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Almost every internet browser has printing 
			configuration, where functions like header and footer or URL 
			printing can be disabled.</P
></TD
></TR
></TABLE
></DIV
>
		</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="INSTALL-INVOICES-PDF"
>2.8.2. PDF</A
></H3
><P
>It's possible to create invoices as pdf files. Setting
		option <TT
CLASS="FILENAME"
>type</TT
> from <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[invoices]</I
></SPAN
> section
		to 'pdf' will make, that invoice will be created in pdf instead of html.
		Option <TT
CLASS="FILENAME"
>template_file</TT
> performs similiar part like in html invoices,
		with one difference, it has predefined values: 'standard' - basic invoice 
		(invoice.html equivalent) and 'FT-0100' - invoice adjusted for printing on
		FT-0100 print including payment form. You can set <TT
CLASS="FILENAME"
>template_file</TT
>
		option for php file name, but this feature is assigned for advanced users.
		because it require creation of more complicated php file than in html invoices 
		simple Smarty template.</P
><P
>Data for printout of payment form are stored in <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>[finances]</I
></SPAN
>
		section of <TT
CLASS="FILENAME"
>lms.ini</TT
> file. That is:
		<TABLE
BORDER="0"
><TBODY
><TR
><TD
>name - seller name</TD
></TR
><TR
><TD
>shortname - short seller name</TD
></TR
><TR
><TD
>address - seller address</TD
></TR
><TR
><TD
>zip - seller postal code</TD
></TR
><TR
><TD
>city - seller city</TD
></TR
><TR
><TD
>account - banking account number</TD
></TR
></TBODY
></TABLE
>
		</P
></DIV
></DIV
></DIV
><DIV
CLASS="CHAPTER"
><HR><H1
><A
NAME="DAEMON"
></A
>Chapter 3. A.L.E.C's LMS Daemon</H1
><DIV
CLASS="SECT1"
><H2
CLASS="SECT1"
><A
NAME="DAEMON-INTRO"
>3.1. Basics</A
></H2
><P
>Written in C program facilitate management of services. Daemon is
         responsible for starting of appropriate modules on user demand only. Modules
         are making configuration files based on data from LMS's database and
         restarting selected services on a server.
         </P
><P
>Why such name? The better part of daemon code was written by one of developers - Aleksander 
     'A.L.E.C' Machniak, nevertheless must underline a contribution of Marcina 'Lexx' Krol. Program
     include fragments of code of Mateusza 'mteg' Golicz's old daemon and use Nicolas Devillard's iniparser
     library.
     </P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-REQUIREMENTS"
>3.1.1. Requirements</A
></H3
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>A.L.E.C's LMS Daemon</I
></SPAN
> require:
                     <UL
><LI
><P
>LMS user interface installation</P
></LI
><LI
><P
><TT
CLASS="FILENAME"
>libmysqlclient</TT
> (full MySQL installation or respective packet) 
                    or <TT
CLASS="FILENAME"
>libpq</TT
> in case of PostgreSQL database or <TT
CLASS="FILENAME"
>sqlite</TT
></P
></LI
><LI
><P
><TT
CLASS="FILENAME"
>libdl</TT
> (that is in every present-day distribution)</P
></LI
><LI
><P
>C compiler</P
></LI
></UL
>
                     </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-INSTALL"
>3.1.2. Installation</A
></H3
><P
>Prior to compilation you must set options described on following listing
               with help of <TT
CLASS="FILENAME"
>./configure</TT
> script (in brackets are shown
               default values):
<PRE
CLASS="SCREEN"
>  --help                help
  --enable-debug0       SQL queries logging (disabled)
  --enable-debug1       events logging (disabled)
  --with-pgsql          enables using of PostgreSQL database (disabled)
  --with-mysql          enables using of MySQL database (enabled)
  --with-sqlite         enables using of SQLite database (disabled)
  --prefix=DIR          program install directory (/usr/local/bin)
  --libdir=DIR          location of database libraries (/usr/lib)
  --incdir=DIR          location of database header files (/usr/include)</PRE
>
               Then, required is to set database which you will use (--with-mysql 
               or --with-pgsql) and location of libraries supplied with database (--incdir, --libdir).
               You can use only one database. If you will change database, you must to recompile daemon.
<PRE
CLASS="SCREEN"
># ./configure --with-pgsql --libdir=/usr/local/pgsql/lib --incdir=/usr/local/pgsql/include</PRE
>
               After that you can compile and install (put daemon in directory
               given with --prefix option):
<PRE
CLASS="SCREEN"
># make &#38;&#38; make install</PRE
>
               Finally, compiled modules (files with <TT
CLASS="FILENAME"
>.so</TT
> extension),
               found in directory <TT
CLASS="FILENAME"
>modules/module_name</TT
> move to any 
               directory. Their location you will set in configuration file.
               </P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-CONFIG"
>3.1.3. Configuration</A
></H3
><P
>Example daemon configuration you can find in file <TT
CLASS="FILENAME"
>lms.ini.sample</TT
>.
               Following listing describe basic options for daemon (modules configuration is described 
               in separate chapters concerning modules):
<PRE
CLASS="SCREEN"
>[database]
host            = localhost     # host name or IP, default: localhost
user            = lms           # user name, default: lms
password        = mypasswd      # database password, default: empty
database        = lms           # database name, default: lms
port            = 0             # port number, default: 0

[lmsd]
sleeptime       = 30            # time interval (in seconds) how often to
                                # check for reload order, default: 30
instances       = hosts oident firewall       # module instances list
command         = 'echo Connecting...'        # shell command to run before every database connection </PRE
>
               <DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>List of instances contains instances names detached with 
               spaces. Instance is a name of section in configuration file.</P
></TD
></TR
></TABLE
></DIV
>
               </P
><P
>In instance section, beside config modules params, you must specify
               primary options, as on following listing:
<PRE
CLASS="SCREEN"
>[instance_name]
module = /path/to/module.so
info = "Additional description of module"</PRE
>          
               </P
><P
>Change of 'instances' and any option i instances sections do not
               require daemon restart. For other global options restart is required.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-RUN"
>3.1.4. Starting</A
></H3
><P
>You can run program as a daemon working in background (option '-b'). Then
               configuration and services reload is done on demand with use of 
               'Reload' menu in <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>LMS-UI</I
></SPAN
>. Option 'sleeptime' (-s) specify interval
               between database reads. When daemon detects reload order, he runs
               modules defined by 'instances' option in <TT
CLASS="FILENAME"
>lms.ini</TT
>.
               For example:
<PRE
CLASS="SCREEN"
># almsd -b</PRE
>               
               </P
><P
>Other way to run is disposable reload with usage of cron. 
               You must to use this manner of reload for runing modules like 'payments'
               'notify' or 'traffic'. In that case you can specify instances to reload
               with use of option '-i'. Example crontab's entry:
<PRE
CLASS="SCREEN"
>  1 0 * * *    /usr/local/bin/almsd -qi "payments notify"</PRE
>
               </P
><P
>Following listing describe program command line options:
<PRE
CLASS="SCREEN"
>  -c     path to config (default: /etc/lms/lms.ini)
  -i     list of instances (separated by space) to reload
  -b     run in background (daemon mode)
  -s     'reload' table reading interval in sec. (default: 30)
  -q      reload and quit
  -h      prints command line options</PRE
>
               </P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H2
CLASS="SECT1"
><A
NAME="DAEMON-MODULES"
>3.2. Modules</A
></H2
><P
>Daemon can only run modules and they are doing all job. 
     Most of modules are designed to specific application, only 'hostfile' 
     can be used to many different configs (services), i.e. various firewall types. 
     Daemon and modules configuration examples contains file <TT
CLASS="FILENAME"
>daemon/lms.ini.sample</TT
>.
     Modules configuration parameters must be placed in appropriate instances sections.</P
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-MODULESLIST"
>3.2.1. Modules list</A
></H3
><DIV
CLASS="TABLE"
><A
NAME="AEN794"
></A
><P
><B
>Table 3-1. List of almsd daemon modules</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="200"
ALIGN="CENTER"><COL
WIDTH="300"
ALIGN="CENTER"><THEAD
><TR
><TH
>Name</TH
><TH
>Description</TH
></TR
></THEAD
><TBODY
><TR
><TD
><A
HREF="#DAEMON-SYSTEM"
>system</A
></TD
><TD
>Shell commands execution</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-DHCP"
>dhcp</A
></TD
><TD
>Configuration of DHCP server</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-CUTOFF"
>cutoff</A
></TD
><TD
>Disconnection of indebted users</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-DNS"
>dns</A
></TD
><TD
>Configuration of DNS server</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-ETHERS"
>ethers</A
></TD
><TD
>Making of /etc/ethers file</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-HOSTFILE"
>hostfile</A
></TD
><TD
>Universal module (i.e. making iptables rules)</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-NOTIFY"
>notify</A
></TD
><TD
>E-mail notifying users about payments</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-GGNOTIFY"
>ggnotify</A
></TD
><TD
>Gadu-Gadu (polish internet messenger) notifying users about payments</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-PAYMENTS"
>payments</A
></TD
><TD
>Payments accounting</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-OIDENT"
>oident</A
></TD
><TD
>Configuration of oident daemon</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-TC"
>tc</A
></TD
><TD
>Making HTB rules</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-TRAFFIC"
>traffic</A
></TD
><TD
>Internet link usage statistics</TD
></TR
><TR
><TD
><A
HREF="#DAEMON-PINGER"
>pinger</A
></TD
><TD
>Users activity scanning</TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-SYSTEM"
>3.2.2. System</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="SYSTEM-DESC"
>3.2.2.1. Description</A
></H4
><P
>This module doing only one thing. It's executing of given command 
	      of linux shell. It can be usefull when you want to execute some command
	      or run external script while configuration reload, e.g. one of them, 
              which are in LMS <TT
CLASS="FILENAME"
>/bin</TT
> directory.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="SYSTEM-CONFIG"
>3.2.2.2. Configuration</A
></H4
><P
>By reason of above-mentioned you can define only command contents.
              Shell should advise with list of commands separated by semicolons:</P
><UL
><LI
><P
>command</P
><P
>Shell command. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = 'echo "hello"'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-PAYMENTS"
>3.2.3. Payments</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="PAYMENTS-DESC"
>3.2.3.1. Description</A
></H4
><P
>Module accounts customers subscription payments and solid payments. It should 
              be executed commonly once a day. Payments are accounted on base of customers
              liabilities and writed to database with description defined in 'comment' option.
              After accounting are created invoices. Description of solid payment is a 
              mass of its name and creditor name. At the end from database are removed
	      out-of-dated customers liabilities.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="PAYMENTS-CONFIG"
>3.2.3.2. Configuration</A
></H4
><P
>For that module you can use following options:</P
><UL
><LI
><P
>comment</P
><P
>Operation description. '%period' will be replaced by dates from-to 
                   of subscription, e.g. '10.10.2003 - 09.11.2003', and '%tariff' by name
                   of tariff. Default: 'Abonament wg taryfy: '%tariff' za okres: %period'.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>comment = 'Subscription: %tariff for period %period' </SAMP
></P
></LI
><LI
><P
>up_payments</P
><P
>Decision how should be counted period in comment - forward
                   or backward relatively to date of payment accounting. Default: yes.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>up_payments = no</SAMP
></P
></LI
><LI
><P
>expiry_days</P
><P
>Defines number of days from date of liability expiration, after which 
                   that liability will be removed from database. When you set '0' data will be
                   removed immediately after date, for which binds that liability. Default: 30.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>expiry_days = 365</SAMP
></P
></LI
><LI
><P
>deadline</P
><P
>Payment deadline in days. Default: 14.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>deadline = 21</SAMP
></P
></LI
><LI
><P
>paytype</P
><P
>Payment type. Default: 'PRZELEW'.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>paytype = 'CASH'</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-NOTIFY"
>3.2.4. Notify</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="NOTIFY-DESC"
>3.2.4.1. Description</A
></H4
><P
>Module 'notify' is destined to inform customers of debt
              in payments using electronic mail. Current customer balance
              is compared with 'limit' option, if is lower - message will 
	      be sent. Message content is taken from prepared template, which
              can consists following variables:
              <UL
><LI
><P
>%saldo - current customer balance</P
></LI
><LI
><P
>%name - customer forename</P
></LI
><LI
><P
>%lastname - customer name/lastname</P
></LI
><LI
><P
>%last_10_in_a_table - last 10 operations on customer account</P
></LI
></UL
></P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="NOTIFY-CONFIG"
>3.2.4.2. Configuration</A
></H4
><P
>Below are presented configuration options of 'notify' module:</P
><UL
><LI
><P
>template</P
><P
>Location of message template file. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>template = modules/notify/sample/mailtemplate</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Location of temprary file. Default: /tmp/mail</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /tmp/mail.txt</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Shell command for e-maila sending. '%address' will be replaced
                   by customer e-mail address. Default: 'mail -s "Liabilities Information" %address &lt; /tmp/mail'.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = 'mail -s "You must pay or ..." $address &lt; /tmp/mail.txt'</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Message is sended when customer balance will decrease
                   below value defined in that option. Default: 0</P
><P
>Example: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>debug_mail</P
><P
>If set, at this address goes all messages. Useful
                   for testing. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>debug_mail = localhost@my.net</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-GGNOTIFY"
>3.2.5. Ggnotify</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="GGNOTIFY-DESC"
>3.2.5.1. Description</A
></H4
><P
>Equivalent of 'notify' module destined to sending gadu-gadu messages.
	      Gadu-Gadu it's a most popular polish internet messenger.</P
><P
>Module require installed <TT
CLASS="FILENAME"
>libgadu</TT
> library and sources
              of <TT
CLASS="FILENAME"
>ekg</TT
> program. Appropriate paths for them must to be
	      put in <TT
CLASS="FILENAME"
>modules/ggnotify/Makefile</TT
> before module compilation.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="GGNOTIFY-CONFIG"
>3.2.5.2. Configuration</A
></H4
><P
>Podobnie jak w 'notify' masz do dyspozycji nastêpuj±ce zmienne:</P
><UL
><LI
><P
>template</P
><P
>Location of message template file. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>template = modules/notify/sample/mailtemplate</SAMP
></P
></LI
><LI
><P
>uin</P
><P
>Gadu-gadu identifier of message sender. 
                   Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>uin = 1234567</SAMP
></P
></LI
><LI
><P
>password</P
><P
>Password for account specified in 'uin'. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>password = "my_HURD.password"</SAMP
></P
></LI
><LI
><P
>limit</P
><P
>Message is sended when customer balance will decrease
                   below value defined in that option. Default: 0</P
><P
>Example: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>debug_uin</P
><P
>If is set, there will go all messages. Default: empty.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>debug_uin = 7654321</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-CUTOFF"
>3.2.6. Cutoff</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="CUTOFF-DESC"
>3.2.6.1. Description</A
></H4
><P
>Cutoff zmienia status komputerów na 'od³±czony' i/lub w³±cza ostrze¿enia
              u¿ytkownikom, którzy maj± na koncie zaleg³o¶ci wiêksze ni¿ okre¶lony limit. Ten modu³ 
              nie zajmuje siê fizycznym blokowaniem dostêpu do sieci.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="CUTOFF-CONFIG"
>3.2.6.2. Configuration</A
></H4
><P
>Dla modu³u 'cutoff' mamy nastêpuj±ce opcje:</P
><UL
><LI
><P
>limit</P
><P
>Od³±czenie nastêpuje je¶li saldo u¿ytkownika spadnie poni¿ej
                   kwoty okre¶lonej t± zmienn±. Default: 0.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>limit = -20</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Okre¶la komendê systemow±, która zostanie wywo³ana je¿eli co najmniej
                   jeden u¿ytkownik zostanie od³±czony lub zostanie w³±czone ostrze¿enie. 
                   Default: nieustawiona.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = 'almsd -qi firewall'</SAMP
></P
></LI
><LI
><P
>warning</P
><P
>W³±cza ostrze¿enie dla od³±czanego u¿ytkowanika i przypisuje mu 
                   okre¶lon± w tej opcji tre¶æ. Je¿eli pusta, ostrze¿enie nie bêdzie w³±czane.
                   Data w ostrze¿eniu ukryta jest pod zmienn± '%time'.
                   Default: 'Automatyczna blokada spowodowana przekroczeniem terminu wp³aty (dd.mm.yyyy)".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>warning = ""</SAMP
></P
></LI
><LI
><P
>warnings_only</P
><P
>Ta opcja pozwala zdecydowaæ, czy chcemy u¿yæ naszego 
                   modu³u wy³±cznie do w³±czania ostrze¿eñ. Default: wy³±czona.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>warnings_only = true</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-DHCP"
>3.2.7. Dhcp</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="DHCP-DESC"
>3.2.7.1. Description</A
></H4
><P
>Modu³ zarz±dzaj±cy serwerem DHCP, tworzy plik konfiguracyjny oraz
              restartuje us³ugê. Zmienna 'command' umo¿liwia równie¿ wykonywanie innych 
              czynno¶ci (programów).</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="DHCP-CONFIG"
>3.2.7.2. Configuration</A
></H4
><P
>Wiêkszo¶æ parametrów konfiguracyjnych odpowiada fragmentom 
              pliku konfiguracyjnego dhcpd, które w typowych zastosowaniach
              nie wymagaj± zmiany:</P
><UL
><LI
><P
>file</P
><P
>Okre¶la lokalizacjê pliku konfiguracyjnego serwera dhcp. 
                   Default: /tmp/dhcpd.conf.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /etc/dhcpd.conf</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie wykonywane po utworzeniu pliku konfiguracyjnego. 
                   Default: pusta.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = 'killall -HUP dhcpd'</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek pliku. Default: "shared-network LMS {".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>begin = "shared-network LMS {"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka pliku. Default: "}".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>end = "\n}"</SAMP
></P
></LI
><LI
><P
>subnet_start</P
><P
>Nag³ówek podsieci. '%a' - nazwa, '%m' - maska. Default: "subnet %a netmask %m {\ndefault-lease-time 86400;\nmax-lease-time 86400;".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_start = "subnet %a netmask %m {default-lease-time 3600;"</SAMP
></P
></LI
><LI
><P
>subnet_end</P
><P
>Stopka podsieci. Default: "}".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_end = '\t}'</SAMP
></P
></LI
><LI
><P
>subnet_gateway</P
><P
>Brama podsieci. '%i' zostanie zamienione na adres ip. Default: 'option routers %i;'.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_gateway = "option routers %i"</SAMP
></P
></LI
><LI
><P
>subnet_dns</P
><P
>DNS'y podsieci. '%i - adresy dns'ów. Default: "option domain-name-servers %i;".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_dns = "option domain-name-servers 192.168.0.1"</SAMP
></P
></LI
><LI
><P
>subnet_domain</P
><P
>Nazwa domenowa podsieci. '%n' - nazwa. Default: "option domain-name %n;".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_domain = "option domain-name test.%n;"</SAMP
></P
></LI
><LI
><P
>subnet_wins</P
><P
>Serwery wins. '%i' - adres ip serwera. Default: "option netbios-name-servers %i;".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_wins = ""</SAMP
></P
></LI
><LI
><P
>subnet_range</P
><P
>Zakres adresów podsieci. '%s' - adres pocz±tkowy, '%e' - koniec zakresu. Default: "range %s %e;".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>subnet_range = "range %s %e;"</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Parametry hostów, gdzie '%n' - nazwa hosta, '%m' - MAC, '%i' - adres ip. 
                   Default: "\thost %n {\n\t\thardware ethernet %m; fixed-address %i; \n\t}".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>host = "host %n {hardware ethernet %m; fixed-address %i;}"</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
                   Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
                   Default: pusta (wszystkie grupy).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-HOSTFILE"
>3.2.8. Hostfile</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="HOSTFILE-DESC"
>3.2.8.1. Description</A
></H4
><P
>Modu³ 'hostfile' jest do¶æ uniwersalnym narzêdziem. Poniewa¿ 
              wykonuje pêtlê po wszystkich komputerach w bazie rozró¿niaj±c ich
              status (od³±czony/pod³±czony), sieæ do której s± pod³aczone oraz
              grupy do których nale¿± ich w³a¶ciciele, dlatego mo¿liwe jest tworzenie np. regu³
              dowolnego firewalla, czy te¿ pliku /etc/hosts. Dane zapisuje do pliku 
              i nastêpnie wykonuje okre¶lone polecenie pow³oki.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="HOSTFILE-CONFIG"
>3.2.8.2. Configuration</A
></H4
><P
>W opcjach 'grantedhost' i 'deniedhost' mo¿na stosowaæ specjalne zmienne,
              które podczas zapisu do pliku zostan± zast±pione '%i' - adresem ip, '%m' - mac
              adresem, '%n' - nazw± komputera, '%p' - password, '%info' - opisem komputera, '%domain' - domen±, 
              '%net' - nazw± sieci, '%gw' - adresem bramy w sieci do której nale¿y dany komputer.
              Poni¿ej opcje udostêpniane przez ten modu³</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Default: /tmp/hostfile</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /etc/rc.d/rc.firewall</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wyk. po utworzeniu pliku 'file'. Default: puste</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = '/bin/sh /etc/rc.d/rc.firewall'</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek pliku tymczasowego. Default: "/usr/sbin/iptables -F FORWARD\n"</P
><P
>Example: <SAMP
CLASS="PROMPT"
>begin = "IPT=/usr/sbin/iptables \n$IPT -F FORWARD\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka pliku tymczasowego. Default: "/usr/sbin/iptables -A FORWARD -J REJECT\n"</P
><P
>Example: <SAMP
CLASS="PROMPT"
>end = "$IPT -A FORWARD -J REJECT\n"</SAMP
></P
></LI
><LI
><P
>grantedhost</P
><P
>Tekst dla hosta pod³±czonego. Default: "/usr/sbin/iptables -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n"</P
><P
>Example: <SAMP
CLASS="PROMPT"
>grantedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j ACCEPT\n"</SAMP
></P
></LI
><LI
><P
>deniedhost</P
><P
>Tekst dla hosta od³±czonego. Default: "/usr/sbin/iptables -A FORWARD -s %i -m mac --mac-source %m -j REJECT\n"</P
><P
>Example: <SAMP
CLASS="PROMPT"
>deniedhost = "$IPT -A FORWARD -s %i -m mac --mac-source %m -j REJECT\n"</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
                   Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
                   Default: pusta (wszystkie grupy).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
><LI
><P
>skip_dev_ips</P
><P
>Je¶li ustawiona na tak (yes, true) pominiête zostan± adresy urz±dzeñ sieciowych. Default: tak</P
><P
>Example: <SAMP
CLASS="PROMPT"
>skip_dev_ips = no</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-TRAFFIC"
>3.2.9. Traffic</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="TRAFFIC-DESC"
>3.2.9.1. Description</A
></H4
><P
>'Traffic' to odpowiednik perlowego lms-traffic, zapisuj±cy do bazy statystyki
              wykorzystania ³±cza z pliku utworzonego przez u¿ytkownika. Plik taki powinien mieæ 
              format: ip_hosta upload download . Wiêcej informacji (w tym jak utworzyæ taki plik)
              mo¿na znale¼æ w rozdziale dotycz±cym lms-traffic.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="TRAFFIC-CONFIG"
>3.2.9.2. Configuration</A
></H4
><P
>Jedyny dostêpny parametr jest jednocze¶nie obowi±zkowy:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku ze statystykami firewalla. Default: /var/log/traffic.log</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /tmp/log</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-TC"
>3.2.10. Tc (HTB)</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="TC-DESC"
>3.2.10.1. Description</A
></H4
><P
>Modu³ generuj±cy skrypt zawieraj±cy polecenia iptables i tc s³u¿±ce
              do ograniczania pasma i limitowania po³±czeñ u¿ytkownikom. Regu³ki dla 
              komputerów mo¿na dowolnie zdefiniowaæ i wykorzystaæ nie tylko do "traffic 
              control". Zasada dzia³ania skryptu przedstawia siê nastêpuj±co: Najpierw z bazy
              pobierane s± dane dla wszystkich u¿ytkowników. Obliczane s± sumy ograniczeñ
              (uprate, downrate, upceil, downceil, limity po³±czeñ) dla ka¿dego u¿ytkownika
              Nastêpnie wykonywana jest pêtla ze sprawdzeniem przynale¿no¶ci do grupy u¿ytkowników
              i sieci (je¶li okre¶lono). Je¶li warto¶ci ograniczeñ s± ró¿ne od zera nastêpuje
              zapis regu³ do pliku z podmian± zmiennych. W regu³kach mo¿na stosowaæ nastêpuj±ce
              zmienne: %name - nazwa hosta, %i - adres IP, %m - MAC, %uprate, %downrate, %upceil, 
              %downceil, %plimit, %climit oraz %x - licznik o warto¶ci pocz±tkowej 100 
              zwiêkszany o jeden dla ka¿dego komputera.</P
><P
>Domy¶lna polityka tworzenia klas htb zak³ada utworzenie jednej klasy dla
              wszystkich komputerów u¿ytkownika. Mo¿e to byæ zmienione za pomoc± opcji
              'one_class_per_host'.</P
><P
>Configuration domy¶lna zak³ada, ¿e twój system jest przystosowany
              do zastosowania htb oraz iptables z modu³ami limit, connlimit, mark i ipp2p.
              Mo¿esz sam spatchowaæ j±dro lub skorzystaæ ze ¼róde³ dostêpnych na stronie
              <A
HREF="http://www.inet.one.pl"
TARGET="_top"
>www.inet.one.pl</A
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="TC-CONFIG"
>3.2.10.2. Configuration</A
></H4
><P
>Masz do dyspozycji standardowe parametry takie jak usergroups, file,
              command, networks i dodatkowo opcje definiuj±ce tre¶æ regu³ek tc i firewalla.
              Domy¶lna konfiguracja przeznaczona jest dla ³±cz 512/128 kbit i 100mbit.</P
><P
><DIV
CLASS="NOTE"
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="../images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Warto¶ci opcji konfiguracyjnych w <TT
CLASS="FILENAME"
>lms.ini</TT
>
              nale¿y podawaæ w jednej linii. W przypadku tego modu³u mo¿e to byæ niezbyt wygodne,
              dlatego mo¿esz stworzyæ plik z zawarto¶ci± ca³ego nag³ówka (opcja <TT
CLASS="FILENAME"
>              begin</TT
>), a nastêpnie u¿yæ opcji <TT
CLASS="FILENAME"
>command</TT
> do
              jego sklejenia z reszt± skryptu wygenerowan± przez modu³.</P
></TD
></TR
></TABLE
></DIV
></P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku tymczasowego. Default: /etc/rc.d/rc.htb.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /tmp/rc.htb</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wykonywane po utworzeniu pliku. Default: "sh /etc/rc.d/rc.htb start".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = "chmod 700 /tmp/rc.htb; /tmp/rc.htb start"</SAMP
></P
></LI
><LI
><P
>begin</P
><P
>Nag³ówek skryptu. Default:
<PRE
CLASS="SCREEN"
>"#!/bin/sh
IPT=/usr/sbin/iptables
TC=/sbin/tc
LAN=eth0
WAN=eth1
BURST="burst 30k"

stop ()
{
$IPT -t mangle -D FORWARD -i $WAN -j LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -D FORWARD -o $WAN -j LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -F LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -X LIMITS &#62;/dev/null 2&#62;&#38;1
$IPT -t mangle -F OUTPUT
$IPT -t filter -F FORWARD
$TC qdisc del dev $LAN root 2&#62; /dev/null
$TC qdisc del dev $WAN root 2&#62; /dev/null
}

start ()
{
stop
$IPT -t mangle -N LIMITS
$IPT -t mangle -I FORWARD -i $WAN -j LIMITS
$IPT -t mangle -I FORWARD -o $WAN -j LIMITS
# incomming traffic
$IPT -t mangle -A OUTPUT -j MARK --set-mark 1
$TC qdisc add dev $LAN root handle 1:0 htb default 3 r2q 1
$TC class add dev $LAN parent 1:0 classid 1:1 htb rate 99000kbit ceil 99000kbit quantum 1500
$TC class add dev $LAN parent 1:1 classid 1:2 htb rate   500kbit ceil   500kbit
$TC class add dev $LAN parent 1:1 classid 1:3 htb rate 98500kbit ceil 98500kbit prio 9 quantum 1500
$TC qdisc add dev $LAN parent 1:3 esfq perturb 10 hash dst
# priorities for ICMP, TOS 0x10 and ports 22 and 53
$TC class add dev $LAN parent 1:2 classid 1:20 htb rate 50kbit ceil 500kbit $BURST prio 1 quantum 1500
$TC qdisc add dev $LAN parent 1:20 esfq perturb 10 hash dst
$TC filter add dev $LAN parent 1:0 protocol ip prio 2 u32 match ip sport 22 0xffff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 2 u32 match ip sport 53 0xffff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 1 u32 match ip tos 0x10 0xff flowid 1:20
$TC filter add dev $LAN parent 1:0 protocol ip prio 1 u32 match ip protocol 1 0xff flowid 1:20
# server -&#62; LAN
$TC filter add dev $LAN parent 1:0 protocol ip prio 4 handle 1 fw flowid 1:3

# outgoing traffic
$TC qdisc add dev $WAN root handle 2:0 htb default 11 r2q 1
$TC class add dev $WAN parent 2:0 classid 2:1 htb rate 120kbit ceil 120kbit
# priorities for ACK, ICMP, TOS 0x10, ports 22 and 53
$TC class add dev $WAN parent 2:1 classid 2:10 htb rate 60kbit ceil 120kbit prio 1 quantum 1500
$TC qdisc add dev $WAN parent 2:10 esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip protocol 6 0xff \
match u8 0x05 0x0f at 0 match u16 0x0000 0xffc0 at 1 match u8 0x10 0xff at 33 flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip dport 22 0xffff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip dport 53 0xffff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip tos 0x10 0xff flowid 2:10
$TC filter add dev $WAN parent 2:0 protocol ip prio 1 u32 match ip protocol 1 0xff flowid 2:10
# server -&#62; Internet
$TC class add dev $WAN parent 2:1 classid 2:11 htb rate 30kbit ceil 120kbit prio 2 quantum 1500
$TC qdisc add dev $WAN parent 2:11 esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 3 handle 1 fw flowid 2:11
$TC filter add dev $WAN parent 2:0 protocol ip prio 9 u32 match ip dst 0/0 flowid 2:11</PRE
></P
><P
>Example: <SAMP
CLASS="PROMPT"
>begin = "#!/bin/bash\n$TC=/usr/local/sbin/tc\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Stopka skryptu. Default:
<PRE
CLASS="SCREEN"
>}

case "$1" in
    'start')
     start
    ;;
    'stop')
     stop
    ;;
    'status')
     echo "WAN Interface"
     echo "============="
     $TC class show dev $WAN | grep root
     $TC class show dev $WAN | grep -v root | sort | nl
     echo "LAN Interface"
     echo "============="
     $TC class show dev $LAN | grep root
     $TC class show dev $LAN | grep -v root | sort | nl
    ;;
    *)
     echo -e "\nUsage: rc.htb start|stop|status"
    ;;
esac</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>one_class_per_host</P
><P
>Okre¶la politykê tworzenia klas htb. W ustawieniu domy¶lnym
                   wszystkie komputery u¿ytkownika zostan± wrzucone do jednej klasy.
                   Ustawienie tej opcji na 'true' spowoduje, ¿e regu³y okre¶lone w 
                   host_htb_up i host_htb_down zostan± wygenerowane dla wszystkich
                   komputerów u¿ytkownika (z inn± warto¶ci± '%x'). Regu³y z host_mark_down,
                   host_mark_up, host_plimit i host_climit generowane s± dla ka¿dego
                   komputera niezale¿nie od ustawieñ tej zmiennej. Default: false</P
><P
>Example: <SAMP
CLASS="PROMPT"
>one_class_per_host = 1</SAMP
></P
></LI
><LI
><P
>host_mark_down</P
><P
>Regu³a markuj±ca dla ka¿dego komutera. Default:
<PRE
CLASS="SCREEN"
># %n
$IPT -t mangle -A LIMITS -d %i -j MARK --set-mark %x</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>host_mark_down = ""</SAMP
></P
></LI
><LI
><P
>host_mark_up</P
><P
>Regu³a markuj±ca dla ka¿dego komutera. Default:
<PRE
CLASS="SCREEN"
>$IPT -t mangle -A LIMITS -s %i -j MARK --set-mark %x</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>host_mark_up = ""</SAMP
></P
></LI
><LI
><P
>host_htb_down</P
><P
>Zestaw regu³ dla ka¿dego komutera, wykonywanych
                   gdy uprate i downrate s± ró¿ne od zera. Default:
<PRE
CLASS="SCREEN"
>$TC class add dev $LAN parent 1:2 classid 1:%x htb rate %downratekbit ceil %downceilkbit $BURST prio 2 quantum 1500
$TC qdisc add dev $LAN parent 1:%x esfq perturb 10 hash dst
$TC filter add dev $LAN parent 1:0 protocol ip prio 5 handle %x fw flowid 1:%x</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>host_htb_down = ""</SAMP
></P
></LI
><LI
><P
>host_htb_up</P
><P
>Zestaw regu³ dla ka¿dego komutera, wykonywanych
                   gdy uprate i downrate s± ró¿ne od zera. Default:
<PRE
CLASS="SCREEN"
>$TC class add dev $WAN parent 2:1 classid 2:%x htb rate %upratekbit ceil %upceilkbit $BURST prio 2 quantum 1500
$TC qdisc add dev $WAN parent 2:%x esfq perturb 10 hash dst
$TC filter add dev $WAN parent 2:0 protocol ip prio 5 handle %x fw flowid 2:%x</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>host_htb_up = ""</SAMP
></P
></LI
><LI
><P
>host_climit</P
><P
>Regu³ka z ograniczeniem ilo¶ci równoczesnych po³±czeñ tcp. Wykonywana
                   gdy climit w bazie jest ró¿ny od zera. Default:
<PRE
CLASS="SCREEN"
>$IPT -t filter -I FORWARD -p tcp -s %i -m connlimit --connlimit-above %climit -m ipp2p --ipp2p -j REJECT</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>host_climit = "$IPT -t filter -I FORWARD -p tcp -s %i -m connlimit --connlimit-above -j REJECT"</SAMP
></P
></LI
><LI
><P
>host_plimit</P
><P
>Regu³ka z ograniczeniem ilo¶ci pakietów w jednostce czasu (tutaj sekunda). Wykonywana
                   gdy plimit w bazie jest ró¿ny od zera. Default:
<PRE
CLASS="SCREEN"
>$IPT -t filter -I FORWARD -p tcp -d %i -m limit --limit %plimit/s -m ipp2p --ipp2p -j ACCEPT
$IPT -t filter -I FORWARD -p tcp -s %i -m limit --limit %plimit/s -m ipp2p --ipp2p -j ACCEPT</PRE
>
                   </P
><P
>Example: <SAMP
CLASS="PROMPT"
>host_plimit = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
                   Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
                   Default: pusta (wszystkie grupy).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-DNS"
>3.2.11. Dns</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="DNS-DESC"
>3.2.11.1. Description</A
></H4
><P
>Modu³ do konfiguracji stref serwera 'named' jest jednym z bardziej skomplikowanych.
              Tworzy dla ka¿dej sieci pliki stref oraz odpowiednie wpisy w named.conf w oparciu
              o szablony tych plików. Przyk³adowe szablony znajduj± siê w katalogu
              <TT
CLASS="FILENAME"
>/modules/dns/sample</TT
>.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="DNS-CONFIG"
>3.2.11.2. Configuration</A
></H4
><P
></P
><UL
><LI
><P
>forward-patterns</P
><P
>Katalog z szablonami stref. Default: forward.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>forward-patterns = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>reverse-patterns</P
><P
>Katalog z szablonami stref odwrotnych. Default: reverse.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>reverse-patterns = /dns/patterns/revers</SAMP
></P
></LI
><LI
><P
>generic-forward</P
><P
>Szablon domy¶lny. Zostanie wykorzystany je¶li w katalogu okre¶lonym
                   'forward-patterns' nie bêdzie pliku odpowiadaj±cego nazwie domenowej sieci.
                   Default: modules/dns/sample/forward/generic.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>generic-forward = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>generic-reverse</P
><P
>Szablon domy¶lny. Zostanie wykorzystany je¶li w katalogu okre¶lonym
                   'reverse-patterns' nie bêdzie pliku odpowiadaj±cego numerowi IP sieci.
                   Default: modules/dns/sample/reverse/generic.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>generic-reverse = /dns/patterns/forward</SAMP
></P
></LI
><LI
><P
>forward-zones</P
><P
>Katalog na pliki wynikowe stref.
                   Default: modules/dns/sample/out/forward.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>forward-zones = /dns/forward</SAMP
></P
></LI
><LI
><P
>reverse-zones</P
><P
>Katalog na pliki wynikowe stref odwrotnych.
                   Default: modules/dns/sample/out/reverse.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>reverse-zones = /dns/reverse</SAMP
></P
></LI
><LI
><P
>host-reverse</P
><P
>Linia w pliku strefy odw. odpowiadaj±ca ka¿demu komputerowi w dane sieci.
                   Default: "%n IN A %i\n".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>host-reverse = "\t %n IN A %i\n"</SAMP
></P
></LI
><LI
><P
>host-forward</P
><P
>Linia w pliku strefy odpowiadaj±ca ka¿demu komputerowi w danej sieci.
                   Default: "%c IN PTR %n.%d.\n".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>host-forward = "\t %c IN PTR %n.%d.\n"</SAMP
></P
></LI
><LI
><P
>conf-pattern</P
><P
>Lokalizacja szablonu g³ównego pliku konfiguracyjnego serwera.
                   Default: modules/dns/sample/named.conf.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>conf-pattern = /dns/patterns/named.conf</SAMP
></P
></LI
><LI
><P
>conf-output</P
><P
>Lokalizacja g³ównego pliku konfiguracyjnego serwera.
                   Default: /tmp/named.conf.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>conf-output = /etc/named.conf</SAMP
></P
></LI
><LI
><P
>conf-forward-entry</P
><P
>Wpis dla ka¿dej strefy w g³ównym pliku konfiguracyjnym.
                   Default: 'zone "%n" {\ntype master;\n file "forward/%n"; \nnotify yes; \n}; \n'.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>conf-forward-entry = 'zone "%n" { \n\ttype master; \n\tfile "forward/%n"; \n\tnotify yes; \n}; \n'</SAMP
></P
></LI
><LI
><P
>conf-reverse-entry</P
><P
>Wpis dla ka¿dej strefy odw. w g³ównym pliku konfiguracyjnym.
                   Default: 'zone "%c.in-addr.arpa" { \ntype master; \nfile "reverse/%i"; \nnotify yes; \n}; \n'.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>conf-revers-entry = 'zone "%c.in-addr.arpa" { \n\ttype master; \n\tfile "reverse/%i"; \n\tnotify yes; \n}; \n'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie wykonywane po utworzeniu plików konf. Default: puste.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = ""</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
                   Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
                   Default: pusta (wszystkie grupy).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-ETHERS"
>3.2.12. Ethers</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="ETHERS-DESC"
>3.2.12.1. Description</A
></H4
><P
>Modu³ tworz±cy konfiguracjê tablicy ARP systemu. Ustawiaj±c opcjê
              'dummy_macs' mo¿na sprawiæ, aby komputerom od³±czonym zosta³ przypisany 
              mac-adres 00:00:00:00:00:00.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="ETHERS-CONFIG"
>3.2.12.2. Configuration</A
></H4
><P
>Tutaj s± tylko standardowe opcje:</P
><UL
><LI
><P
>file</P
><P
>Lokalizacja pliku wynikowego. Default: /tmp/ethers.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /etc/ethers</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie pow³oki wykonywane po wygenerowaniu konfiga. Default: puste.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = "arp -f /etc/ethers"</SAMP
></P
></LI
><LI
><P
>dummy_macs</P
><P
>Je¶li ustawimy na 'yes', to komputerom od³±czonym zostanie
                   przypisany mac-adres '00:00:00:00:00:00'. Default: "no".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>dummy_macs = yes</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia.
                   Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = "lan1 lan2"</SAMP
></P
></LI
><LI
><P
>usergroups</P
><P
>Lista nazw grup u¿ytkowników, które maj± byæ brane pod uwagê. Wielko¶æ liter nie ma znaczenia. 
                   Default: pusta (wszystkie grupy).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>usergroups = "grupa1 grupa2"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-OIDENT"
>3.2.13. Oident</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="OIDENT-DESC"
>3.2.13.1. Description</A
></H4
><P
>Modu³ do konfiguracji oidentd. W zasadzie mo¿na to zrobiæ modu³em
              'hostfile', ale tutaj masz ju¿ gotowe ustawienia domy¶lne.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="OIDENT-CONFIG"
>3.2.13.2. Configuration</A
></H4
><P
>A oto parametry modu³u 'oident'</P
><UL
><LI
><P
>begin</P
><P
>Tekst wstawiany na pocz±tku pliku. Default: puste.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>begin = "#Generowany automatycznie\n"</SAMP
></P
></LI
><LI
><P
>end</P
><P
>Tekst wstawiany na koñcu pliku. Default: puste.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>end = ""</SAMP
></P
></LI
><LI
><P
>host</P
><P
>Linia tekstu dla ka¿dego komputera. Default: "%i\t%n\tUNIX".</P
><P
>Example: <SAMP
CLASS="PROMPT"
>host = "%i %n WINDOWS"</SAMP
></P
></LI
><LI
><P
>file</P
><P
>Tekst wstawiany na pocz±tku pliku. Default: /tmp/oidentd.conf.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>file = /etc/identd.conf</SAMP
></P
></LI
><LI
><P
>networks</P
><P
>Lista nazw sieci do uwzglêdnienia. Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = 'lan1 lan2'</SAMP
></P
></LI
><LI
><P
>command</P
><P
>Polecenie do wykonania po utworzeniu pliku. Default: puste.</P
><P
>Example: <SAMP
CLASS="PROMPT"
>command = "killall -HUP midentd"</SAMP
></P
></LI
></UL
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H3
CLASS="SECT2"
><A
NAME="DAEMON-PINGER"
>3.2.14. Pinger</A
></H3
><DIV
CLASS="SECT3"
><H4
CLASS="SECT3"
><A
NAME="PINGER-DESC"
>3.2.14.1. Description</A
></H4
><P
>Modu³ pinger to odpowiednik perlowego skryptu lms-fping. Ró¿nice s± jednak
              zasadnicze. Nie potrzebuje zewnêtrznego programu i dzia³a przy wykorzystaniu
              protoko³u ARP. Powodem tego jest mniej wiêcej dwukrotnie szybsze wykonanie
              skanowania sieci. Nie ma tak¿e problemów z komputerami maj±cymi wy³±czone 
              odpowiadanie na pingi. Po skanowaniu, wszystkim w³±czonym komputerom jest
              ustawiany w bazie danych czas skanowania, wykorzystywany do obrazowania
              aktywno¶ci komputerów np. na mapie sieci.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H4
CLASS="SECT3"
><A
NAME="PINGER-CONFIG"
>3.2.14.2. Configuration</A
></H4
><P
>Pinger udostêpnia tylko jedn± opcjê konfiguracyjn±:</P
><UL
><LI
><P
>networks</P
><P
>Lista nazw sieci, które maj± byæ skanowane. Default: pusta (wszystkie sieci).</P
><P
>Example: <SAMP
CLASS="PROMPT"
>networks = 'lan1 lan2'</SAMP
></P
></LI
></UL
></DIV
></DIV
></DIV
></DIV
></DIV
></BODY
></HTML
>